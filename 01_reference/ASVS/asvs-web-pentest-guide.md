# ASVS v5.0 要点サマリ
- 本サマリは ASVS v5.0 の V1〜V10 を前提資料として、Webペネトレーションテスト（WebPT）で実施・判定しやすい検査観点を抽出し、個別要件の扱い（対応/一部対応/範囲外）を整理したもの。
- 範囲外は主に「設計/運用/文書レビュー中心」「構成監査のみで実挙動からは検証困難」などを理由とする。
- https://github.com/owasp-ja/asvs-ja/tree/master/5.0/ja
---

# V1 エンコーディングとサニタイゼーション（ASVS v5.0 観点で再連番化）

> 表列順（固定）：`章/要件ID｜レベル｜要点｜対応可否｜WebPTでの扱い｜備考`

---

## V1.1 エンコーディングおよびサニタイゼーションアーキテクチャ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V1.1.1 | L2 | 入力は一度だけ標準形式にデコード／アンエスケープされ、処理前に行うこと（入力バリデーション後に行わない）。 | 部分対応 | 入力のエンコード経路観察、二重デコードの検出（リクエスト差分／侵入テスト） | 実装確認やログ参照があると確実。 |
| V1.1.2 | L2 | 出力エンコーディング／エスケープは最終ステップで行うこと（インタプリタに渡す直前）。 | 部分対応 | 出力のエンコード方法の検証（反射・保存型ペイロードで確認） | ライブラリ自動エスケープの有無はホワイトボックスで評価すると良い。 |

---

## V1.2 インジェクション防御

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V1.2.1 | L1 | HTML/HTTP/CSS/コメント等、各コンテキストに応じた出力エンコードを行うこと。 | 対応可 | XSS向けペイロードテスト、レスポンスコンテキスト解析 | ブラウザ実行コンテキストで確認可能。 |
| V1.2.2 | L1 | 動的URL構築時はコンテキストに応じたエンコードを行い、危険なプロトコルを許可しない。 | 対応可 | URL生成点のパラメータ操作、プロトコルスキーム検証（javascript:, data: 等拒否） | リダイレクト、open-redirect 諸検査で併せて確認。 |
| V1.2.3 | L1 | 動的に構築する JS/JSON コンテンツは構造を破壊しないようにエンコードすること（JS/JSON 注入防止）。 | 対応可 | JSON/JS を出力するエンドポイントに対するインジェクションテスト | ブラウザ/解析ツールで確認。 |
| V1.2.4 | L1 | DB クエリはパラメータ化／ORM 等で保護し、SQL インジェクションを防ぐこと。 | 対応可 | SQLi ペイロード（盲目含む）、エラーベース／時間差検査 | 一部はホワイトボックス/ログ参照で確証。 |
| V1.2.5 | L1 | OS コマンド呼び出しは適切に保護（パラメータ化やエンコード）されていること。 | 部分対応 | コマンドインジェクションペイロードによる検査（入力→外部影響確認） | 実行環境や出力確認が必要なため限定的。 |
| V1.2.6 | L2 | LDAP インジェクション対策が施されていること。 | 部分対応 | LDAP クエリに関する入力を用いた検査（LDAP ベースの機能が存在する場合） | LDAP サービス利用有無に依存。 |
| V1.2.7 | L2 | XPath/XQuery 等に対するパラメータ化・保護を行うこと。 | 部分対応 | XML/XPath を利用する機能に対するペイロード検査 | サービス構成確認が有効。 |
| V1.2.8 | L2 | LaTeX 等外部プロセッサは安全に構成（例: shell-escape 無効）されること。 | 範囲外 | 設定確認を推奨（ドキュメント生成機能が対象の場合は限定検査） | ビルド／環境の確認が必要。 |
| V1.2.9 | L2 | 正規表現内の特殊文字を適切にエスケープして誤解釈を防ぐこと。 | 部分対応 | 正規表現処理を伴う入力処理の挙動確認（ReDoS 予兆の検査） | ReDoS は負荷試験注意。 |
| V1.2.10 | L3 | CSV／スプレッドシートインジェクション対策（RFC4180 準拠、先頭特殊文字をクオート等）。 | 部分対応 | CSV エクスポート機能に対するフィールド先頭文字検査（エクスポート結果の検査） | エクスポート確認はステージングで慎重に実施。 |

---

## V1.3 サニタイゼーション

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V1.3.1 | L1 | WYSIWYG 等からの HTML は既知の安全なサニタイズライブラリで処理すること。 | 対応可 | 保存型 XSS の検証、サニタイズ漏れテスト | DOMPurify 等の利用確認は実装確認で確実に。 |
| V1.3.2 | L1 | eval() や SpEL 等の動的コード実行を使用しない／使用時は入力をサニタイズすること。 | 部分対応 | 動的評価が疑われる箇所のペイロード検査（危険箇所の発見） | 使用有無の把握はホワイトボックスで明確化。 |
| V1.3.3 | L2 | 危険なコンテキストへ渡すデータは事前サニタイズ・長さ制限等を実施すること。 | 部分対応 | 長さや許可文字検査、入力整合性の確認 | 実装依存。 |
| V1.3.4 | L2 | SVG 等スクリプト可能コンテンツはスクリプトや foreignObject を含まないよう検証／サニタイズすること。 | 部分対応 | SVG を受け付ける機能に対する検査（表示と挙動） | ブラウザ差異に注意。 |
| V1.3.5 | L2 | Markdown/CSS/XSL/BBCode 等はサニタイズまたは無効化すること。 | 部分対応 | ユーザ生成コンテンツのレンダリング経路でのインジェクション検査 | 変換パイプライン確認が必要。 |
| V1.3.6 | L2 | SSRF 対策としてプロトコル・ドメイン・パス・ポートの許可リスト検証とサニタイズを行うこと。 | 部分対応 | SSRF ペイロード／外部接続検証（リクエスト先制御の検査） | 内部ネットワークへの影響に注意（テスト合意必要）。 |
| V1.3.7 | L2 | テンプレート生成をユーザ入力ベースで動的に許可しないこと。 | 部分対応 | テンプレートエンジン利用箇所のテンプレート注入検査 | 実行環境での確認推奨。 |
| V1.3.8 | L2 | JNDI クエリ等は信頼できない入力をサニタイズし安全に構成すること。 | 部分対応 | JNDI 利用箇所があればテンプレート注入等を検査 | 利用有無の確認が必須。 |
| V1.3.9 | L2 | memcache 送信前のサニタイズを行いインジェクションを防ぐこと。 | 部分対応 | キャッシュに関連する入力の検査（キャッシュ汚染の観察） | 実運用ログ参照で確証。 |
| V1.3.10 | L2 | フォーマット文字列が予期せぬ解決をしないよう事前サニタイズすること。 | 部分対応 | フォーマット処理を伴う機能の入力検査 | 実行時の挙動確認が重要。 |
| V1.3.11 | L2 | SMTP/IMAP 等メール注入対策のため、メール送信前のサニタイズを行うこと。 | 部分対応 | メール送信機能の入力検査（ヘッダ注入等） | 実送信は注意。ステージングで検査推奨。 |
| V1.3.12 | L3 | 正規表現による ReDoS を防ぐため、指数的バックトラッキング要素がないことを保証すること。 | 範囲外（負荷試験注意） | ReDoS 予兆検査（負荷試験的手法） | 負荷試験は事前合意必須。 |

---

## V1.4 メモリ、文字列、アンマネージドコード

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V1.4.1 | L2 | メモリ安全な文字列操作／安全なメモリコピー等を使用してバッファオーバーフローを防ぐこと。 | 範囲外 | バイナリ／ビルド検査が必要（WebPT は限定的） | バイナリ解析や静的解析が必要。 |
| V1.4.2 | L2 | 整数オーバーフロー防止のため符号・範囲・バリデーションを行うこと。 | 範囲外 | 実装／ビルド確認推奨 | ブラックボックスでは判定困難。 |
| V1.4.3 | L2 | 動的メモリ解放とダングリングポインタ対策（use-after-free 防止）。 | 範囲外 | 主に開発時／ビルド時検査対象 | WebPT 範囲外（ソース/ビルド確認）。 |

---

## V1.5 安全なデシリアライゼーション

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V1.5.1 | L1 | XML パーサを制限構成にして XXE 等を防止する（外部エンティティ無効化等）。 | 対応可 | XXE 攻撃ペイロードによる検査（XML エンドポイント） | パーサ設定確認はホワイトボックスで確実。 |
| V1.5.2 | L2 | デシリアライズ時は型ホワイトリスト等で許可型を限定し、安全でないメカニズムは信頼できない入力で使用しない。 | 部分対応 | デシリアライズ対象の入力を操作して異常挙動検査（挙動検証） | 実行時のオブジェクト生成経路の把握が有用。 |
| V1.5.3 | L3 | 各種パーサ（JSON/XML/URL）が同一の解析・エンコードを行うよう一貫性を保つこと（相互運用性の問題回避）。 | 部分対応 | 異なるパーサを用いる箇所があれば差分解析の検査 | 実装・設計確認が中心。 |

---

# V2 バリデーションとビジネスロジック
---

## V2.1 バリデーションとビジネスロジックドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V2.1.1 | L1 | 期待される構造に対する入力バリデーションルールを文書化 | 範囲外 | ドキュメント要求・ヒアリングで確認 | 文書管理プロセスの有無を確認 |
| V2.1.2 | L2 | 組合せデータの論理・コンテキスト整合の検証手順を文書化 | 範囲外 | 同上 | 例：地区と郵便番号の整合 |
| V2.1.3 | L2 | ユーザ別/全体のビジネス制限・バリデーション期待事項を文書化 | 範囲外 | 同上 | 権限別ルールの明記 |

---

## V2.2 入力バリデーション

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V2.2.1 | L1 | 肯定的バリデーション（許容値/パターン/範囲/構造）を適用 | 部分対応 | 代表入力の境界値/無効値テスト、スキーマ差分検証 | L2以上は全入力対象 |
| V2.2.2 | L1 | 信頼できるサーバ側レイヤでバリデーション実施（クライアント依存しない） | 対応可 | クライアント検証バイパス→サーバ側応答確認 | CS側のみ依存の検出 |
| V2.2.3 | L2 | 関連項目の整合チェック（事前定義ルール準拠） | 部分対応 | 相関パラメータ改変での不整合誘発テスト | 例：数量×単価×総額 |

---

## V2.3 ビジネスロジックのセキュリティ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V2.3.1 | L1 | 手順省略不可の正しいフロー実行 | 対応可 | ステップスキップ/順序変更の試行 | CSRF/直リンク/強制ブラウジング併用 |
| V2.3.2 | L2 | 文書化されたロジック制限の実装徹底 | 部分対応 | 制限回避シナリオの作成・検証 | 仕様照合が鍵 |
| V2.3.3 | L2 | ロジックレベルでのトランザクション整合（成功/ロールバック） | 部分対応 | 中間失敗時の不整合発生有無を確認 | 二重送信/再試行時の挙動 |
| V2.3.4 | L2 | ロジックロックで限定資源の二重確保防止 | 部分対応 | 競合・同時実行テスト（軽負荷で） | 在庫/枠/座席など |
| V2.3.5 | L3 | 高価値フローの多者承認 | 範囲外 | 手続/運用設計の確認 | 組織プロセス依存 |

---

## V2.4 アンチオートメーション

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V2.4.1 | L2 | レート制限/クォータ/高コスト機能保護等のアンチオートメーション | 部分対応 | レート超過挙動・CAPTCHA/トークン有無の確認 | 過度な負荷は避ける |
| V2.4.2 | L3 | 人間らしいタイミング要求（過度に速い送信を抑止） | 部分対応 | 連打・自動化送信時の拒否/遅延を確認 | 実装依存が大きい |

---
# V3 ブラウザセキュリティ

## V3.1 Web フロントエンドセキュリティドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V3.1.1 | L3 | 想定ブラウザの必須セキュリティ機能（HTTPS/HSTS/CSP等）と非対応時の動作をドキュメント化 | 範囲外 | ヒアリング・設計資料入手で確認 | 仕様/運用文書の整備状況を確認 |

---

## V3.2 意図しないコンテンツ解釈

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V3.2.1 | L1 | 不正コンテキストでのレンダリング防止（Sec-Fetch系/Content-Disposition: attachment/CSP sandbox 等） | 対応可 | レスポンスヘッダ/フェッチメタの検証とファイル直参照試験 | ダウンロード/inline挙動を確認 |
| V3.2.2 | L1 | テキスト表示は安全API（createTextNode/textContent等）でHTML/JS実行を防止 | 部分対応 | 反射/保存型XSS観点でUI出力の挙動確認 | 実装詳細は黒箱からは限定的 |
| V3.2.3 | L3 | DOM clobbering回避（厳密宣言/型/グローバル汚染防止/名前空間分離） | 部分対応 | 既知ペイロードでのUI破壊可否/コンソール警告観察 | 実装確認があると確実 |

---

## V3.3 クッキーセットアップ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V3.3.1 | L1 | Secure属性必須。__Host-未使用時は__Secure-を使用 | 対応可 | Set-Cookieの属性/プレフィックス検証 | TLS強制前提 |
| V3.3.2 | L2 | SameSiteを目的に応じて設定（CSRF曝露を低減） | 対応可 | クロスサイト送信/iframe等で挙動確認 | Lax/Strict/None+Secureの整合 |
| V3.3.3 | L2 | 共有不要な機密クッキーは__Host-プレフィックス | 対応可 | ドメイン/Path非指定と併せて検証 | __Host-はSecure/Path=/必須 |
| V3.3.4 | L2 | セッショントークン等はHttpOnlyでJSから不可視 | 対応可 | JSからのアクセス可否/ヘッダ確認 | 二重保管（JS+Cookie）禁止 |
| V3.3.5 | L3 | クッキー長（名+値）≤4096B | 部分対応 | 実値の概算・複数クッキーの合計検証 | ブラウザ差異に留意 |

---

## V3.4 ブラウザのセキュリティメカニズムヘッダ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V3.4.1 | L1 | HSTS有効（max-age≥1年）。L2+はincludeSubDomains | 対応可 | すべてのレスポンスでHSTS確認/初回HTTP遮断確認 | preloadはV3.7.4 |
| V3.4.2 | L1 | CORSの許可は固定or厳密許可リスト。`*`は機密非含有時のみ | 対応可 | ACAO/ACAC/Originの相関確認 | 動的反射の禁止確認 |
| V3.4.3 | L2 | CSP導入（最低：object-src 'none', base-uri 'none'）。L3はナンス/ハッシュで応答ごと | 部分対応 | ポリシー妥当性/違反発生有無を検証 | 実装依存が大きい |
| V3.4.4 | L2 | X-Content-Type-Options: nosniff を全レスポンスに付与 | 対応可 | MIMEと実コンテンツ整合/ヘッダ確認 | CORB支援も期待 |
| V3.4.5 | L2 | Referrer-Policyで機密の外部漏えい防止 | 対応可 | 内部→外部遷移時のReferer挙動確認 | no-referrer等の適用 |
| V3.4.6 | L2 | frame-ancestorsで埋め込み制御（X-Frame-Options非推奨） | 対応可 | クリックジャッキング検査/埋込可否確認 | 画面埋込点で評価 |
| V3.4.7 | L3 | CSPの違反送信先（report-to/report-uri）定義 | 部分対応 | 違反トリガでレポート送信可否を確認 | 診断用宛先は要合意 |
| V3.4.8 | L3 | COOP（same-origin/…-allow-popups）でタブ分離 | 部分対応 | ヘッダ確認とナビゲーション挙動観察 | window共有防止を確認 |

---

## V3.5 ブラウザのオリジン分離

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V3.5.1 | L1 | CORS非依存時はCSRFトークン/追加ヘッダで真正性検証 | 対応可 | CSRFトークン有無/検証強度・二重送信可否 | セッション結合/同時対策も |
| V3.5.2 | L1 | CORS依存時はプリフライト回避リクエストで呼べない設計 | 部分対応 | `Origin/Content-Type`/追加ヘッダ要件の検証 | 簡易化ヘッダでの回避不可 |
| V3.5.3 | L1 | 機密操作は安全でないHTTPメソッド（GET等）を使用しない or Sec-Fetch厳格検証 | 対応可 | メソッド/Fetchメタ検証・画像等経由の誤呼び出し検査 | Idempotent設計も確認 |
| V3.5.4 | L2 | 異アプリは異ホストで分離しSOPを活用 | 部分対応 | ホスト名/クッキースコープ/サブドメイン分離確認 | アーキ確認が鍵 |
| V3.5.5 | L2 | postMessageはorigin/構文検証し不正は破棄 | 部分対応 | UI操作でpostMessage経路を観測 | 実装露出が乏しい場合あり |
| V3.5.6 | L3 | JSONPを無効化（XSSI耐性） | 対応可 | `callback=`等の挙動確認/JSONPレス無効を確認 | レガシAPI確認 |
| V3.5.7 | L3 | 認可データをJS資産レスポンスに含めない（XSSI防止） | 部分対応 | 認可要データの取得経路/ヘッダ制御確認 | 静的資産の取り扱い確認 |
| V3.5.8 | L3 | 認証済みリソースの埋込は意図時のみ（Sec-Fetch厳格 or CORP） | 部分対応 | 埋込試行とヘッダ（CORP等）検証 | 埋込失敗時のUX考慮 |

---

## V3.6 外部リソース完全性

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V3.6.1 | L3 | 外部配信の資産はSRI＋固定版管理。不可なら根拠を文書化 | 部分対応 | `<link>/<script>`のSRI有無と固定版確認 | 文書化は別途確認 |

---

## V3.7 ブラウザのセキュリティに関するその他の考慮事項

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V3.7.1 | L2 | 廃止/非安全なクライアント技術の不使用（Flash/ActiveX等） | 部分対応 | 資産スキャン/機能確認で残存技術の検出 | 近代ブラウザでは多くが無効 |
| V3.7.2 | L2 | 自動リダイレクトは許可リスト先のみ | 部分対応 | オープンリダイレクト検査＋許可先確認 | 例外経路の洗い出し |
| V3.7.3 | L3 | 外部遷移時に警告とキャンセル手段を提供 | 部分対応 | 外部リンク遷移UI/警告表示の確認 | deep link配慮 |
| V3.7.4 | L3 | ルートドメインのHSTSプリロードリスト登録 | 部分対応 | `Strict-Transport-Security`とpreload状況の確認 | 反映に時間差あり |
| V3.7.5 | L3 | 想定機能を未サポートのブラウザでは文書通りの動作（警告/遮断） | 範囲外 | 仕様・運用確認 | 実装/運用手順依存 |

# V4 Webサービス

## V4.1 一般的な Web サービスセキュリティ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V4.1.1 | L1 | Content-Type と実体の一致（文字エンコーディング含む） | 対応可 | 各APIレスの Content-Type/charset とボディ検証 | JSON/CSV/画像等でミスマッチ確認 |
| V4.1.2 | L2 | 人手UI向けのみ HTTP→HTTPS リダイレクト許容 | 部分対応 | APIエンドポイントのHTTP許容/自動リダイレクト有無確認 | 誤送信検知/監査要件と併読 |
| V4.1.3 | L2 | 受信ヘッダの上書き防止（X-Forwarded-*, X-User-ID等） | 部分対応 | 任意ヘッダ注入→アプリ側解釈の確認 | 逆プロキシ/ALB設定依存 |
| V4.1.4 | L3 | サポートHTTPメソッドのみ許可（未使用は拒否） | 対応可 | TRACE/PUT/DELETE など無効メソッド試行 | CORSプリフライト含め確認 |
| V4.1.5 | L3 | 重要トランザクションにメッセージ署名 | 範囲外 | 仕様/運用ヒアリング中心 | 実装確認が必要（黒箱困難） |

## V4.2 HTTP メッセージ構造バリデーション

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V4.2.1 | L2 | 受信メッセージ境界の厳格化（TE/CL競合処理等） | 部分対応 | TE/CL両立ペイロードやH2/H3差異での挙動確認 | 中間機器設定に依存 |
| V4.2.2 | L3 | 送信時に Content-Length と実フレーム長の不整合回避 | 範囲外 | 生成側制御のため黒箱では限定的 | 代理で逸脱レスが無いか観測 |
| V4.2.3 | L3 | H2/H3で接続固有ヘッダを送受信しない | 対応可 | H2/H3で Transfer-Encoding 等混入の有無確認 | サーバ/ゲートウェイ実装差異 |
| V4.2.4 | L3 | ヘッダ値にCR/LF/CRLFを許容しない | 対応可 | ヘッダインジェクション試行→レス分割/改変の有無 | 代理応答も観測 |
| V4.2.5 | L3 | 過長URI/ヘッダ生成の抑止（DoS回避） | 部分対応 | 長大クエリ/クッキーでの閾値・エラー挙動確認 | プラットフォーム毎に閾値差 |

## V4.3 GraphQL

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V4.3.1 | L2 | クエリ許可リスト/深さ・コスト制限でDoS防止 | 部分対応 | ネスト/フラグメント乱用での応答時間・リジェクト確認 | 負荷配慮で軽度に実施 |
| V4.3.2 | L2 | 本番での introspection 無効（公開意図なければ） | 対応可 | `__schema`/`__type` クエリ応答可否 | 管理ロール限定なら別評価 |

## V4.4 WebSocket

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V4.4.1 | L1 | すべて WSS を使用 | 対応可 | `ws://` 拒否/`wss://` 強制確認 | 証明書検証も実査 |
| V4.4.2 | L2 | ハンドシェイク時の Origin 検証 | 対応可 | 異オリジンからの接続試行と拒否確認 | 許可リスト整合を確認 |
| V4.4.3 | L2 | 標準セッション不可時は専用トークンで管理 | 部分対応 | トークン要求/失効/再接続挙動の確認 | 実装詳細の把握が鍵 |
| V4.4.4 | L2 | 専用WSトークンは既存HTTPSセッションを基盤に取得/検証 | 部分対応 | 認証連携の流れとバインド確認 | ミスマッチ時の拒否挙動確認 |

# V5 ファイル処理

## V5.1 ファイル処理ドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V5.1.1 | L2 | 機能ごとの許可拡張子・最大サイズ（展開後含む）・悪性検出時の動作を文書化 | 範囲外 | 仕様・運用文書の有無をヒアリングで確認 | 文書化不備は実装不備の指標 |

---

## V5.2 ファイルアップロードとコンテンツ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V5.2.1 | L1 | 処理可能サイズのみ受け付け（DoS防止） | 対応可 | 大容量/境界サイズでエラー挙動確認 | プラットフォームのデフォ閾値も把握 |
| V5.2.2 | L1 | 拡張子と内容（マジックバイト等）の整合検証 | 対応可 | 偽装拡張子/再エンコード画像で検証 | 業務決定に使うファイルを優先 |
| V5.2.3 | L2 | 解凍前に最大非圧縮サイズ・最大ファイル数を検証 | 部分対応 | zip bomb 簡易版で挙動確認（軽負荷） | 本格負荷は事前合意必須 |
| V5.2.4 | L3 | ユーザ毎の容量/件数クォータを適用 | 部分対応 | 連続アップロードで上限適用確認 | ストレージ枯渇の防止策 |
| V5.2.5 | L3 | アーカイブ内シンボリックリンクの拒否（必要時は許可リスト） | 対応可 | symlink/相対リンクを含むzipで展開挙動確認 | 展開先の安全確認も実施 |
| V5.2.6 | L3 | 画像ピクセルサイズ上限でピクセルフラッド防止 | 対応可 | 超高解像画像の拒否/再サンプル有無の確認 | 画像再処理の有無も確認 |

---

## V5.3 ファイル保存

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V5.3.1 | L1 | 公開領域のアップロード/生成ファイルを実行不可に | 対応可 | Webルート配下の実行可否/拡張子マップ確認 | MIME/拡張子強制ダウンロード化 |
| V5.3.2 | L1 | パス生成は内部ID等を使用し、ユーザ入力は厳格検証 | 対応可 | パストラバーサル/LFI/RFI/SSRF試験 | realpath/許可ディレクトリ確認 |
| V5.3.3 | L3 | 展開処理でユーザ提供のパス情報を無視（zip slip防止） | 対応可 | `../`含むエントリの展開結果を検証 | 展開先のベースパス固定必須 |

---

## V5.4 ファイルダウンロード

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V5.4.1 | L2 | 応答の Content-Disposition でサーバ側ファイル名を明示 | 対応可 | URL/JSON指定名を無視しヘッダ名が優先か確認 | ヘッダ改行混入に注意 |
| V5.4.2 | L2 | 提供ファイル名をエンコード/サニタイズ（RFC6266遵守） | 対応可 | 非ASCII/制御文字混入時の挙動確認 | CR/LF, 角括弧, 連想ヘッダ注入対策 |
| V5.4.3 | L2 | 信頼できない取得元のファイルをAVスキャン | 範囲外 | スキャン有無は運用/設計確認 | 検知時の隔離/通知手順も確認 |

# V6 認証

## V6.1 認証ドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.1.1 | L1 | 認証攻撃対策（レート制限/自動化防止/応答方針）の文書化 | 範囲外 | 文書/設定の提示依頼・ヒアリング | アカロック悪用防止の方針含む |
| V6.1.2 | L2 | コンテキスト固有NGワードのリスト化（パスワード禁止語） | 範囲外 | リスト有無の確認 | 組織名/製品名等 |
| V6.1.3 | L2 | 複数経路の統一セキュリティ制御・強度を文書化 | 範囲外 | すべてのログイン経路を洗い出し | SSO/ローカル/API 等 |

---

## V6.2 パスワードセキュリティ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.2.1 | L1 | 最低8桁（推奨15桁） | 対応可 | フロント/サーバの最小長検証 | 実装差異に注意 |
| V6.2.2 | L1 | ユーザが任意にパスワード変更可 | 対応可 | 変更フローの有無確認 | |
| V6.2.3 | L1 | 変更時に現行PWと新PWを要求 | 対応可 | 現行PW省略不可を確認 | |
| V6.2.4 | L1 | 上位弱PWリスト（≥3000）照合 | 部分対応 | 典型弱PWの拒否確認 | 実リストの網羅度は確認外 |
| V6.2.5 | L1 | 文字種ルール強制なし（構成自由） | 部分対応 | 複雑性強制の有無を確認 | NIST準拠傾向 |
| V6.2.6 | L1 | type=password＋一時表示トグル | 対応可 | マスク/表示切替の挙動確認 | |
| V6.2.7 | L1 | 貼り付け/ブラウザ/外部管理を許可 | 対応可 | ペースト禁止の有無 | |
| V6.2.8 | L1 | サーバ側で改変せず厳密検証（大文字化/切捨てなし） | 対応可 | 大文字/末尾空白等で検証 | |
| V6.2.9 | L2 | 64桁以上を許容 | 対応可 | 長文PWの受入/ログイン確認 | フロント制限に注意 |
| V6.2.10 | L2 | 定期変更強制なし（侵害時のみ変更） | 対応可 | 期限強制の有無確認 | |
| V6.2.11 | L2 | 文書化NGワード照合で推測容易PWを排除 | 範囲外 | リスト運用の有無のみ確認 | |
| V6.2.12 | L2 | 侵害PWリスト照合 | 部分対応 | 既知漏えいPW拒否確認 | サービス連携有無 |

---

## V6.3 一般的な認証セキュリティ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.3.1 | L1 | 攻撃対策（レート制限等）を実装 | 対応可 | 連続試行/遅延/ロック挙動確認 | |
| V6.3.2 | L1 | 既定アカウントの不存在/無効化 | 対応可 | admin/root等のログイン試行 | |
| V6.3.3 | L2 | MFA必須（L3はハードウェア要素含む） | 部分対応 | MFA有無/要素種/フィッシング耐性を確認 | パスキー/FIDO推奨 |
| V6.3.4 | L2 | 全認証経路で統一強度・無許可経路なし | 部分対応 | バックドア/隠しエンドポイント探索 | |
| V6.3.5 | L3 | 異常サインインのユーザ通知 | 部分対応 | 地理/UA/失敗後成功の通知有無 | |
| V6.3.6 | L3 | メールを認証要素として不使用 | 対応可 | メールリンクのみでの認証不可を確認 | |
| V6.3.7 | L3 | 資格情報更新後のユーザ通知 | 部分対応 | メアド/UN/PW変更時の通知確認 | |
| V6.3.8 | L3 | 認証エラーでユーザ存在を推測不可 | 対応可 | エラーメッセージ/応答時間の差異検査 | 登録/忘却経路も対象 |

---

## V6.4 認証要素のライフサイクルとリカバリ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.4.1 | L1 | 初期PW/コードは安全生成・短期失効 | 対応可 | 初期化フローの失効確認 | |
| V6.4.2 | L1 | PWヒント/秘密の質問を不使用 | 対応可 | UI/文言の有無確認 | |
| V6.4.3 | L2 | 安全なPWリセット（MFAバイパス不可） | 部分対応 | リセット経路での本人性確認 | |
| V6.4.4 | L2 | MFA要素紛失時は登録時同等の再本人確認 | 範囲外 | 手続/運用ヒアリング中心 | |
| V6.4.5 | L3 | 期限切れ前の更新案内＋リマインダ | 範囲外 | 通知運用の確認 | |
| V6.4.6 | L3 | 管理者はリセット開始のみ可（PW設定不可） | 部分対応 | 管理画面の権限範囲確認 | 代理変更防止 |

---

## V6.5 一般的な多要素認証要件

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.5.1 | L2 | ルックアップ/経路外/ TOTP は一回限り使用 | 対応可 | 再利用試行の拒否確認 | |
| V6.5.2 | L2 | 低エントロピーのルックアップはソルト付ハッシュ保管 | 範囲外 | 保管方式は設計確認 | |
| V6.5.3 | L2 | シード/コードはCSPRNGで生成 | 範囲外 | 実装/設計の確認 | |
| V6.5.4 | L2 | ルックアップ/経路外コードに≥20ビットの熵 | 範囲外 | 桁数/文字集合の設計確認 | |
| V6.5.5 | L2 | 経路外/TOTPの有効時間制限（10分/30秒） | 部分対応 | 期限超過時の拒否確認 | |
| V6.5.6 | L3 | あらゆる要素は紛失時に無効化可能 | 部分対応 | 端末紛失時の失効手続確認 | |
| V6.5.7 | L3 | 生体は二次要素としてのみ使用 | 部分対応 | 生体単体ログイン不可を確認 | |
| V6.5.8 | L3 | TOTPの時刻検証は信頼時間源に基づく | 部分対応 | 端末時刻改ざん耐性の確認 | |

---

## V6.6 経路外認証メカニズム

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.6.1 | L2 | PSTN/SMSは要電話番号検証・代替手段提供（L3は不可） | 部分対応 | SMS依存の度合い/回避策確認 | リスク告知有無 |
| V6.6.2 | L2 | 経路外コードは元リクエストにバインド（再利用不可） | 対応可 | 異セッション/時間差試行で確認 | |
| V6.6.3 | L2 | コード型経路外はレート制限＋高エントロピー検討 | 対応可 | 連続試行のブロック確認 | 64ビット推奨 |
| V6.6.4 | L3 | プッシュ利用時にレート制限/番号照合で爆撃対策 | 部分対応 | 連投時の抑制動作確認 | |

---

## V6.7 暗号認証メカニズム

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.7.1 | L3 | 検証用証明書を改ざん耐性の方法で保管 | 範囲外 | 保管方式の設計確認 | HSM/OS保護等 |
| V6.7.2 | L3 | チャレンジナンス≥64bitで一意 | 対応可 | 重複/短小値の検証困難のため設計確認 | |

---

## V6.8 アイデンティティプロバイダによる認証

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V6.8.1 | L2 | IdP間なりすまし防止（IdPID×UserIDの組合せ識別） | 部分対応 | 同一メールで別IdPの衝突確認 | |
| V6.8.2 | L2 | JWT/SAML等の署名必須・検証 | 対応可 | 署名無し/無効署名の拒否確認 | |
| V6.8.3 | L2 | SAMLアサーションの一意利用（リプレイ防止） | 対応可 | 二重送信の拒否確認 | |
| V6.8.4 | L2 | 期待する認証強度/方法/時刻を検証（acr/amr/auth_time等） | 部分対応 | IdPクレーム検査とフォールバック確認 | 情報未提供時の既定動作 |
# V7 セッション管理

## V7.1 セッション管理ドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V7.1.1 | L2 | 非アクティブ/絶対タイムアウトを文書化し再認証方針を明確化 | 範囲外 | 仕様・運用文書の提示依頼 | NIST要件逸脱の根拠記載 |
| V7.1.2 | L2 | 同時セッション数と上限到達時の動作を文書化 | 範囲外 | 同時ログイン許容/追い出し有無の確認 | |
| V7.1.3 | L2 | SSO/IdPを含むセッション有効期間・終了・再認証の連携を文書化 | 範囲外 | フェデレーション連携設計の確認 | |

---

## V7.2 基本セッション管理セキュリティ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V7.2.1 | L1 | セッショントークン検証は信頼できるバックエンドで実施 | 対応可 | トークン改変/期限切れ時の応答確認 | |
| V7.2.2 | L1 | 静的キーではなく動的な自己完結/リファレンストークンを使用 | 対応可 | APIキー固定の有無を確認 | |
| V7.2.3 | L1 | 参照トークンはCSPRNGで≥128bitエントロピー | 部分対応 | 推測/列挙耐性の簡易評価 | 正確なビット長は設計確認 |
| V7.2.4 | L1 | 認証/再認証時にトークン再発行＋旧トークン失効 | 対応可 | ログイン直後のトークンローテ確認 | セッション固定化対策 |

---

## V7.3 セッションタイムアウト

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V7.3.1 | L2 | 非アクティブタイムアウトで再認証を強制 | 対応可 | 放置後操作での再ログイン要求確認 | 値は文書に準拠 |
| V7.3.2 | L2 | 絶対最大存続期間で再認証を強制 | 部分対応 | 長時間連続利用時の期限切れ確認 | 高価値操作で重点確認 |

---

## V7.4 セッションの終了

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V7.4.1 | L1 | 終了後のセッション再利用を禁止（参照/自己完結型に応じた失効方式） | 対応可 | ログアウト後のAPI/画面アクセスが無効か確認 | ブラックリスト/鍵ローテ等 |
| V7.4.2 | L1 | アカウント無効/削除時は全アクティブセッションを終了 | 部分対応 | 権限剝奪後の継続利用可否検証 | |
| V7.4.3 | L2 | 認証要素更新後に他端末含む全セッション終了のオプション提供 | 対応可 | PW/MFA変更直後の他端末強制ログアウト確認 | |
| V7.4.4 | L2 | すべての保護ページで明確なログアウト導線 | 対応可 | 目立つ位置/1クリック到達確認 | |
| V7.4.5 | L2 | 管理者が個別/全体のセッション終了を実行可能 | 部分対応 | 管理UI/APIの存在・監査ログ確認 | 濫用防止の権限設計 |

---

## V7.5 セッションの悪用に対する防御

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V7.5.1 | L2 | 機密アカウント属性変更前に完全再認証 | 対応可 | メアド/電話/MFA/復旧情報変更時の再認証確認 | |
| V7.5.2 | L2 | ユーザがアクティブセッション一覧と選択終了を実施可能 | 部分対応 | セッション管理画面の有無/終了動作確認 | 再認証を伴うこと |
| V7.5.3 | L3 | 高リスク操作前に追加認証/二次検証を要求 | 部分対応 | 送金/権限変更時のステップアップ確認 | |

---

## V7.6 フェデレーション再認証

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V7.6.1 | L2 | RP-IdP間の有効期間/終了が文書通り動作し必要時に再認証要求 | 範囲外 | IdP設定/契約の確認 | |
| V7.6.2 | L2 | ユーザの同意/明示操作なしに新規アプリセッションを作成しない | 対応可 | サイレントSSO成立条件の確認 | 初回同意の明示性

# V8 認可

## V8.1 認可ドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V8.1.1 | L1 | 機能/データ基盤のアクセス制御ルールを文書化 | 範囲外 | 仕様・権限定義の提示依頼 | 役割/権限/リソース属性の明記 |
| V8.1.2 | L2 | フィールドレベル（読/書）制御を文書化 | 範囲外 | 更新/参照APIの項目別ルール確認 | 状態依存の許可も記載 |
| V8.1.3 | L3 | 環境/コンテキスト属性（時刻/位置/IP/端末等）の定義 | 範囲外 | 収集・評価ポリシーの有無確認 | プライバシー配慮も |
| V8.1.4 | L3 | 環境/コンテキストを用いた意思決定（許可/チャレンジ/拒否/ステップアップ）を文書化 | 範囲外 | リスク閾値と動作の確認 | ログ/監査要件も |

---

## V8.2 一般的な認可設計

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V8.2.1 | L1 | 機能レベルは明示パーミッション必須 | 対応可 | UI/API機能の直接呼出しで拒否確認 | 403/404方針の整合 |
| V8.2.2 | L1 | データ固有アクセスは明示パーミッション（IDOR/BOLA対策） | 対応可 | 他者ID/他テナントIDでの取得/更新試験 | 所有者/共有属性の検証 |
| V8.2.3 | L2 | フィールド単位の許可（BOPLA対策） | 部分対応 | 非許可フィールドの更新/漏えい有無 | レスポンス整形の抜け確認 |
| V8.2.4 | L3 | コンテキストに応じた適応型制御を実装（セッション中も） | 部分対応 | 端末/位置変化でのステップアップ誘発確認 | ルールは文書と一致要 |

---

## V8.3 操作レベルの認可

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V8.3.1 | L1 | 認可は信頼できるサーバ層で適用（クライアント依存しない） | 対応可 | JS保護無効化時でも拒否継続を確認 | API単位で検査 |
| V8.3.2 | L3 | ルール変更は即時反映。不可なら検知/ロールバック等の緩和 | 部分対応 | 役割変更後の権限即時性を確認 | 自己完結トークンの課題 |
| V8.3.3 | L3 | 代理ではなく発信主体の権限で判定（委譲は明示） | 部分対応 | サービス間呼出しで末端がユーザ権限評価か確認 | OBO/DPoP等の設計確認 |

---

## V8.4 他の認可の考慮

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V8.4.1 | L2 | マルチテナントのクロステナント隔離 | 対応可 | テナントID切替/汚染試験 | テナント境界の強制を確認 |
| V8.4.2 | L3 | 管理UIは多層防御（継続的ID検証/端末態勢/リスク分析）で保護 | 部分対応 | ネットワークのみ依存でないか確認 | ステップアップ/連続評価の有無 |

# V9 自己完結型トークン

## V9.1 トークンのソースと完全性

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V9.1.1 | L1 | 署名/MACで改竄検出し検証後にのみ受容 | 対応可 | JWS/JWT/SAMLの署名検証必須・署名無し拒否 | 署名鍵の信頼連鎖確認 |
| V9.1.2 | L1 | アルゴリズム許可リスト運用（`none`禁止/対称・非対称の混在管理） | 部分対応 | `alg`固定/ピン留め確認、意図外アルゴ拒否 | 混在時は鍵混同対策 |
| V9.1.3 | L1 | 検証鍵は事前登録の信頼ソースのみ（`jku/x5u/jwk`は許可リスト検証） | 部分対応 | 動的鍵取得の禁止/許可ドメイン検証 | キー注入攻撃を防止 |

---

## V9.2 トークンコンテンツ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V9.2.1 | L1 | 有効期間検証（`nbf`/`exp` 等） | 対応可 | 期限外拒否・クロックスキュー許容範囲確認 | 長寿命トークンの扱い確認 |
| V9.2.2 | L2 | 用途適合性（IDトークン/アクセストークンの取り違え防止） | 対応可 | エンドポイント毎の受容トークン種を検証 | 認可判定にIDT不可 |
| V9.2.3 | L2 | オーディエンス制限（`aud` を許可リスト照合） | 対応可 | 受信サービス識別子の厳格一致確認 | ワイルドカード不可 |
| V9.2.4 | L2 | 複数オーディエンス発行時は一意な`aud`付与と検証 | 部分対応 | 発行者側設計の確認/`aud`なりすまし検査 | 動的プロビジョニング時の検証強化 |

# V10 OAuth と OIDC

## V10.1 一般的な OAuth と OIDC セキュリティ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V10.1.1 | L2 | トークンは必要コンポーネントのみに送達（BFFではバックエンド限定） | 対応可 | ブラウザ/ネットワークでアクセストークン露出有無を確認 | フロント保管/送信の禁止 |
| V10.1.2 | L2 | 認可応答のセッション/トランザクション紐付け（PKCE/state/nonce） | 部分対応 | CSRF/混入対策の有効性検証 | 値の推測不能性と一意性 |

---

## V10.2 OAuth クライアント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V10.2.1 | L2 | コードフローでPKCEまたはstate検証によりCSRF防止 | 対応可 | `code_verifier`/`state`の整合性テスト | `code_challenge_method=S256` |
| V10.2.2 | L2 | 複数AS時のミックスアップ攻撃防御（`iss`検証等） | 部分対応 | 認可/トークン応答の発行者一致確認 | 事前登録ASのみ許容 |
| V10.2.3 | L3 | 最小権限のスコープ要求 | 対応可 | リクエスト/発行スコープの差分確認 | 過剰スコープ検出 |

---

## V10.3 OAuth リソースサーバ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V10.3.1 | L2 | 自サービス向けトークンのみ受理（`aud`/RIで検証） | 対応可 | `aud`厳格一致/イントロスペクション確認 | ワイルドカード不可 |
| V10.3.2 | L2 | トークンのクレーム（`sub/scope/authorization_details`）で認可実施 | 対応可 | スコープ不足時の拒否を確認 | RARの評価含む |
| V10.3.3 | L2 | ユーザ識別は再割当不可の`iss+sub`で行う | 対応可 | 複数IdP混在時の一意性検証 | 内部IDへの変換 |
| V10.3.4 | L2 | 認証強度/方法/時刻の検証（`acr/amr/auth_time`） | 部分対応 | 高価値操作時に要求水準満たすか確認 | ステップアップ要件 |
| V10.3.5 | L3 | 送信者制約付きAT（mTLS/DPoP）を要求 | 部分対応 | リプレイ耐性試験（チャネル奪取想定） | 実装方式の確認 |

---

## V10.4 OAuth 認可サーバ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V10.4.1 | L1 | リダイレクトURIは事前登録の厳密一致のみ許可 | 対応可 | サブルート/ワイルドカード不許可確認 | 大文字小文字も一致 |
| V10.4.2 | L1 | 認可コードは一回限り・再使用で失効処理 | 対応可 | 二重交換試験で無効化確認 | 既発行AT/RT失効 |
| V10.4.3 | L1 | 認可コードの短寿命化（L1/2:≤10分, L3:≤1分） | 対応可 | 期限超過時の拒否確認 | 時刻同期前提 |
| V10.4.4 | L1 | クライアント毎に許可グラント制限（implicit/password禁止） | 対応可 | 設定/レスポンスを確認 | 廃止フロー遮断 |
| V10.4.5 | L1 | パブリッククライアントはRT保護（DPoP/mTLS推奨/RTローテ） | 部分対応 | 使い回し検知・一括失効確認 | 失効の伝播確認 |
| V10.4.6 | L2 | コードグラントはPKCE必須、`plain`禁止、`code_verifier`検証 | 対応可 | メソッド=S256限定の確認 | 無PKCE拒否 |
| V10.4.7 | L2 | 動的クライアント登録のリスク緩和（メタデータ検証/警告） | 範囲外 | 対象ASが対応するか確認 | 事前審査の有無 |
| V10.4.8 | L2 | RTに絶対有効期限（スライディングでも） | 部分対応 | 長期RTの期限確認 | 失効UIと連動 |
| V10.4.9 | L2 | 利用者UIでAT/RTの失効操作が可能 | 部分対応 | 自己失効と即時性確認 | 監査ログ必須 |
| V10.4.10 | L2 | コンフィデンシャルクライアントのバックチャネルは認証必須 | 対応可 | トークン/失効/PAR等で認証確認 | 弱方式拒否 |
| V10.4.11 | L2 | 必要最小のスコープのみ割当 | 対応可 | デフォルトスコープの最小化確認 | テナント毎に分離 |
| V10.4.12 | L3 | クライアント毎に許可`response_mode`を限定（PAR/JAR活用） | 部分対応 | 期待値以外の拒否確認 | 仕様準拠の検査 |
| V10.4.13 | L3 | `code`グラントはPAR必須 | （欠番） | 現状のAS機能要確認 | 採用計画の確認 |
| V10.4.14 | L3 | PoPアクセストークンのみ発行（mTLS/DPoP） | 部分対応 | 発行種別と検証手順を確認 | RS側要件と整合 |
| V10.4.15 | L3 | サーバサイドのみ：`authorization_details`は改竄不可（PAR/JAR） | 範囲外 | BFF/サーバ発行のみ適用確認 | フロント改竄防止 |
| V10.4.16 | L3 | 強力なクライアント認証（mTLS/self-signed mTLS/private-key-jwt） | 部分対応 | リプレイ耐性/鍵保護を確認 | シークレット型から移行 |

---

## V10.5 OIDC クライアント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V10.5.1 | L2 | IDトークンのリプレイ防止（`nonce`突合） | 対応可 | 認可ReqとIDTの`nonce`一致確認 | 一度消費 |
| V10.5.2 | L2 | ユーザ一意識別は再割当不可な`sub`で | 対応可 | IdP切替時の衝突検出 | `iss+sub`推奨 |
| V10.5.3 | L2 | 悪性ASのメタデータ偽装拒否（発行者URLの厳密一致） | 対応可 | 事前登録OPのみ許容 | `/.well-known/openid-configuration` |
| V10.5.4 | L2 | `aud`は自クライアントIDと等しいことを検証 | 対応可 | 複数`aud`の取扱い確認 | 期待外は拒否 |
| V10.5.5 | L2 | バックチャネルログアウトのDoS緩和とJWT検証 | 部分対応 | `typ=logout+jwt`/`event`/短寿命確認 | `nonce`未使用 |

---

## V10.6 OpenID プロバイダ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V10.6.1 | L2 | 許容レスポンス：`code`/`ciba`/`id_token`/`id_token code`のみ | 対応可 | 暗黙的`token`不許可確認 | `code`優先 |
| V10.6.2 | L2 | 強制ログアウトのDoS緩和（確認取得/`id_token_hint`検証） | 部分対応 | 認可済みRPのみ処理 | 有効期限短縮 |

---

## V10.7 同意管理

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V10.7.1 | L2 | 各認可要求でユーザ同意の保証（不明なクライアントは必ず同意） | 対応可 | 同意画面スキップ有無と条件確認 | 信頼済み設定の監査 |
| V10.7.2 | L2 | 同意画面に範囲/RS/認可詳細/有効期間を明示 | 部分対応 | 表示内容と発行内容の整合性検証 | 誤誘導防止 |
| V10.7.3 | L2 | 付与済み同意の閲覧/変更/取消が可能 | 部分対応 | 自己失効UI/APIの有無確認 | 反映の即時性

# V11 暗号化

## V11.1 暗号インベントリとドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V11.1.1 | L2 | 鍵管理ポリシー文書化（NIST SP 800-57整合・過剰共有禁止） | 部分対応 | ポリシー/手順・運用証跡の取得、サンプル鍵の配布範囲確認 | 共有シークレット/秘密鍵の所有者数を点検 |
| V11.1.2 | L2 | 暗号インベントリ（鍵/証明書/アルゴリズム/利用範囲）維持 | 部分対応 | 資産台帳/証明書一覧・キーマップの収集・差分監査 | 使用不可領域/データ分類の明記 |
| V11.1.3 | L3 | 暗号検出メカニズム（暗号API/操作の網羅検知） | 未対応 | バイナリ/コンテナ/ソースの静的解析、ランタイム観測 | SBOM/CI検出が望ましい |
| V11.1.4 | L3 | PQC等への移行計画を含む継続的な暗号インベントリ更新 | 未対応 | ロードマップ・鍵/証明書の移行方針の確認 | 実装/運用双方の計画必須 |

---

## V11.2 安全な暗号の実装

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V11.2.1 | L2 | 業界検証済み実装（ライブラリ/ハードウェア）を使用 | 対応可 | 依存ライブラリ/バージョン確認、FIPS対応可否の確認 | 独自実装の排除 |
| V11.2.2 | L2 | 暗号の敏捷性（アルゴリズム/鍵更新/再暗号化が可能） | 部分対応 | 設定でアルゴリズム切替可否、ロールオーバーテスト | PQC移行の余地 |
| V11.2.3 | L2 | 最低128-bitセキュリティ相当の強度を使用 | 対応可 | 鍵長/曲線/パラメータの実測 | RSA≥3072, ECC≥256 |
| V11.2.4 | L3 | タイミング一定/早期return無（サイドチャネル低減） | 未対応 | 実装レビュー、タイミング差観測 | 比較/復号/署名処理対象 |
| V11.2.5 | L3 | フェイルセーフと安全なエラー処理（POODLE/パディングオラクル回避） | 部分対応 | 異常系のレスポンス一律化、再試行/詳細漏洩抑止 | ログのみ詳細化 |

---

## V11.3 暗号アルゴリズム

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V11.3.1 | L1 | 安全でないモード/パディング（ECB, PKCS#1 v1.5等）不使用 | 対応可 | 暗号設定/コード検査、サンプル暗号文生成 | 旧互換の無効化 |
| V11.3.2 | L1 | 承認済み暗号/モード（例：AES-GCM）のみ使用 | 対応可 | 実運用設定・TLS/CMS/JWEのアルゴ確認 | 不許可アルゴ拒否 |
| V11.3.3 | L2 | 改ざん防止（AEAD推奨 or Enc+MAC） | 対応可 | 平文改変試験で復号失敗を確認 | Enc-then-MAC推奨 |
| V11.3.4 | L3 | ノンス/IVの一意性・生成手法の適正 | 部分対応 | 高頻度連続リクエストで衝突検知 | キー毎・メッセージ毎の一意性 |
| V11.3.5 | L3 | Encrypt-then-MACの順序で運用 | 部分対応 | 実装順序の確認、検証コード | AEADなら充足 |

---

## V11.4 ハッシュ化とハッシュベース関数

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V11.4.1 | L1 | 暗号用途は承認済みハッシュのみ（MD5等禁止） | 対応可 | 依存関数/署名スキームの確認 | 移行計画が必要な場合あり |
| V11.4.2 | L2 | パスワード保管は承認済みKDF＋適正パラメータ | 部分対応 | ハッシュ方式/コスト設定検証、GPU耐性評価 | Argon2/BCrypt/PBKDF2等 |
| V11.4.3 | L2 | 署名用途は衝突耐性/十分な出力長 | 対応可 | SHA-256/384/512の使用確認 | 用途に応じ長さ選定 |
| V11.4.4 | L2 | パスワード→鍵導出はストレッチ付KDFを使用 | 対応可 | Salt/Iterations/Memoryの確認 | キー再生成試験 |

---

## V11.5 乱数値

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V11.5.1 | L2 | 推測不能値はCSPRNGで≥128-bitエントロピー | 対応可 | トークン/IV/nonce/コード生成源の確認 | UUIDv4のみでは不足の可能性 |
| V11.5.2 | L3 | 高負荷時でも安全に機能する乱数生成設計 | 未対応 | ベンチ/障害時の劣化観測 | ブロッキング/枯渇対策 |

---

## V11.6 公開鍵暗号

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V11.6.1 | L2 | 鍵生成/署名は承認済みアルゴと安全な実装 | 対応可 | 生成手順/鍵品質/乱数評価 | 弱RSA鍵/脆弱曲線の排除 |
| V11.6.2 | L3 | 安全な鍵交換（DH/ECDH）と安全パラメータ | 部分対応 | パラメータ/曲線/群サイズの検証 | 非TLS用途も対象 |

---

## V11.7 使用中のデータの暗号化

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V11.7.1 | L3 | フルメモリ暗号化で使用中データを保護 | 範囲外 | プラットフォーム/インフラ仕様確認 | IaaS/専用HW要件 |
| V11.7.2 | L3 | 最小化と迅速再暗号化（露出時間短縮） | 部分対応 | 平文滞留の計測・スナップショット確認 | キャッシュ/ログも対象 |

# V12 安全な通信

## V12.1 一般的な TLS セキュリティガイダンス

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V12.1.1 | L1 | TLS1.2/1.3のみ許可し最新を優先 | 対応可 | サーバ/LBのプロトコル一覧・スキャンで検証 | 旧TLS/SSL無効化 |
| V12.1.2 | L2 | 推奨暗号スイートのみ・強力なスイート優先（L3は前方秘匿性必須） | 部分対応 | Cipher設定と実測ハンドシェイク確認 | ECDHE系優先 |
| V12.1.3 | L2 | mTLSのクライアント証明書を信頼鎖で厳格検証 | 未対応 | CRL/OCSP/ポリシーOID検証 | 認証/認可に利用可 |
| V12.1.4 | L3 | OCSP Stapling等で失効確認を有効化 | 未対応 | サーバ設定・中間CA対応確認 | ソフト/ハードフェイル方針 |
| V12.1.5 | L3 | ECH有効化でSNI等メタデータ秘匿 | 未対応 | 対応CDN/実装の検証 | クライアント互換性に留意 |

## V12.2 外部向けサービスとの HTTPS 通信

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V12.2.1 | L1 | すべての外部HTTP接続でTLSを強制・フォールバック禁止 | 対応可 | HTTP→HTTPS強制/HSTS/リダイレクト検証 | 平文API禁止 |
| V12.2.2 | L1 | 公的に信頼できる証明書を使用 | 対応可 | 証明書チェーン/SAN/有効期限確認 | ワイルドカードは厳格管理 |

## V12.3 一般的なサービス間通信セキュリティ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V12.3.1 | L2 | すべてのイン/アウトバウンド接続でTLS等を使用し平文/ダウングレード不可 | 部分対応 | SSH/DB/メッセージ基盤/管理系の暗号化確認 | レガシープロトコル遮断 |
| V12.3.2 | L2 | TLSクライアントはサーバ証明書を検証 | 対応可 | ピンニング/信頼ストア/ホスト名検証 | MITM耐性強化 |
| V12.3.3 | L2 | 内部HTTPサービス間もTLS等で暗号化しフォールバック禁止 | 部分対応 | サービスディスカバリ/Ingress設定確認 | Pod内/ノード間も対象 |
| V12.3.4 | L2 | 内部TLSは信頼できる証明書（社内CA/自己署名は許可リスト化） | 対応可 | 受信側のTrust設定・ローテーション確認 | mTLS併用推奨 |
| V12.3.5 | L3 | サービス間は強力な相互認証（mTLS/PoP等）とリプレイ耐性 | 未対応 | サービスメッシュ/証明書管理の検証 | ID連携・短寿命証明書 |

# V13 構成

## V13.1 構成ドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V13.1.1 | L2 | すべての外部/内部通信先を文書化 | 対応可 | エンドポイント台帳・環境差分の入手と突合 | 動的設定(環境変数/SSM)も範囲 |
| V13.1.2 | L3 | 接続上限・到達時の挙動(フォールバック/リカバリ)定義 | 未対応 | 疑似高負荷で接続枯渇を再現し挙動確認 | 連鎖DoS回避が狙い |
| V13.1.3 | L3 | リソース管理(解放/タイムアウト/再試行方針)を文書化 | 部分対応 | タイムアウト/リトライ設定の実測・コード確認 | 同期HTTPは短いTO・再試行抑制 |
| V13.1.4 | L3 | 重要シークレットとローテーション計画を文書化 | 未対応 | Vault運用文書/証跡確認 | 影響範囲と緊急ロールオーバー手順 |

## V13.2 バックエンド通信構成

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V13.2.1 | L2 | サービス間は個別ID/短期トークン/証明書で相互認証 | 部分対応 | mTLS/JWT検証/STS短期発行の確認 | 共有アカウント/APIキー固定を排除 |
| V13.2.2 | L2 | バックエンドは最小権限アカウントで実行 | 対応可 | RBAC/DB権限/OS権限レビュー | 特権実行の痕跡検出 |
| V13.2.3 | L2 | デフォルトクレデンシャル不使用 | 対応可 | 既定ID/パスの総当たり確認 | 初期セットアップの残骸検査 |
| V13.2.4 | L2 | 外部到達の許可リスト化(送信/読込/FS) | 部分対応 | egress FW/アウトバウンドACL検証 | DNS/HTTPプロキシ経路も対象 |
| V13.2.5 | L2 | Web/アプリサーバの送信先を許可リスト化 | 部分対応 | サーバ側の送信制御/SELinux/AppArmor確認 | SSRF被害面の縮小 |
| V13.2.6 | L3 | 接続並列数/TO/再試行/上限時挙動を構成通り実装 | 未対応 | Chaos/限界試験でドキュメント通りか検証 | バックオフ/ジャitter必須 |

## V13.3 シークレット管理

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V13.3.1 | L2 | Vault等で安全に生成/保管/AC/廃棄(コード同梱禁止) | 部分対応 | リポジトリ露出検査・ランタイム取得経路確認 | L3はHSM等ハード支援 |
| V13.3.2 | L2 | シークレットへのアクセスは最小権限 | 対応可 | Vaultポリシー/監査ログの検証 | 認可境界のテスト |
| V13.3.3 | L3 | すべての暗号操作は隔離モジュールで実施 | 未対応 | 署名/復号の実行場所トレース | 鍵マテリアルの外部流出防止 |
| V13.3.4 | L3 | 文書化された失効/ローテーションを実運用 | 未対応 | 有効期限/自動ローテーション実証 | ランブック整備 |

## V13.4 意図しない情報漏洩

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V13.4.1 | L1 | .git/.svn等のメタデータ非公開 | 対応可 | 既知パス列挙/誤公開検査 | デプロイ時除外 |
| V13.4.2 | L2 | 本番でデバッグ無効 | 対応可 | ヘッダ/フラグ/スタックトレース確認 | DEBUG/TRACE出力禁止 |
| V13.4.3 | L2 | ディレクトリリスティング無効 | 対応可 | 典型パスで列挙可否確認 | Webサーバ設定 |
| V13.4.4 | L2 | HTTP TRACE 無効 | 対応可 | TRACEメソッド試験 | CORSと併発注意 |
| V13.4.5 | L2 | ドキュメント/監視エンドポイント非公開 | 部分対応 | /swagger,/actuator等の公開範囲確認 | 認証/CGNAT内限定 |
| V13.4.6 | L3 | バックエンド詳細バージョン非表示 | 部分対応 | バナー/ヘッダ/エラー文言確認 | 情報連鎖の芽を摘む |
| V13.4.7 | L3 | 処理対象拡張子を許可リスト化 | 未対応 | 任意拡張子のアップロード/配信実験 | ソース/設定漏洩抑止 |

# V14 データ保護

## V14.1 データ保護ドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V14.1.1 | L2 | 機密データの特定・分類（Base64/JWT含む） | 対応可 | データフロー図/DBスキーマ/APIレスポンスから機密項目棚卸 | 規制要件に合わせ分類 |
| V14.1.2 | L2 | 保護要件（暗号/完全性/保持/ログ/DB暗号/プライバシー）の文書化 | 部分対応 | 要件トレーサビリティ確認・サンプル設定の実地検証 | テーブル単位の保持/マスキング方針 |

## V14.2 一般的なデータ保護

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V14.2.1 | L1 | 機密値をURL/クエリに入れない | 対応可 | プロキシ/サーバログでURLパラメータ検査 | APIキー/トークン検出 |
| V14.2.2 | L2 | サーバ側キャッシュ/ロードバランサでの機密データ保持抑止 | 部分対応 | Cache-Control/ヘッダ/一時ファイルの痕跡確認 | 使用後削除の確認 |
| V14.2.3 | L2 | 機密データを第三者トラッカーへ送信禁止 | 対応可 | CSP/Requestミラーで送信先解析 | SDK/タグ監査 |
| V14.2.4 | L2 | 分類に応じたコントロールを実装（暗号/ログ/PET等） | 部分対応 | 設定と実装の差分評価 | データ毎に適用確認 |
| V14.2.5 | L3 | Web Cache Deception耐性（適正キャッシュ/404/302） | 未対応 | キャッシュ鍵ずらし/偽拡張子での侵入試験 | 動的機密は非キャッシュ |
| V14.2.6 | L3 | 機密データの最小化・UIマスキング | 部分対応 | APIペイロード/画面表示の露出点検 | 全桁表示は明示操作時のみ |
| V14.2.7 | L3 | 保持期間に基づく自動削除 | 未対応 | スケジュール削除/法定保持の整合確認 | バックアップも対象 |
| V14.2.8 | L3 | アップロードファイルのメタデータから機密削除 | 未対応 | EXIF/Officeメタの除去確認 | 同意時のみ保持可 |

## V14.3 クライアントサイドのデータ保護

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :---: | :---: | :--- | :---: | :--- | :--- |
| V14.3.1 | L1 | セッション終了時のクライアントストレージ/DOMの認証情報クリア | 対応可 | ログアウト後のストレージ/メモリ観測 | Clear-Site-Data併用 |
| V14.3.2 | L2 | 機密データのブラウザキャッシュ防止ヘッダ | 対応可 | Cache-Control: no-store 等の有効性確認 | 中間キャッシュも想定 |
| V14.3.3 | L2 | ブラウザストレージへ機密格納禁止（セッショントークン除く） | 部分対応 | local/session/IndexedDB/Cookieを動的点検 | 暗号化済でも原則NG |

# V15 セキュアコーディングとアーキテクチャ

## V15.1 セキュアコーディングとアーキテクチャドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V15.1.1 | L1 | 脆弱なサードパーティの修復SLAを文書化 | 部分対応 | 依存関係CVEと修復実績の突合 | クリティカルは緊急、他はリスク別SLA |
| V15.1.2 | L2 | SBOM/信頼リポジトリからの取得 | 対応可 | SBOM提出・署名/出所検証 | 依存関係の完全性確認 |
| V15.1.3 | L2 | 高負荷/重処理の特定と防御方針 | 部分対応 | 負荷機能のDOS耐性テスト | キュー化/並列上限/非同期化 |
| V15.1.4 | L3 | リスクのあるコンポーネントを明示 | 未対応 | 使途・影響範囲の棚卸 | メンテ不十分/EOL等を明記 |
| V15.1.5 | L3 | 危険な機能の使用箇所を明示 | 未対応 | 逆シリアライズ/動的実行等の洗出し | 追加統制の前提資料 |

## V15.2 セキュリティアーキテクチャと依存関係

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V15.2.1 | L1 | 修復SLA違反の依存を本番に含めない | 部分対応 | 既知脆弱版の有無チェック | 例外はリスク承認要 |
| V15.2.2 | L2 | 重処理による可用性喪失対策を実装 | 部分対応 | レート制限/バルク操作検証 | 仕様と実装の一致確認 |
| V15.2.3 | L2 | 本番に不要物(テスト/サンプル)除外 | 対応可 | ルート/静的配下探索 | デプロイ設定レビュー |
| V15.2.4 | L3 | 想定リポジトリのみ取り込み(依存攪乱対策) | 未対応 | 依存解決ログ/lockの検証 | 名前乗っ取り/typosquatting |
| V15.2.5 | L3 | 危険/リスク部位をサンドボックス等で隔離 | 未対応 | 権限分離/ネット分離の実証 | container/seccomp/AppArmor 等 |

## V15.3 防御的コーディング

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V15.3.1 | L1 | 必要フィールドのみ返却(最小化) | 部分対応 | APIレスポンス差分/過剰情報検出 | データ最小化 |
| V15.3.2 | L2 | バックエンドの外部URL追従を抑止 | 対応可 | 自動リダイレクト無効の検証 | SSRF連鎖抑止 |
| V15.3.3 | L2 | マスアサインメント防御(許可リスト) | 部分対応 | 更新可能フィールドの強制検証 | フレームワーク設定確認 |
| V15.3.4 | L2 | 信頼できるヘッダでクライアントIPを扱う | 部分対応 | X-Forwarded-For 等の信頼境界確認 | ログ/レート制限の根拠統一 |
| V15.3.5 | L2 | 型安全/厳密比較で型混同を回避 | 未対応 | 静的解析/ユニットで型検証 | 言語特性に依存 |
| V15.3.6 | L2 | JSのプロトタイプ汚染対策(Map/Set等) | 未対応 | 悪性__proto__/constructor注入試験 | 依存ライブラリも対象 |
| V15.3.7 | L2 | HTTPパラメータ汚染防御 | 未対応 | 同名キー混在/多値処理の検証 | ソース別優先規則の定義 |

## V15.4 安全な同時並行性

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V15.4.1 | L3 | 共有資源はスレッドセーフ型＋同期で保護 | 未対応 | 競合状態の動的検出/負荷試験 | ロック/セマフォ適用状況 |
| V15.4.2 | L3 | TOCTOUを避ける原子的操作 | 未対応 | ファイル/権限チェックの原子性検証 | OS/DBの原子API利用 |
| V15.4.3 | L3 | ロック秩序/タイムアウトでデッドロック回避 | 未対応 | ロックグラフ/タイムアウト検証 | ロックは責任境界内に限定 |
| V15.4.4 | L3 | 公平な資源配分(スレッドプール等) | 未対応 | 枯渇/飢餓の検出と緩和確認 | 優先度逆転対策 |

# V16 セキュリティログ記録とエラー処理

## V16.1 セキュリティログ記録ドキュメント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V16.1.1 | L2 | 収集イベント/形式/保存/閲覧権限/保存期間を網羅したログインベントリを文書化 | 部分対応 | 設計資料と実装ログの突合、抜け項目の確認 | 監査証跡の前提。各層の責任者明記が望ましい |

## V16.2 一般的なログ記録

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V16.2.1 | L2 | 各ログに「いつ/どこ/誰/何」を含む必須メタデータ | 部分対応 | 実ログのサンプリング確認（actor, action, object, origin 等） | 解析可能性の担保 |
| V16.2.2 | L2 | タイムソース同期とUTC/明示TZでの記録 | 未対応 | 複数ホストの時刻ずれ/タイムゾーン混在検出 | SIEM相関精度に直結 |
| V16.2.3 | L2 | 文書化した対象のみを保存/送信（シャドーログ禁止） | 対応可 | 設計→実運用の差分検出 | データ最小化/漏洩抑止 |
| V16.2.4 | L2 | 共通のログ形式に正規化（プロセッサで可読・相関可能） | 部分対応 | 形式不一致/欠損フィールドの検出 | JSON/CEF等へ統一 |
| V16.2.5 | L2 | 機密データは非記録/マスク/ハッシュ等、保護レベル準拠 | 部分対応 | トークン/PIIの露出スキャン | マスキング規則の例外管理必須 |

## V16.3 セキュリティイベント

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V16.3.1 | L2 | 認証の成功/失敗と要素種別を記録 | 対応可 | 認証試行→ログ内容の突合 | ATO検知の基礎 |
| V16.3.2 | L2 | 認可失敗を記録（L3は全認可判定の記録） | 部分対応 | IDOR/BOLA試験時のログ有無確認 | 機密値は記録しない |
| V16.3.3 | L2 | セキュリティ制御バイパス試行（入力/業務ロジック/自動化）を記録 | 未対応 | WAF/アプリ側検知イベントの有無 | ルールセットの網羅性 |
| V16.3.4 | L2 | 予期しないエラーや制御障害（例：TLS失敗）を記録 | 部分対応 | エラー誘発→ログ追跡 | 可観測性と復旧短縮 |

## V16.4 ログ保護

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V16.4.1 | L2 | ログインジェクション防止（適切エンコード） | 部分対応 | 改行/制御文字/テンプレ挿入の挙動確認 | SIEM誤認・回避対策 |
| V16.4.2 | L2 | ログのアクセス制御/改竄不可（WORM等） | 未対応 | 改竄耐性/権限分離の検証 | 署名/ハッシュ鎖も有効 |
| V16.4.3 | L2 | 侵害分離のため外部の分離基盤へ安全転送 | 対応可 | 転送経路の暗号化/再送制御確認 | 片方向転送/最小権限 |

## V16.5 エラー処理

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V16.5.1 | L2 | 例外時は一般メッセージのみを返し内部情報を秘匿 | 部分対応 | 例外誘発→レスポンス/ログの情報露出確認 | スタック/SQL等の秘匿 |
| V16.5.2 | L2 | 外部依存障害でも安全に継続（CB/デグレード） | 未対応 | 依存先ダウン時の挙動評価 | 安全側に倒す設計 |
| V16.5.3 | L2 | フェイルオープン防止（検証失敗時に処理中止） | 対応可 | バリデーション強制失敗→取引不成立確認 | 取引整合性の担保 |
| V16.5.4 | L3 | 最終手段ハンドラで未処理例外を捕捉・記録 | 未対応 | プロセス落ち/未捕捉例外のテスト | 言語特性に応じた代替要 |

# V17 WebRTC

## V17.1 TURN サーバ

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V17.1.1 | L2 | TURNの到達先を予約/特別用途IPへ禁止（IPv4/IPv6） | 対応可 | STUN/TURN設定取得→任意宛先中継試行、特殊レンジ(127.0.0.0/8, RFC1918, 169.254/16, ::1/128 等)への中継可否を検証 | オープンリレー悪用/SSRF横展開の抑止 |
| V17.1.2 | L3 | 多数ポート確保でも枯渇しないレート制御/割当制限 | 未対応 | 大量アロケート/チャネルBind連続実施で資源枯渇・他ユーザ影響を観測 | 帯域/ポート上限・同時セッション上限の実測が必要 |

## V17.2 メディア

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V17.2.1 | L2 | DTLS証明書鍵の管理/保護をポリシー化 | 部分対応 | キーマテリアル格納先/ローテーション/アクセス権の確認 | 鍵流出時は全セッション危殆化 |
| V17.2.2 | L2 | 承認済みDTLS暗号/DTLS-SRTP保護プロファイルの採用 | 対応可 | サーバのCipher一覧/プロファイルを握手から確認 | 非推奨スイート無効化必須 |
| V17.2.3 | L2 | SRTP認証必須化でRTPインジェクション/DoS防止 | 部分対応 | 改竄RTP注入を試行し再生拒否/警告を確認 | SRTP認証タグ検証が鍵 |
| V17.2.4 | L2 | 不正SRTPパケット混入時も処理継続（耐性） | 未対応 | フォーマット不正/リプレイ/古いシーケンス投入の影響評価 | ドロップ/隔離/メトリクス必須 |
| V17.2.5 | L3 | 正規大量SRTPでもサービス継続（フラッド耐性） | 未対応 | 送信側を正規でスパイク→遅延/ドロップ/CPU飽和観測 | レート制御/優先度制御 |
| V17.2.6 | L3 | DTLS “ClientHello” Race Condition 脆弱性非影響 | 未対応 | 既知PoC/同時ハンドシェイク競合試験 | ベンダ通告/設定で軽減可 |
| V17.2.7 | L3 | 大量SRTP時も録画機構が継続 | 未対応 | レコーディング有効時の負荷試験→ファイル整合性確認 | I/Oボトルネック検証 |
| V17.2.8 | L3 | DTLS証明書とSRTPフィンガープリント照合/不一致で切断 | 対応可 | SDPのa=fingerprint と実証明書の一致検証→改竄時の切断確認 | MITM/偽中継の排除 |

## V17.3 シグナリング

| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
| :--: | :--: | :-- | :--: | :-- | :-- |
| V17.3.1 | L2 | フラッド下でも正当メッセージ処理継続（レート制限） | 部分対応 | 信号面DoS(Offer/Answer/ICE更新乱発)下で成功率/遅延計測 | 優先度/キュー隔離が有効 |
| V17.3.2 | L2 | 不正シグナリング入力でも可用性維持（堅牢化） | 部分対応 | 異常長/型不整合/境界値/Fuzz投入→クラッシュ/リーク有無 | 入力検証/例外処理/監視連携 |

