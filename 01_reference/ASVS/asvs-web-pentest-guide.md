# ASVS v5.0 要点サマリ
- 本サマリは ASVS v5.0 の V1〜V10 を前提資料として、Webペネトレーションテスト（WebPT）で実施・判定しやすい検査観点を抽出し、個別要件の扱い（対応/一部対応/範囲外）を整理したもの。
- 範囲外は主に「設計/運用/文書レビュー中心」「構成監査のみで実挙動からは検証困難」などを理由とする。
- https://github.com/owasp-ja/asvs-ja/tree/master/5.0/ja
---

## V1 Encoding & Sanitization（エンコーディングとサニタイゼーション）
| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
|---|---:|---|---|---|---|
| V1.1.1 | L1 | パラメータ化クエリでSQLi防止 | 対応 | 代表的SQLiペイロード（エラー/ブラインド/時間）で確認 | ORM層でも確認 （元ID: "V1/1.2.4"） |
| V1.1.2 | L1 | OSコマンド注入の抑止 | 対応 | コマンド境界/メタ文字での逸脱有無を安全域で確認 | 破壊操作は行わない （元ID: "V1/1.2.5"） |
| V1.1.3 | L2 | LDAPインジェクション対策 | 対応 | 予約文字エスケープ/パラメトライズの挙動確認 | データ有無でサインを判定 （元ID: "V1/1.2.6"） |
| V1.1.4 | L3 | CSV/数式インジェクション対策 | 対応 | 先頭=,+,-,@ 等の扱いと単引用符付与の有無を検査 | エクスポート機能対象 （元ID: "V1/1.2.10"） |
| V1.1.5 | L1 | HTML入力のサニタイゼーション | 対応 | WYSIWYG投稿でスクリプト除去/属性制限の有無 | DOMPurify等の実効性 （元ID: "V1/1.3.1"） |
| V1.1.6 | L2 | SVGスクリプト排除 | 対応 | inline/ファイルSVGのscript/foreignObjectの扱いを確認 | 画像再書き出しも確認 （元ID: "V1/1.3.4"） |
| V1.1.7 | L1 | XXE無効化 | 対応 | 外部エンティティ解決・外向き到達の有無を安全な検体で確認 | DNS/HTTP観測 （元ID: "V1/1.5.1"） |
| V1.1.8 | L2 | 不安全デシリアライゼーション禁止 | 一部対応 | 既知安全ペイロードで到達/拒否動作を黒箱確認 | 実装詳細は構成監査領域 （元ID: "V1/1.5.2"） |
| V1.1.9 | L3 | パーサ間の解釈整合 | 対応 | 二重/混在エンコード・区切り差異で解釈ズレ発生有無を確認 | WAF/アプリ食い違い （元ID: "V1/1.5.3"） |
| V1.1.10 | L2 | 「保存時エンコードの禁止」等の設計原則 | 範囲外 | 設計/ドキュメント確認のため範囲外 | 原則は認識し観測補助 （元ID: "V1/1.1.x"） |

## V2 Validation & Business Logic（入力検証と業務ロジック）
| 章/要件ID | レベル | 要点 | 対応可否 | WebPTでの扱い | 備考 |
|---|---:|---|---|---|---|
| V2.1.1 | L1 | 重要入力の肯定的検証 | 対応 | スキーマ/桁数/集合/範囲逸脱で拒否確認 | 重要決定に関与する入力重点 （元ID: "V2/2.2.1"） |
| V2.1.2 | L1 | サーバ側検証の徹底 | 対応 | クライアント改変/直送での受入可否を検査 | UI検証は補助 （元ID: "V2/2.2.2"） |
| V2.1.3 | L1 | 手順（状態機械）の順守 | 対応 | 直リンク/遷移スキップ/Back操作などで迂回可否 | 代表的BLogic （元ID: "V2/2.3.1"） |
| V2.1.4 | L2 | トランザクション整合/ロールバック | 一部対応 | 検体操作で一部再現、DB一貫性は観測 | 完全性は構成監査併用 （元ID: "V2/2.3.3"） |
| V2.1.5 | L2 | 競合/並行実行の制御 | 対応 | 同時送信で二重適用/在庫競合の有無 | レース検査 （元ID: "V2/2.3.4"） |
| V2.1.6 | L2 | レート/クォータによる自動化抑止 | 対応 | 高頻度送信時の制限/遅延/ブロック確認 | TOU順守の範囲で （元ID: "V2/2.4.1"） |
| V2.1.7 | L1–L2 | バリデーション/業務制約の文書化 | 範囲外 | 文書レビュー主体のため範囲外 | 仕様齟齬は指摘可能 （元ID: "V2/2.1.x"） |