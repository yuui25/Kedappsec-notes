# PayloadsAllTheThingsに基づく Webペネトレーション開始要件

## 1. 概要
**PayloadsAllTheThings** は、Web アプリケーションセキュリティ向けのペイロードとバイパス集（ペイロードリスト）で、ペンテスト／CTF／バグバウンティの現場でよく参照されます。実用的なペイロード、各種脆弱性ごとの例、Burp 用の Intruder ファイルなどが揃っています。  
参照: PayloadsAllTheThings（GitHub / docs）.  
(公式リポジトリ／ホスティングページ参照)  
- https://github.com/swisskyrepo/PayloadsAllTheThings  
- https://swisskyrepo.github.io/PayloadsAllTheThings/  

## 2. 本書の目的
PayloadsAllTheThings を **単なる参照集**としてではなく、実際の「Web ペネトレーションテスト（攻撃実行を伴うテスト）」に結びつけて利用するための最小要件を整理します。最後に、脆弱性診断（Vulnerability Assessment）との違いも明確にします。

## 3. 必須技術スキル（個人／チーム）
- HTTP/HTTPS と関連ヘッダ（メソッド、Cookie, CORS, CSP, Content-Type 等）を理解。  
- Web 認証・セッション管理（クッキー、JWT、OAuth フロー、MFA）に関する深い理解。  
- 代表的な脆弱性の攻撃手法（XSS, SQLi, CSRF, SSRF, IDOR, File Upload, Deserialization 等）の実践的知識と PoC 作成能力。  
- Burp Suite（Proxy/Intruder/Repeater/Extender）の上級操作。PayloadsAllTheThings は Burp 用のペイロードや Intruder ファイルを多く含むため、Burp のスキルは必須。

## 4. 必須ツールと環境
- **Burp Suite Pro（推奨） / Community**（Proxy, Intruder, Repeater, Collaborator など）  
- **ブラウザ開発者ツール**（DOM インスペクト、ネットワーク、Cookie）  
- **軽量 HTTP クライアント**（curl, httpie）  
- **スクリプト言語**（Python + requests / Node.js 等） — PoC 自動化やデータ整形に必須  
- **ローカル実験環境**（Docker ベースの脆弱アプリや OWASP Juice Shop 等）で安全に攻撃を試せること  
- **PayloadsAllTheThings のローカルコピー（git clone）**：ネットワークが不安定な現場でもオフラインで参照できるようにする。  

## 5. 方法論・作業フロー（最低限）
1. **スコープ確認と合意**（ターゲット範囲、認可済みアカウント、禁止事項、破壊行為の有無） — 法的安全確保が最優先。  
2. **情報収集（Recon）**：公開情報、サブドメイン、公開API、技術スタックの把握。  
3. **手動探索 + 適切な Payload 選定**：PayloadsAllTheThings から脆弱性カテゴリ別にペイロードを選び、Burp や Repeater/Intruder で手動検証。  
4. **PoC 作成**：成功時は最低限の PoC（再現手順、リクエスト/レスポンス、スクリーンショット）を残す。  
5. **深掘り（攻撃連鎖）**：単一脆弱性から横展開・特権昇格・情報漏洩に至る攻撃連鎖を検証する（これが“ペネトレーション”の核）。OWASP WSTG 等のテストケースを参照して深掘りすることを推奨。

## 6. 法務・エンゲージメント要件（必須）
- **書面による許可（スコープ + ルール）**：必須。許可がない攻撃は犯罪行為。  
- **通知先とエスカレーションルール**：重大な発見（情報漏洩等）時の連絡経路と対応手順。  
- **非破壊条件の取り決め**（切断やサービス停止を避ける方針等）。  
これらは脆弱性診断でも必要だが、攻撃実行を伴うペネトレーションではより厳密に。

## 7. 安全対策と証跡管理
- **ログとキャプチャの保持**（リクエスト/レスポンス、Burp のセッション、PCAP 必要時）、トラブル発生時の証跡として必須。  
- **タイムボックスとバックアウト基準**：検査手順の途中でサービス影響が出たら直ちに中断できる仕組み。  
- **盗用/危険ペイロードの扱い注意**：PayloadsAllTheThings は実用的なペイロードを含むため、誤って運用環境で過度な攻撃を行わないよう注意。

## 8. チーム体制・スキルセット（望ましい）
- **リードテスター（攻撃設計・法務調整担当）**  
- **アタッカー（探索・PoC作成）**  
- **レポーター / エビデンス整理**  
- **レビューア（品質保証）**  
小規模であれば二人でローテーションしつつ、外部レビューを入れると良い。

## 9. Web 脆弱性診断（Vulnerability Assessment）との違い（明確化）
- **目的**：脆弱性診断は「脆弱性の洗い出し・一覧化」が中心。ペネトレーションは「攻撃者になりきって実際に侵入や横展開を試す」点が違う。  
- **深さ**：脆弱性診断は広く浅く。ペネトレーションは狭く深く（攻撃連鎖、特権昇格を重視）。  
- **成果物**：脆弱性診断は一覧＋優先順位。ペネトレーションは詳細な攻撃シナリオ、PoC、攻撃連鎖レポート。  
- **危険度**：ペネトレーションは実害リスク（サービス停止やデータ漏洩）を伴う可能性が高いので、より厳格な法的ルールと安全策が必要。

## 10. PayloadsAllTheThings を安全かつ効果的に使うための運用ルール（実務チェックリスト）
- ローカルに `git clone` して最新版を保持。更新はレビューして業務ルールに合うか確認。  
- ペイロードをそのまま運用環境に投げない（事前にステージングで検証）。  
- 攻撃実行前に必ずスコープ/ルールの確認（書面）。  
- 成果物は PoC（手順・ログ・スクショ）を必ず残す。  
- 重大インシデントの際は即エスカレーション、かつ変更履歴（誰が何をしたか）を明確に。  

## 11. 参考（主な一次資料）
1. PayloadsAllTheThings — GitHub / ホームページ（ペイロード集・セクション一覧）。  
2. PayloadsAllTheThings（ペイロード例：Reverse Shell 等のチートシート）。  
3. OWASP Web Security Testing Guide（WSTG） — ペネトレーション手順とテストケースのフレームワーク。  
4. Hack The Box / Deepstrike / Security vendor articles — 脆弱性診断とペネトレーションの違いを説明する記事（実務上の取り扱いの違い）。
