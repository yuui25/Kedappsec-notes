<<<BEGIN>>>
# 01_asm_passive-recon_資産境界→優先度付け.md

（先頭要約：このプレイブックの位置づけ）
- 目的：ASM/OSINT（パッシブ）だけで「資産境界」と「攻め筋の優先度」を作り、次工程（Web/NWの深掘り）を外さない
- 主役：ツールやコマンドではなく、観測結果の“意味（境界・依存・権限）”と“次の一手（分岐）”
- 対象：原則パッシブ（公開情報・外部観測）で完結。低アクティブ/アクティブは別プレイブックで扱う前提

## 目的（このプレイブックで到達する状態）
- 対象組織の外部公開面を、次の3つの境界で説明できる。
  - 資産境界：どこまでが対象（管理主体/環境）か
  - 信頼境界：どこから先が第三者（CDN/WAF/SaaS/委託先/外部連携）か
  - 権限境界：どこで権限が切り替わる/伝播するか（SSO/管理画面/共有/委任）
- “深掘り対象の優先度”を、技術的根拠（観測→意味）で作れる。
- 以降の検証（Web/NW）へ渡す成果物を最小セットで作れる。

## 前提（対象・範囲・想定）
- 対象：許可されたスコープ（ドメイン/サブドメイン/AS/IP/プロダクト等）に限る。
- 制約：パッシブのみ（問い合わせ・スキャン・ログイン試行等はしない）。
- 想定：クラウド/CDN/SaaS連携が前提の構成が多く、単一ドメインに閉じない。

## 入力（最初に揃えるもの：最小セット）
- スコープ情報：許可されたドメイン、除外ドメイン、対象サービス名（分かる範囲）
- 組織名/ブランド名：子会社/関連ブランドの有無（公開情報で確認できる範囲）
- 既知の入口：SSOポータル、管理画面、API基盤、VPN/VDI等（分かる範囲）

## 観測の進め方（順序固定：資産境界→依存→入口→優先度）
### 1) 資産境界を作る（管理主体の切り分け）
- 観測するもの（例）
  - 公式ドメイン/ブランドドメインの一覧（漏れがないか）
  - DNS委譲とゾーン境界（どこで管理が分かれているか）
  - AS/ネットブロックの手掛かり（自社/委託/クラウド寄りの推定）
- ここで確定したい状態
  - 「どれが本体で、どれが周辺か」を説明できる
  - “対象外に踏み込むリスク”を減らせる

### 2) 信頼境界（外部依存）を作る（第三者を特定する）
- 観測するもの（例）
  - CDN/WAF/ホスティング/クラウドの兆候（CNAME、証明書、応答ヘッダ等）
  - SaaS/IdP連携の兆候（ログイン導線、メタデータ、既知のIdPドメイン等）
  - 外部ストレージ/配信（オブジェクトストレージ、画像配信、JS配布）
- ここで確定したい状態
  - “攻めるべき対象”と“外部依存として注意すべき対象”を分けられる
  - 依存が強い箇所（SSO/CDN/SaaS）がどこか見える

### 3) 入口（攻撃面）を作る（Web/NWの深掘り対象を抽出）
- 観測するもの（例）
  - Web入口：ログイン、管理画面、API、ファイルアップロード、検索、決済等
  - 技術入口：JSから見えるAPI/外部連携、サブドメインの用途（app/admin/api等）
  - NW入口：VPN/VDI、リモート管理系の公開有無（公開情報で分かる範囲）
- ここで確定したい状態
  - “入口→境界→攻め筋”が一言で言える（例：SSO連携＋管理画面＋API）

### 4) 優先度を付ける（量ではなく意味で並べ替える）
- 優先度の軸（例：高→低）
  1) 権限境界が絡む入口（SSO/管理/委任/OAuth同意）
  2) 外部依存が強く、設定で崩れやすい入口（CDN/WAF/Storage/共有）
  3) APIが中心で権限伝播が複雑そうな入口（BOLA/BFLAの成立余地）
  4) 露出面が広いが価値が低いもの（広報/静的ページ等）
- ここで作る成果
  - “上位3〜5個の深掘り対象”と、その根拠（観測→意味）を短く添える

## 判断（A/B分岐：次の一手を決める）
### 分岐A：SSO/IdP連携が見える（認証境界が外にある）
- 次の一手
  - Web側AuthNの深掘りへ：`02_playbooks/03_authn_観測ポイント（SSO/MFA前提）.md`
  - 技術ユニット参照：`01_topics/04_saas/01_idp_連携（SAML OIDC OAuth）と信頼境界.md`

### 分岐B：CDN/WAF/クラウド依存が強い（外部依存境界が大きい）
- 次の一手
  - ASMの“露出面推定”を深掘り：`01_topics/01_asm-osint/05_cloud_露出面（CDN WAF Storage等）推定.md`
  - Web設定境界へ接続：`01_topics/02_web/06_config_設定・運用境界（CORS ヘッダ Secrets）.md`

### 分岐C：API比率が高い（入口はWebだが権限はAPIで決まる）
- 次の一手
  - Web/APIへ：`02_playbooks/05_api_権限伝播→検証観点チェック.md`
  - 技術ユニット参照：`01_topics/02_web/04_api_権限伝播・入力・バックエンド連携.md`

### 分岐D：NW入口が明確（VPN/VDI/管理公開等の兆候）
- 次の一手
  - NW導線へ：`02_playbooks/06_network_enum_to_post_列挙→侵入後の導線.md`
  - 技術ユニット参照：`01_topics/03_network/01_enum_到達性→サービス→認証→権限推定.md`

## 証跡（最小セット：再現性のため）
- 資産境界メモ（対象一覧の根拠：DNS/委譲/公開情報の要点）
- 信頼境界メモ（外部依存：CDN/SaaS/クラウドの推定根拠）
- 入口リスト（上位3〜5）：入口URL/役割/境界/優先度理由（1〜2行）
- 次工程の指示（どのplaybook/topicsへ進むか）

## ガイドライン対応（ASVS / WSTG / PTES / MITRE ATT&CK：毎回）
- ASVS：
  - 認証・認可・秘密情報・監査の要求を、どの入口/境界で満たす（または破れる）かを見立てる前段として位置づける
- WSTG：
  - テスト観点に入る前に、入口（対象）と境界（何が外部か）を確定して“外さない検証”に繋げる
- PTES：
  - Intelligence Gathering：パッシブ観測で資産/依存/入口を確定
  - Vulnerability Analysis：影響が大きい境界（権限/信頼）に優先度を寄せる
- MITRE ATT&CK：
  - 戦術：Discovery（外部公開面の把握）を、次段のCredential Access/Lateral Movement等へ繋ぐ前提作りとして扱う

## 関連リンク（リポジトリ内：必要最小限）
- 入口（ASM/OSINTの技術ユニット）
  - `01_topics/01_asm-osint/01_dns_委譲・境界・解釈.md`
  - `01_topics/01_asm-osint/02_tls_証明書・CT・外部依存推定.md`
  - `01_topics/01_asm-osint/03_http_観測（ヘッダ 挙動）と意味.md`
  - `01_topics/01_asm-osint/04_js_フロント由来の攻撃面抽出.md`
  - `01_topics/01_asm-osint/05_cloud_露出面（CDN WAF Storage等）推定.md`
- 次の導線（プレイブック）
  - `02_playbooks/02_web_recon_入口→境界→検証方針.md`
  - `02_playbooks/03_authn_観測ポイント（SSO/MFA前提）.md`
  - `02_playbooks/06_network_enum_to_post_列挙→侵入後の導線.md`

<<<END>>>
