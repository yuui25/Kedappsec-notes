<<<BEGIN>>>
# 05 STEP5-02 侵入起点別 攻撃チェーンシナリオ整理（実務 / TLPT 用）

## 1. このSTEPの目的と位置づけ

### 1-1. 目的

この STEP5-02 の目的は、

> **STEP5-01 で統合したエンドツーエンド攻撃チェーンを、  
> 実務で使える「侵入起点別シナリオ」に分解すること**

です。

TLPT / ペネトレーションテストでは、

- 「理論上は到達可能」では不十分
- **どこから始まり、どの判断で、どこまで行くか**

を **シナリオとして説明できること** が求められます。

---

## 2. シナリオ分解の設計思想

### 2-1. なぜ「侵入起点」で分けるのか

現実の攻撃・TLPTでは、

- すべての組織が
  - 同じ入口
  - 同じ弱点
を持つわけではありません。

そのため、

> **侵入起点（Initial Access）を複数用意し、  
>  それぞれが最終的に同じクラウンジュエルへ収束する**

構造で整理します。

---

## 3. シナリオA：フィッシング起点（最も現実的）

### 3-1. 侵入起点

- STEP1（Recon）
  - 社員メール形式 / 部署情報取得
- STEP2（Auth）
  - フィッシングにより
    - ID / PW
    - MFA 一時突破
    - セッショントークン
  を取得

### 3-2. 攻撃チェーン

1. VPN / SSO / OWA に社員としてログイン
2. 内部端末 / VDI セッション確保
3. AD / LDAP 列挙（STEP3-02）
4. Kerberos 攻撃設計（STEP3-03）
5. 資格情報窃取 → 権限拡大（STEP3-04）
6. Lateral Movement により
   - 管理者
   - サービスアカウント
   に到達
7. Azure AD Connect 侵害（STEP4-02）
8. Azure AD 管理ロール獲得（STEP4-03）
9. OAuth / API による SaaS 横展開（STEP4-04）

### 3-3. TLPT での評価ポイント

- フィッシング対策の成熟度
- MFA の実効性
- 初期侵入後の検知速度
- AD 内部横展開の抑止力

---

## 4. シナリオB：Web 脆弱性起点（WebPT 直結）

### 4-1. 侵入起点

- STEP1（Recon）
  - 内部向け / 管理向け Web アプリ発見
- WebPT により：
  - 認証回避
  - IDOR
  - RCE
  などを検出

### 4-2. 攻撃チェーン

1. Web サーバ上でコード実行 or 管理操作
2. Web サーバの
   - サービスアカウント
   - 設定ファイル
   - 接続文字列
   を取得
3. AD / Kerberos 連携アカウントを把握
4. SMB / WinRM で内部横展開
5. 資格情報窃取 → 管理権限取得
6. Azure AD Connect / Cloud へ波及
7. クラウンジュエル到達

### 4-3. TLPT / WebPT 観点

- Web 脆弱性が
  - 単体影響で終わらないこと
- 「Web → AD → Cloud」という
  - **横断リスク** を説明可能

---

## 5. シナリオC：VPN / リモートアクセス起点

### 5-1. 侵入起点

- STEP1（Recon）
  - VPN 製品 / バージョン特定
- STEP2（Auth）
  - 認証情報漏洩
  - VPN 設定不備
  - 条件付きアクセスの穴

### 5-2. 攻撃チェーン

1. VPN 経由で内部ネットワーク参加
2. 社員端末と同等のネットワーク可視性獲得
3. AD 列挙 / 内部スキャン
4. Kerberos / 資格情報攻撃
5. Lateral Movement
6. Cloud 侵害へ接続

### 5-3. 評価ポイント

- VPN 接続後の
  - ネットワーク分離
  - 内部検知
- ゼロトラスト設計の実効性

---

## 6. シナリオD：内部不正 / 侵害済み端末起点

### 6-1. 侵入起点

- 正規社員 or 既に侵害された端末
- 認証突破が不要なケース

### 6-2. 攻撃チェーン

1. 正規ユーザーとして AD 内部に存在
2. AD 権限・設定不備の悪用
3. Kerberos / Delegation 攻撃
4. 管理者権限獲得
5. Azure AD / SaaS 侵害

### 6-3. TLPT 的意味

- 「境界防御が無意味なケース」の評価
- 内部統制・最小権限設計の検証

---

## 7. シナリオE：クラウド設定不備起点

### 7-1. 侵入起点

- Azure AD / SaaS 側の設定不備
  - 過剰なアプリ権限
  - CA 例外
  - 管理ロール誤設定

### 7-2. 攻撃チェーン

1. クラウドユーザー / トークン侵害
2. Azure AD 内部横展開
3. SaaS 連携悪用
4. オンプレ環境への影響（逆流）

### 7-3. 観点

- Cloud 起点でも
  - オンプレに影響が及ぶ現実
- ハイブリッド設計の弱点

---

## 8. シナリオの使い分け指針（実務）

### 8-1. TLPT 設計時

- 1 本だけ選ぶのではなく：
  - **主シナリオ**
  - **代替シナリオ**
を用意

### 8-2. レポート記載時

- 実際に辿ったシナリオ
- 辿れた可能性のあるシナリオ
を明確に分けて記載

---

## 9. 次の STEP（5-03）への接続

次の **STEP5-03** では、

- これらの攻撃シナリオを
- **MITRE ATT&CK / PTES / OWASP**
とマッピングし、

> 経営・管理層にも通じる  
> **評価軸・説明軸**

へ変換します。

---

## 10. まとめ

- 攻撃チェーンは「1 本」だが
- 実務では「複数の入口」から始まる
- STEP5-02 で、
  - 現場でそのまま使える
  - 侵入起点別シナリオ
  を整理した
- 次は、これを **フレームワークと接続** する

<<<END>>>
