<<<BEGIN>>>
# 05 STEP5-10 Report 半自動組み立てルール（文章部品カタログ：Evidence/Timeline→Report）

## 1. このSTEPの目的（“Report を手で書かない”に近づける）

STEP5-09 で、

- Evidence Index（台帳）
- Timeline（時系列）
- 1行要約テンプレ

を固定し、記録が「文章に変換可能」な形になった。

本 STEP5-10 は、その次として、

> Evidence Index / Timeline から  
> Report 各章を “規則” と “文章部品” で組み立てる

ためのルールを提供する。

狙いは以下：

- Report の品質を一定にする（属人化排除）
- 推測と事実の混在を防ぐ
- Executive Summary が「雰囲気」にならない
- Hop（線）と Findings（点）が必ず接続される

---

## 2. Report 組み立ての全体フロー（固定）

### 2-1. 入力

- Evidence Index（必須）
- Timeline（必須）
- Findings（暫定で良い：`F-###` とタイトル、重大度、紐付く Hop）

### 2-2. 出力

- Report 本文（STEP5-05 の章立てに沿う）
- Evidence Pack（Index/raw/sanitized は既に存在）

### 2-3. 組み立て順（重要：逆順にしない）

1. Timeline を時刻順に確定（Hop の事実列を固める）
2. Hop ごとに “Fact” を確定（L1/L2/L3 を揃える）
3. Hop → Findings の紐付けを確定（どの点がどの線で効いたか）
4. Findings を重大度順に並べる（Executive の素材）
5. Executive Summary を “Fact 由来の文章部品” で作る

---

## 3. 文章部品カタログ（Snippets Catalog）

本節の Snippet は、Report 作成時に“そのまま貼れる”文章枠である。  
`{}` は Evidence Index / Timeline / Findings から埋める。

---

### 3-1. Executive Summary（結論）用 Snippet

#### ES-01：クラウンジュエル到達（結論）

- 到達（L2/L3 がある場合）
  - `本テストでは、{crown_jewel_asset} に対して {access_method} によるアクセス可能性を {claim_level} で示した（{evidence_ids}）。`
- 到達不可（L1 のみの場合）
  - `本テストでは、{crown_jewel_asset} に到達し得る経路を {claim_level} で観測したが、{reason_not_executed} のため実行は行わなかった（{evidence_ids}）。`

#### ES-02：永続化（Persistence）

- `認証・権限・アプリ設定の観点から、{persistence_vector} による持続的アクセスが {claim_level} で成立し得る（{evidence_ids}）。`

#### ES-03：防御の効き所（CA/MFA の評価）

- `Conditional Access / MFA は {where_effective} では有効であった一方、{where_not_effective} では制御が限定的であった（{evidence_ids}）。`

#### ES-04：上位リスクの要約（箇条書き 3〜5 件）

- `[ {severity} ] {finding_title}：{business_impact_1line}（根拠：{evidence_ids}）`

---

### 3-2. テスト概要（Scope/ROE）用 Snippet

#### SC-01：攻撃者モデル

- `攻撃者モデルは {attacker_model} とし、{constraints} を前提に評価した。`

#### SC-02：安全配慮（データ最小化）

- `本テストでは、業務影響を避けるため {data_minimization_policy} を採用し、機微情報の取得は {policy_detail} に限定した。`

---

### 3-3. 攻撃チェーン（Hop）用 Snippet

#### KC-01：Hop の 1行叙述（Timeline から生成）

- `Hop{n}：{narrative_1line}`

#### KC-02：Hop 詳細（短文ブロック）

- 目的：`{hop_goal}`
- 実施内容：`{timeline_narrative_1line}`
- 取得できた権限/情報：`{obtained_assets}`
- 影響：`{why_next_hop_possible}`
- Claim：`{claim_level}`
- Evidence：`{evidence_ids}`

#### KC-03：Hop 間の接続理由（“判断”の文章）

- `Hop{n} の結果、{decision_trigger} を根拠として {next_target} を次の対象に選定した（{evidence_ids}）。`

---

### 3-4. Findings（発見事項）用 Snippet

#### FD-01：Finding 概要（1段落）

- `{finding_id}（{severity}）：{finding_title}。本件は {chain_position} において成立し、{impact_scope} に影響を及ぼす（{evidence_ids}）。`

#### FD-02：Fact（根拠列挙：L1/L2/L3 を分離）

- `【Fact】{fact_bullets_from_summary_1line}`

#### FD-03：Interpretation（解釈：推測はここだけ）

- `【Interpretation】上記 Fact から、{interpretation_text} と判断する。`

#### FD-04：Impact（業務/統制への翻訳）

- `【Impact】{business_impact_text}`

#### FD-05：Recommendation（短期/中期/長期）

- `【Recommendation】短期：{short_term} / 中期：{mid_term} / 長期：{long_term}`

---

### 3-5. フレームワーク対応（Mapping）用 Snippet

#### MP-01：MITRE ATT&CK（戦術）

- `{attack_tactic}：{related_hops_or_findings}（根拠：{evidence_ids}）`

#### MP-02：PTES（フェーズ）

- `{ptes_phase}：{performed_actions_1line}（関連 Hop：{hops}）`

#### MP-03：OWASP（該当時）

- `WSTG：{wstg_item} / ASVS：{asvs_item}（関連 Finding：{finding_id}）`

---

### 3-6. Blue/DFIR（検知評価）用 Snippet

#### DF-01：検知できた/できなかった（同一フォーマット）

- `Hop{n}（{event_type}）は {blue_observation}。根拠ログ：{evidence_ids}。`

#### DF-02：改善提案（ログ相関）

- `相関ルールとして {correlation_rule_idea} を追加することで、{expected_detection_gain} が見込まれる。`

---

## 4. 自動組み立てルール（章ごとの“入力→出力”）

### 4-1. Executive Summary の生成ルール

#### 入力

- Findings（重大度順：Critical/High を優先）
- Timeline の終端（最終 Hop の L2/L3 Evidence）
- CA/MFA 関連 Evidence（Hop2/Hop7 など）

#### 出力（順序固定）

1. ES-01（到達の結論）
2. ES-02（永続化）
3. ES-03（防御の効き所）
4. ES-04（上位リスク 3〜5）

※禁止：Evidence の無い主張を Executive に書かない。

---

### 4-2. 攻撃チェーン章の生成ルール

#### 入力

- Timeline（時刻順）
- Hop 記録フォーム（goal / obtained / decision）

#### 出力

- KC-01 を時系列で列挙
- 各 Hop を KC-02 で補足
- Hop 間の判断は KC-03 を挿入

※原則：Hop の叙述は Timeline の `narrative_1line` から生成し、表現揺れを抑える。

---

### 4-3. Findings 章の生成ルール

#### 入力

- Findings（ID、重大度、タイトル、関連 Hop、Evidence ID 群）
- Evidence Index の `summary_1line`（Fact の材料）

#### 出力

1. FD-01（概要）
2. FD-02（Fact：L1/L2/L3 を分離して箇条書き）
3. FD-03（Interpretation：1〜2文）
4. FD-04（Impact）
5. FD-05（Recommendation）

※原則：Fact は Evidence Index の `summary_1line` をコピペで作る。書き換えない。

---

### 4-4. Blue/DFIR 章の生成ルール

#### 入力

- Timeline の `blue_observation`
- ログ系 Evidence（RDP/Sign-in/Audit 等）

#### 出力

- DF-01 を Hop ごとに並べる（検知/未検知を同一様式で）
- 改善は DF-02 を 3〜5 件に整理

---

## 5. 最小 “自動化” のための運用ルール（ここまでで実現できること）

本ファイル自体はツール実装を含まないが、運用としては以下が可能になる。

- Evidence Index の `summary_1line` を集約すれば Findings の Fact が作れる
- Timeline の `narrative_1line` を並べれば Hop 叙述が作れる
- Findings の重大度順で Executive の上位リスクが作れる

つまり、

> “文章を考える”のではなく  
> “データを並べて貼る”に近い運用

が成立する。

---

## 6. 次のSTEP（5-11）への接続

次の **STEP5-11** では、STEP5-10 の Snippet と生成ルールを前提に、

- 「この Evidence が揃っていれば、その章が自動で埋まる」という
  - **章別 必須 Evidence セット**
- Evidence 欠落時の
  - **代替根拠の取り方**
  - **“書けない”を明示する表現テンプレ**

を整備し、Report 作成の失敗（書けない/曖昧になる）を最小化する。

<<<END>>>
