<<<BEGIN>>>
# 05 STEP5-04 報告書構造と Evidence Pack 設計（TLPT / ペネトレ用）

## 1. このSTEPの目的と位置づけ

### 1-1. 目的

この STEP5-04 の目的は、

> **STEP1〜4 の成果（攻撃チェーン）を、  
> “報告書”として破綻なく伝え、  
> 再現・監査・改善につながる形で残すための構造を設計すること**

です。

ここでいう「報告書」は 2 層で考えます。

- **レポート本体（意思決定のための文書）**
- **Evidence Pack（技術裏付け・再現可能性の証拠束）**

TLPT / 実務では、両方が揃って初めて

- 技術的にも
- 統制的にも

「説明責任」を満たします。

---

## 2. レポートを 2 冊に分ける思想

### 2-1. なぜ分けるのか

- 管理層は：
  - 結論と優先順位が欲しい
- 技術者は：
  - 再現手順とログが欲しい

1 冊に詰め込むと、

- 読まれない
- 監査に耐えない
- 技術的な検証に使えない

という失敗が起きます。

---

## 3. 報告書本体（Report）テンプレ構造

### 3-1. 表紙・サマリ

- テスト目的（TLPT / ペネトレの区分）
- 対象範囲（スコープ）
- 前提条件（攻撃者モデル）
- 実施期間・体制
- 機密区分

---

### 3-2. Executive Summary（最重要）

- 結論（最終到達点）
  - クラウンジュエル到達可否
  - 永続化可否
- 重大リスク上位 3〜5 件
- 改善優先順位（短期 / 中期 / 長期）

ここは技術用語を抑え、

> 「何が起きたか」  
> 「なぜ危険か」  
> 「何を優先すべきか」

に集約します。

---

### 3-3. 攻撃チェーン（Kill Chain）章

STEP5-01 / 5-02 の成果をそのまま使います。

- 侵入起点（シナリオ）
- 主要ホップ（起点 → 中継 → コア → クラウンジュエル）
- 各ホップで得た権限・証拠

ポイント：

- “単発脆弱性”の羅列にしない
- **地続きのストーリーとして描く**

---

### 3-4. 発見事項（Findings）章

- 重大度（Critical/High/Medium/Low）
- 影響範囲（オンプレ / クラウド / SaaS）
- 再現性
- 悪用条件
- 推奨対策（技術 / 運用 / 統制）

発見事項は、できるだけ

- 攻撃チェーンの「どこで使われたか」
を紐付けて記述します。

---

### 3-5. フレームワーク対応（Mapping）章

STEP5-03 の成果を利用。

- MITRE ATT&CK（戦術・テクニック）
- PTES フェーズ
- OWASP（Web 起点の場合）

これにより、

- 監査・統制向け説明軸
が強化されます。

---

### 3-6. 検知・対応評価（Blue Team Assessment）章

STEP3-06 の成果を利用。

- どの段階で検知できたか
- どの段階が見えなかったか
- 事後調査で追えるか
- 改善すべきログ・相関

---

### 3-7. 改善ロードマップ（Remediation Roadmap）章

- すぐできる（0〜30日）
  - 設定変更・例外削除・権限見直し
- 中期（1〜3か月）
  - 設計変更・運用改善
- 長期（3〜12か月）
  - アーキテクチャ改善・ゼロトラスト強化

“技術”だけでなく

- 人
- 運用
- 統制

の観点も入れる。

---

## 4. Evidence Pack（証拠束）の設計

### 4-1. Evidence Pack の目的

Evidence Pack は、

- 「実際に起きた」ことの裏付け
- 「再現できる」ことの裏付け
- 「監査で説明できる」ことの裏付け

です。

レポート本文には載せないが、

> 監査・再検証・改善の現場で必須

となる。

---

### 4-2. Evidence Pack の構造（推奨）

#### A. 侵入起点ごとの証拠

- シナリオA（フィッシング起点）
- シナリオB（Web 起点）
など、実施したものだけ格納。

#### B. ホップごとの証拠

例：

- Hop1：VPN/SSO ログイン
- Hop2：VDI セッション確保
- Hop3：AD 列挙結果
- Hop4：Kerberoasting の要求ログ
- Hop5：Lateral Movement（RDP/WinRM/SMB）の痕跡
- Hop6：Azure AD 管理操作ログ
- Hop7：Graph API 操作結果

#### C. コマンドログ / 取得ログ

- 実行コマンド
- 実行時間
- 実行端末
- 結果（標準出力 / 取得ファイル）
- ハッシュ値（改ざん防止）

#### D. スクリーンショット / 画面証拠

- 重要な管理画面操作
- 設定変更の証拠
- ただし「見せすぎない」（機密管理）

---

### 4-3. 証拠の最低要件（実務）

- いつ（時刻）
- どこで（端末 / 対象）
- 誰として（アカウント）
- 何を（操作）
- 何が起きた（結果）

が揃っていること。

---

## 5. 攻撃チェーンと Findings を崩さない設計

### 5-1. よくある失敗

- Findings の羅列だけになり
  - 攻撃チェーンの価値が消える
- 攻撃チェーンだけ語って
  - 個別対策の優先順位が曖昧になる

### 5-2. 解決策（本プロジェクトの設計）

- 攻撃チェーン章で
  - “線” を示す
- Findings 章で
  - “点” を示す
- Evidence Pack で
  - “根拠” を示す

この 3 層で、破綻しない。

---

## 6. TLPT 特有の注意点（安全・統制）

### 6-1. どこまで実行するか

TLPT では、

- 侵害の証明
- 検知・対応評価

が目的であり、

- 実データの持ち出し
- 破壊的行為

は原則避ける。

→ レポートは

> 「到達可能性の証拠」  
> 「到達した場合の影響」

を分けて書く。

---

## 7. 次の STEP（5-05）への接続

次の **STEP5-05** では、

- 本 STEP5-04 の構造を前提に、
- **実際の章立て（見出し）を固定し、  
  そのまま埋められる“雛形”**

へ落とします。

つまり：

- 05_pentest-chain の中に
  - 実運用で使えるテンプレ（Report / Evidence Pack）
を生成する段階に進みます。

---

## 8. まとめ

- 報告書は「読む人」が異なるため、2層（Report / Evidence Pack）に分ける
- Report は意思決定、Evidence Pack は裏付けと再現性
- 攻撃チェーン（線）・Findings（点）・Evidence（根拠）の 3 層で破綻しない
- 次は、これをそのまま埋められるテンプレへ固定する

<<<END>>>
