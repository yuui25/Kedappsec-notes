# NIST SP 800-115

**エグゼクティブサマリー（Executive Summary）** …… ES-1

## 1. はじめに（Introduction） …… 1-1
- 1.1 権限／根拠（Authority） …… 1-1  
- 1.2 目的と範囲（Purpose and Scope） …… 1-1  
- 1.3 対象読者（Audience） …… 1-1  
- 1.4 文書構成（Document Structure） …… 1-2  

## 2. セキュリティテストおよび検査の概要（Security Testing and Examination Overview） …… 2-1
- 2.1 情報セキュリティ評価の方法論（Information Security Assessment Methodology） …… 2-1  
- 2.2 技術的評価手法（Technical Assessment Techniques） …… 2-2  
- 2.3 テストと検査の比較（Comparing Tests and Examinations） …… 2-3  
- 2.4 テストの観点（Testing Viewpoints） …… 2-4  
  - 2.4.1 外部と内部（External and Internal） …… 2-4  
  - 2.4.2 公開と秘匿（Overt and Covert） …… 2-5  

## 3. レビュー手法（Review Techniques） …… 3-1
- 3.1 文書レビュー（Documentation Review） …… 3-1  
- 3.2 ログレビュー（Log Review） …… 3-1  
- 3.3 ルールセットレビュー（Ruleset Review） …… 3-2  
- 3.4 システム構成レビュー（System Configuration Review） …… 3-3  
- 3.5 ネットワークスニッフィング／パケット取得（Network Sniffing） …… 3-4  
- 3.6 ファイル完全性検査（File Integrity Checking） …… 3-4  
- 3.7 まとめ（Summary） …… 3-5  

## 4. 対象の特定と分析手法（Target Identification and Analysis Techniques） …… 4-1
- 4.1 ネットワーク探索（Network Discovery） …… 4-1  
- 4.2 ポート／サービス特定（Network Port and Service Identification） …… 4-3  
- 4.3 脆弱性スキャン（Vulnerability Scanning） …… 4-4  
- 4.4 無線スキャン（Wireless Scanning） …… 4-6  
  - 4.4.1 受動的無線スキャン（Passive Wireless Scanning） …… 4-8  
  - 4.4.2 能動的無線スキャン（Active Wireless Scanning） …… 4-9  
  - 4.4.3 無線デバイスの位置追跡（Wireless Device Location Tracking） …… 4-9  
  - 4.4.4 Bluetooth スキャン（Bluetooth Scanning） …… 4-10  
- 4.5 まとめ（Summary） …… 4-10  

## 5. 対象脆弱性の検証手法（Target Vulnerability Validation Techniques） …… 5-1
- 5.1 パスワードクラック（Password Cracking） …… 5-1  
- 5.2 ペネトレーションテスト（Penetration Testing） …… 5-2  
  - 5.2.1 ペネトレーションテストのフェーズ（Penetration Testing Phases） …… 5-2  
  - 5.2.2 ペネトレーションテストの実施要領（Logistics） …… 5-5  
- 5.3 ソーシャルエンジニアリング（Social Engineering） …… 5-6  
- 5.4 まとめ（Summary） …… 5-7  

## 6. セキュリティ評価の計画（Security Assessment Planning） …… 6-1
- 6.1 セキュリティ評価ポリシーの策定（Developing a Security Assessment Policy） …… 6-1  
- 6.2 評価の優先度付けとスケジューリング（Prioritizing and Scheduling Assessments） …… 6-1  
- 6.3 手法の選定とカスタマイズ（Selecting and Customizing Techniques） …… 6-3  
- 6.4 実施要領／ロジスティクス（Assessment Logistics） …… 6-4  
  - 6.4.1 評価者の選定とスキル（Assessor Selection and Skills） …… 6-5  
  - 6.4.2 実施場所の選定（Location Selection） …… 6-6  
  - 6.4.3 技術ツールとリソースの選定（Technical Tools and Resources Selection） …… 6-8  
- 6.5 評価計画の作成（Assessment Plan Development） …… 6-10  
- 6.6 法的考慮事項（Legal Considerations） …… 6-12  
- 6.7 まとめ（Summary） …… 6-12  

## 7. セキュリティ評価の実施（Security Assessment Execution） …… 7-1
- 7.1 調整（Coordination） …… 7-1  
- 7.2 評価の遂行（Assessing） …… 7-2  
- 7.3 分析（Analysis） …… 7-3  
- 7.4 データ取扱い（Data Handling） …… 7-4  
  - 7.4.1 データ収集（Data Collection） …… 7-5  
  - 7.4.2 データ保存（Data Storage） …… 7-5  
  - 7.4.3 データ送信（Data Transmission） …… 7-6  
  - 7.4.4 データ破棄（Data Destruction） …… 7-7  

## 8. テスト後の活動（Post-Testing Activities） …… 8-1
- 8.1 緩和策の提言（Mitigation Recommendations） …… 8-1  
- 8.2 報告（Reporting） …… 8-1  
- 8.3 修復／緩和（Remediation/Mitigation） …… 8-2

  # 付録一覧（List of Appendices）
- 付録A — セキュリティテスト用 Live CD ディストリビューション …… A-1
- 付録B — 交戦規定（Rules of Engagement）テンプレート …… B-1
- 付録C — アプリケーションセキュリティのテストと検査 …… C-1
- 付録D — リモートアクセスのテスト …… D-1
- 付録E — リソース（Resources） …… E-1
- 付録F — 用語集（Glossary） …… F-1
- 付録G — 頭字語・略語（Acronyms and Abbreviations） …… G-1

# 表一覧（List of Tables）
- 表3-1 レビュー手法（Review Techniques） …… 3-5
- 表3-2 レビュー手法のベースラインスキルセット …… 3-5
- 表4-1 対象の特定と分析手法（Target Identification and Analysis Techniques） …… 4-10
- 表4-2 対象の特定と分析手法のベースラインスキルセット …… 4-11
- 表5-1 対象脆弱性の検証手法（Target Vulnerability Validation Techniques） …… 5-7
- 表5-2 セキュリティテストの知識・技能・能力（Knowledge, Skills, and Abilities） …… 5-7
- 表A-1 BackTrack ツールキット例 …… A-1
- 表A-2 Knoppix STD ツールキット例 …… A-2
- 表E-1 関連する NIST 文書 …… E-1
- 表E-2 オンラインリソース …… E-1

# 図一覧（List of Figures）
- 図5-1 4段階のペネトレーションテスト方法論（Four-Stage Penetration Testing Methodology） …… 5-3
- 図5-2 探索フェーズへループバックする攻撃フェーズの手順（Attack Phase Steps with Loopback to Discovery Phase） …… 5-4

# エグゼクティブサマリー（Executive Summary）

情報セキュリティ評価とは、評価対象（assessment object：ホスト、システム、ネットワーク、手順、人物など）が特定のセキュリティ目標をどの程度有効に満たしているかを判定するプロセスである。これを達成するためには、**試験（testing）**、**検査（examination）**、**インタビュー（interviewing）**という3種類の評価方法が用いられる。**試験**は、所定の条件下で1つ以上の評価対象を動作させ、実際の挙動と期待される挙動を比較するプロセスである。**検査**は、理解を促進し、明確化を達成し、または証拠を得るために、1つ以上の評価対象を確認・点検・レビュー・観察・調査・分析するプロセスである。**インタビュー**は、理解を促進し、明確化を達成し、または証拠の所在を特定するために、組織内の個人またはグループと議論を行うプロセスである。評価結果は、時間の経過にわたってセキュリティ管理策の有効性を判断することを支えるために用いられる。

本書は、情報セキュリティ評価の実施に関する基本的な技術面のためのガイドである。組織が評価の一部として用い得る技術的な試験および検査の方法・手法を提示し、それらの実行およびシステムやネットワークに与え得る影響に関する示唆を評価者に提供する。評価を成功させ、システム（ひいては組織全体）のセキュリティ姿勢に好影響を与えるには、試験と検査の実行を超える要素がこの技術的プロセスを支える必要がある。本書では、強固な計画プロセス、根本原因分析、状況に合わせた報告といった活動に関する提言も示す。

本書で提示するプロセスおよび技術的指針により、組織は次のことを実現できる。
- 情報セキュリティ評価の方針、方法論、および評価の技術的側面に関する個々の役割と責任を整備する。
- どのシステムを評価するか、評価アプローチ、ロジスティクス上の考慮事項、評価計画の策定、法令・ポリシー上の考慮事項への対応といった点に関する指針を提供することで、技術的セキュリティ評価を正確に計画する。
- 提示された方法と手法を用いて、評価中に発生し得るインシデントに対応しつつ、技術的セキュリティ評価を安全かつ効果的に実行する。
- 評価プロセス全体を通じて、技術データ（収集、保存、送信、破棄）を適切に取り扱う。
- 技術的所見を組織のセキュリティ姿勢を改善するためのリスク低減アクションへと翻訳する分析と報告を実施する。

本書に示す情報は、さまざまな評価目的での利用を意図している。例えば、特定のセキュリティ管理策（複数の場合もある）が要件を満たしていることの検証に焦点を当てる評価もあれば、システムに存在する悪用可能なセキュリティ上の弱点を特定・検証・評価することを目的とする評価もある。さらに、組織が積極的なコンピュータネットワーク防御を維持する能力を高めるために評価が実施されることもある。評価は、セキュリティ管理策の実装やシステムセキュリティの維持の代替として行われるものではない。

技術的セキュリティ評価を遂行し、技術的なセキュリティの試験と検査が最大の価値を発揮するようにするために、NIST は組織に対して次のことを推奨する。
- **情報セキュリティ評価方針を確立すること。** これは、評価を実施するための組織の要件を明確にし、これらの要件に従って評価が実施されるよう適切な個人に説明責任を持たせるものである。評価方針が扱うべき主題には、評価が順守すべき組織要件、役割と責任、確立された評価方法論の遵守、評価頻度、文書化要件が含まれる。
- **反復可能で文書化された評価方法論を実装すること。** これは、評価に一貫性と構造を与え、新たな評価要員の移行を迅速化し、評価に伴うリソース制約へ対処する。かかる方法論を用いることで、組織は評価の価値を最大化しつつ、特定の技術的評価手法がもたらし得るリスクを最小化できる。これらのリスクは、システム機能への影響を懸念するあまり組織のセキュリティ姿勢に関する十分な情報を収集できないことから、適切な安全策がないまま手法を実行してシステムまたはネットワークの可用性に影響を及ぼすことまで幅がある。特定の評価手法に起因するリスクを最小化するプロセスの例としては、熟練した評価者の起用、包括的な評価計画の作成、評価者活動の記録、時間外での試験実施、本番システムの複製（例：開発システム）での試験が挙げられる。組織は各評価について許容するリスク水準を定め、それに応じてアプローチを調整する必要がある。
- **各セキュリティ評価の目的を特定し、それに応じてアプローチを調整すること。** セキュリティ評価には固有の目的、許容可能なリスク水準、利用可能な資源がある。単独の手法のみを実行しても組織のセキュリティの包括的な把握は得られないため、技術の組み合わせを用いるべきである。これはリスクと資源使用の抑制にも資する。
- **所見を分析し、弱点に対処するリスク低減手法を策定すること。** セキュリティ評価が最終的な価値を提供することを確実にするため、評価完了後に根本原因分析を実施し、所見を実行可能な緩和策へと翻訳できるようにする。結果として、技術的弱点だけでなく、組織のプロセスや手順上の弱点にも対処すべきであることが示される場合がある。

# 1. はじめに（Introduction）

## 1.1 権限（Authority）
米国国立標準技術研究所（NIST）は、本書を2002年の**連邦情報セキュリティ管理法（FISMA）**（Public Law 107-347）に基づく法定責務の履行として作成した。  
NISTは、すべての政府機関の業務および資産に対し、十分な情報セキュリティを提供するための**標準およびガイドライン（最低要求事項を含む）**を策定する責務を負う。ただし、これらの標準およびガイドラインは**国家安全保障システム**には適用されない。本ガイドラインは、**行政管理予算局（OMB）通達 A-130** の要件、とりわけ **第8b(3)節「機関の情報システムの保護（Securing Agency Information Systems）」** と、その分析である **A-130 付録IV「主要区分の分析」** に整合している。補足情報は **A-130 付録III** に示されている。  

本ガイドラインは**連邦政府機関**での利用を目的として作成された。**非政府組織**も**任意**で利用でき、**著作権の対象ではない**（ただし**出典の明記が望ましい**）。  

本書のいかなる内容も、商務長官の法定権限に基づき**連邦政府機関に対して義務化・拘束力を持つ標準やガイドライン**と矛盾するものとして解釈されるべきではない。また、本ガイドラインが**商務長官**、**OMB長官**、その他の**連邦政府高官**の既存の権限を変更または優先するものとして解釈されるべきではない。

## 1.2 目的と範囲（Purpose and Scope）
本書の目的は、組織が**技術的な情報セキュリティの試験および評価**を**計画・実施**し、**所見を分析**して**緩和戦略を策定**する際のガイドラインを提供することである。具体的には、セキュリティの**試験・評価のプロセス／手順に関する技術的情報**を**設計・実装・維持**するための実践的な推奨事項を示し、これを**複数の目的**（例：システムやネットワークの**脆弱性の発見**、**方針やその他要件への適合性の検証**）に活用できるようにする。  

本ガイドは、**包括的な情報セキュリティの試験または評価プログラム**を提示することを意図したものではない。むしろ、**技術的セキュリティ試験・評価の主要要素**の概観を示し、**特定の手法**、それらの**利点と限界**、および**活用に関する推奨**に重点を置く。  

本書は **NIST 特別刊行物 800-42『ネットワークセキュリティテストのガイドライン』** を**置き換える**ものである。

## 1.3 対象読者（Audience）
本ガイドは、**コンピュータセキュリティ担当者**や**プログラムマネージャ**、**システム／ネットワーク管理者**、その他、システムおよびネットワーク基盤の**準備・運用・セキュリティ確保**における**技術的側面に責任を負う技術スタッフ**による利用を意図している。**管理者**も、ここで提示する情報を**セキュリティの試験・評価に関連する技術的意思決定**を促進するために利用できる。本書の内容は**技術志向**であり、読者が**システムおよびネットワークセキュリティに関する基礎的理解**を有していることを前提とする。

## 1.4 文書構成（Document Structure）
本書の残りの部分は、次の**7つの主要セクション**で構成される。

- **第2章**：情報セキュリティ評価の概観（方針、役割と責任、方法論、手法 を含む）  
- **第3章**：複数の**技術的検査手法**の詳細（文書レビュー、ログレビュー、ネットワークスニッフィング、ファイル完全性検査 など）  
- **第4章**：**対象の特定と分析**のための各種手法（例：ネットワーク探索、脆弱性スキャン）  
- **第5章**：脆弱性の**存在を検証**するために一般的に用いられる手法（例：パスワードクラック、ペネトレーションテスト）  
- **第6章**：**セキュリティ評価の計画**に関するアプローチとプロセス  
- **第7章**：**セキュリティ評価の実施**に不可欠な要素（調整、評価そのもの、分析、データ取扱い）  
- **第8章**：**評価所見の報告**に関するアプローチと、**是正（リメディエーション）活動**の概観  

さらに、本ガイドには以下の**付録**が含まれる。

- **付録A**：OSをCDから起動し、完全なOSとテストツールを提供する**2つのLive OSディストリビューション**の説明  
- **付録B**：**交戦規定（Rules of Engagement; ROE）**のテンプレート  
- **付録C**：**アプリケーションセキュリティ評価**の簡単な解説  
- **付録D**：**リモートアクセスのテスト**に関する推奨事項  
- **付録E**：セキュリティ評価プロセスを支援し得る**リソース一覧**  
- **付録F**：本書全体で用いられる**用語集（Glossary）**  
- **付録G**：**頭字語・略語一覧（Acronyms and Abbreviations）**

## 2. セキュリティテストおよび精査の概要

情報セキュリティアセスメントとは、評価対象（例：ホスト、システム、ネットワーク、手順、人。以下「アセスメントオブジェクト」）が、特定のセキュリティ目的をどの程度満たしているかを判定するプロセスである。これを達成するために用いられる評価手法は、テスト（testing）、精査（examination）、インタビュー（interviewing）の3種類がある。  
テストは、所定の条件下で1つ以上のアセスメントオブジェクトを実行し、実際の挙動と期待される挙動を比較するプロセスである。精査は、1つ以上のアセスメントオブジェクトを確認・検査・閲覧・観察・研究・分析して、理解の促進、疑問点の解消、証拠の取得を図るプロセスである。インタビューは、組織内の個人またはグループと議論を行い、理解の促進、疑問点の解消、証拠の所在の特定を図るプロセスである。アセスメント結果は、時間経過に伴うセキュリティコントロールの有効性判断を支援するために用いられる。

本書は、技術的な脆弱性の識別・妥当化・評価に用いることができ、組織が自らのシステムやネットワークのセキュリティ態勢の理解と改善に資する、技術的テストおよび精査の手法を扱う。セキュリティテストと精査は FISMA¹ などの規制により要求される。これはセキュリティコントロールの実装やシステムセキュリティの維持に取って代わるものではなく、システムが適切に保護されていることを確認し、満たされていない組織のセキュリティ要件や対処すべきその他の弱点を特定することを目的とする。

本章では、情報セキュリティアセスメントの方法論と、技術的テストおよび精査の手法の概要を示す。

### 2.1 情報セキュリティアセスメントの方法論

反復可能で文書化されたセキュリティアセスメント方法論には、次の利点がある。
- セキュリティテストに一貫性と構造を与え、テストに伴うリスクを最小化できる
- 新任のアセスメント要員の立ち上げを迅速化できる
- セキュリティアセスメントに伴うリソース制約に対処できる

情報セキュリティアセスメントには、時間・要員・ハードウェア・ソフトウェアといったリソースが必要であり、利用可能なリソースは実施するアセスメントの種類や頻度にしばしば制約を与える。組織が実施するテストや精査の種類を評価し、適切な方法論を策定し、必要なリソースを特定し、想定要件を満たすようにアセスメントプロセスを構成することで、このリソース面の課題を緩和できる。これにより、訓練された要員や標準化されたテストプラットフォームといった事前に整備したリソースを再利用でき、アセスメントの実施時間とテスト機材・ソフトウェア調達の必要性を低減し、総コストを削減できる。

段階的（フェーズド）な情報セキュリティアセスメント方法論には多くの利点がある。この構造は理解しやすく、要員の交代に自然な区切りを提供する。最低限、次のフェーズを含むべきである。

- **計画（Planning）**：セキュリティアセスメントの成功に不可欠なフェーズであり、評価対象資産、当該資産に対する関心のある脅威、それらの脅威を軽減するために用いるセキュリティコントロールなど、実行に必要な情報を収集し、アセスメント方針を策定する。セキュリティアセスメントは他のプロジェクトと同様に扱い、目的・目標、範囲、要件、チームの役割と責任、制約、成功要因、前提、リソース、タイムライン、成果物を扱うプロジェクトマネジメント計画を用意する。本ガイドの第6章で計画を扱う。
- **実行（Execution）**：このフェーズの主目的は、脆弱性を識別し、必要に応じて妥当化（検証）することである。本フェーズは、想定するアセスメント手法・技術に関連する活動を扱う。具体的活動はアセスメントの種類によって異なるが、完了時には、システム・ネットワーク・組織プロセスにおける脆弱性が特定されている。本フェーズの詳細は第7章で扱う。
- **事後（Post-Execution）**：識別した脆弱性を分析して根本原因を明らかにし、緩和策を定め、最終報告書を作成することに焦点を当てる。本ガイドの第8章で報告と緩和を扱う。

種々の情報セキュリティアセスメントの実施方法論が広く受け入れられている。これらの方法論への参照は付録E² に示す。たとえば、NIST は NIST SP 800-53 に記載のセキュリティコントロールの有効性評価に関する提案を示す **NIST SP 800-53A**（Guide for Assessing the Security Controls in Federal Information Systems）という方法論を策定している³。広く用いられている他の方法論に **OSSTMM**（Open Source Security Testing Methodology Manual）⁴ がある。アセスメントを実施する理由は多岐にわたるため、組織は複数の方法論を併用してもよい。本書は、多くの方法論や目的で活用できる技術的テストおよび精査の推奨手法を提供する。

### 2.2 技術的アセスメント手法

システムおよびネットワークのセキュリティ態勢を評価するために使用できる技術的なセキュリティテストおよび精査手法は多数存在する。本書の観点から一般的な手法は後述し、次の3分類にまとめる。

- **レビュー手法（Review Techniques）**：システム、アプリケーション、ネットワーク、方針、手順を評価して脆弱性を発見する精査手法で、一般に手作業で実施する。文書レビュー、ログレビュー、ルールセットレビュー、システム設定レビュー、ネットワークスニッフィング、ファイル整合性チェック等を含む。第3章で詳述する。
- **ターゲット識別・分析手法（Target Identification and Analysis Techniques）**：システム、ポート、サービス、潜在的な脆弱性を特定するテスト手法で、手作業でも実施可能だが通常は自動化ツールを用いる。ネットワーク探索、ネットワークポート/サービス識別、脆弱性スキャン、無線スキャン、アプリケーションセキュリティ精査等を含む。第4章で詳述する。
- **ターゲット脆弱性の妥当化手法（Target Vulnerability Validation Techniques）**：脆弱性の存在を裏付けるテスト手法で、具体的手法やチームの技能により手作業または自動ツールで実施する。パスワードクラッキング、ペネトレーションテスト、ソーシャルエンジニアリング、アプリケーションセキュリティテスト等を含む。第5章で詳述する。

単一の手法だけでシステムやネットワークのセキュリティ全体像を提供することはできないため、組織は適切な手法を組み合わせて堅牢なアセスメントを実施すべきである。たとえば、ペネトレーションテストは、将来の侵入対象となり得るホストやサービスを特定するために、ネットワークのポート/サービス識別と脆弱性スキャンの双方に依存することが多い。また、同一要件（例：パッチが適用済みか）を満たすための技術的手段は複数存在し得る。本書は、こうした各技術手法の実施方法を説明することに焦点を当て、状況ごとに用いるべき手法を規定しない――すなわち、組織が自らの要件に最適な手法を柔軟に選択できるようにする。

本書で扱う技術的手法に加えて、技術的手法の代わりに、あるいは併用可能な多数の**非技術的手法**が存在する。例として物理セキュリティテストがあり、鍵、バッジリーダー、その他の物理セキュリティコントロールを迂回して特定ホストへの不正アクセスを試みることで、物理的脆弱性の存在を確認する。資産の手動識別も非技術的手法の一例であり、資産台帳、施設の実地巡回などを通じて評価対象資産を特定する（技術的手法に頼らない）やり方である。非技術的手法の詳細は本書の範囲外だが、それらの価値を認識し、技術的手法より適切な場面を検討することは重要である。

### 2.3 テストと精査の比較

**精査（Examinations）**は、方針、手順、セキュリティ計画、セキュリティ要件、標準運用手順、アーキテクチャ図、エンジニアリング文書、資産台帳、システム設定、ルールセット、システムログなどの文書レビューが中心である。精査は、システムが適切に文書化されているか、また文書からしか得られないセキュリティの側面に関する洞察を得るために実施される。これらの文書は、システムやネットワークの設計、導入、設定、運用、保守の意図を示し、そのレビューと相互参照により整合性や適合性を確認する。例えば、環境のセキュリティ要件はシステムセキュリティ計画や標準運用手順といった文書の拠り所であるべきであり、評価者はすべての計画、手順、アーキテクチャ、設定が、定義されたセキュリティ要件および適用される方針に準拠していることを確認する。別の例では、ファイアウォールのルールセットが、インターネット利用に関する組織のセキュリティ方針（インスタントメッセージング、P2Pファイル共有、その他の禁止行為の扱いなど）に準拠するかをレビューする。

精査は、対象環境の実システムやネットワークに対して、必要な文書・ログ・ルールセットへのアクセスを除き、通常は影響を与えない⁵。ただし、ルータやファイアウォールなどからシステム設定ファイルやログを取得する場合は、設定が誤って変更・削除されないよう、システム管理者や同等の訓練を受けた者のみが作業すべきである。

**テスト（Testing）**は、システムやネットワークに対して直接作業してセキュリティ脆弱性を識別するもので、全社的にも、選定したシステムに対しても実行できる。スキャンや侵入手法の使用は、潜在的な脆弱性に関する有用な情報を提供し、攻撃者や侵入者がそれらを悪用できる可能性の予測に役立つ。テストはまた、パッチ管理、パスワード方針、構成管理などの領域での遵守状況の測定を可能にする。

テストは精査に比べて、組織のセキュリティ態勢のより正確な像を与えうるが、より侵襲的であり、対象環境のシステムやネットワークに影響を与え得る。潜在的影響の程度は用いるテスト手法に依存し、オープン/クローズドポートの判定に通常のネットワークパケットを送る場合もあれば、脆弱性を試験するために特殊に作成したパケットを送る場合もある。システムやネットワークと直接相互作用するテストやテスターが関与する際には、予期せぬシステム停止などのDoSが発生する可能性が常に存在する。組織は、どの手法を用いるかを決める際に、受容可能な侵襲性のレベルを定めるべきである。既知のDoSやその他の障害を引き起こすテストを除外することで、負の影響を低減できる。

テストは、組織のセキュリティ態勢を包括的に評価するものではなく、特に時間といったリソース制約のため、しばしばスコープが狭い。一方、悪意ある攻撃者は、システムやネットワークを侵害するために必要なだけの時間をかけることができる。加えて、組織はシステムやネットワークに影響を与えるテスト手法の使用を避ける傾向があるが、攻撃者にはその制約はなく、必要と思えばどの手法でも用いる。結果として、テストは、方針や設定に関連する弱点の特定において、精査ほど有効ではない場合が多い。多くのケースで、テストと精査を組み合わせることが、より正確なセキュリティ像の把握につながる。

### 2.4 テストの視点

テストは、外部攻撃者や悪意ある内部者がどの程度容易にシステムを攻撃可能か、といった様々な視点から実施できる。本ガイド第2.4.1節では、外部と内部の視点から行うテストを比較し、第2.4.2節では、評価者が対象または対象環境について事前に持つ知識という別の観点を論じる。

#### 2.4.1 外部と内部

**外部セキュリティテスト**は、組織のセキュリティ境界外から実施する。これは、インターネットから見える外部視点で環境のセキュリティ態勢を把握し、外部攻撃者に悪用され得る脆弱性を明らかにすることを目的とする。  
外部テストはしばしば偵察から始まり、公開登録データ、DNSサーバ情報、ニュースグループ投稿、その他公開情報を調査して、脆弱性特定に役立つ情報（システム名、IPアドレス、OS、技術的連絡先など）を収集する。次に列挙を行い、ネットワーク探索やスキャン手法で外部ホストと待受サービスを特定する。周辺防御（ファイアウォール、ルータ、ACLなど）は内部ネットワークへ許容するトラフィックの種類を制限するため、評価者は外部攻撃者と同様に、これらを回避する手法を用いることが多い。許可されるプロトコルに依存するが、初期攻撃は一般に FTP、HTTP、SMTP、POP といったよく使われ許可されやすいアプリケーションプロトコルに焦点を当てる。外部から到達可能なサーバは、内部サーバや機密情報へのアクセスを許しかねない脆弱性について検査される。外部テストはまた、無線AP、モデム、内部サーバへのポータルなど、アクセス経路の脆弱性の発見にも注力する。

**内部セキュリティテスト**では、評価者は内部ネットワークから作業し、信頼された内部者、または周辺防御をすり抜けた攻撃者の立場を仮定する。これにより、悪用され得る脆弱性を明らかにし、この種の攻撃者が与えうる潜在的損害を示すことができる。内部テストは、アプリケーションやサービスの設定、認証、アクセス制御、システムの堅牢化など、システムレベルのセキュリティと構成にも焦点を当てる。  
内部テストの評価者にはしばしば、一般ユーザとしてのレベルなど、何らかのネットワークアクセス権が付与され、同等の権限を持つユーザが得られる情報が提供される。この一時的アクセス権のレベルはテストの目的に依存し、システム/ネットワーク管理者の権限に至るまで設定され得る。付与された権限レベルから出発し、評価者は権限昇格（一般ユーザ権限を管理者権限へ、システム管理者権限をドメイン管理者権限へ引き上げる）を通じて、ネットワークやシステムへのさらなるアクセス獲得を試みる。

内部テストは周辺防御の内側で行われるため、外部テストほどの制約は受けないが、内部ファイアウォール、ルータ、スイッチが制限となる場合もある。テスト手法に加えて、ネットワークスニッフィング等の精査手法を用いる場合もある。  
外部と内部の両方を実施する場合、通常は外部テストを先に行う。同一の評価者が両方を実施する場合、内部アーキテクチャや設定に関する内部者情報を先に得てしまうこと（攻撃者が得られない利点）を避け、テストの妥当性を損なわないために有益である。

#### 2.4.2 公知と秘匿（オーバートとコーバート）

**オーバート（Overt）セキュリティテスト**はホワイトハットテストとも呼ばれ、組織のITスタッフの知悉と同意のもとに外部および/または内部テストを実施し、ネットワークやシステムのセキュリティ態勢を包括的に評価できる。ITスタッフがテストを十分に把握し関与するため、影響を限定する指針を提供できる場合がある。スタッフが評価者の活動や手法を観察でき、実装・維持しているセキュリティ要件の文脈理解や、テストの実施方法に関する教育機会にもなり得る。

**コーバート（Covert）セキュリティテスト**はブラックハットテストとも呼ばれ、組織のITスタッフには知らせず、上層部の十分な知悉と許可のもとでテストを実施する。多くの組織は信頼できる第三者を指名し、検知された活動がテスト由来でないかを事前確認せずに、対象組織が対応措置を開始しないよう担保する。こうした状況では、第三者は評価者、経営陣、ITスタッフ、セキュリティスタッフの仲介役として活動し、行動を調整しコミュニケーションを円滑化する。この種のテストは、技術的セキュリティコントロール、ITスタッフのインシデント対応、セキュリティ方針の理解と実装を検証するのに有用である。事前告知の有無を問わず実施され得る。

コーバートテストの目的は、敵対者が引き起こし得る損害や影響を検証することであり、脆弱性の網羅的特定に重点を置かない。この種のテストは、あらゆるセキュリティコントロールをテストしたり、すべての脆弱性を識別したり、組織内の全システムを評価したりするものではない。コーバートテストは敵対者の視点から組織を評価し、ネットワークアクセスの獲得に至る最も初歩的な脆弱性の特定・悪用に留まるのが通常である。特定の敵対者像を模倣することが目標であれば、脅威データの収集とモデリングなど、特別な考慮が必要となる。その結果得られるシナリオは、侵害の潜在的手段、リスク、影響に関する全体的・戦略的な見取り図を提供する。  
コーバートテストにはしばしば明確な境界（到達したアクセスレベルや、次段階で実現可能な損害の種類など）が設定される。これは損害を防ぎつつ、損害の可能性を示すためである。

多くの脆弱性を特定できないことに加え、コーバートテストは秘匿要件のため、時間とコストがかかることが多い。秘匿環境での運用には、対象組織のセキュリティスタッフに検知されないよう、スキャンやその他の行動を遅らせる必要がある。社内でテストを行う場合は、時間と予算の観点から訓練も考慮すべきである。さらに、組織のスタッフはスキャンや脆弱性アセスメントのような定常活動には習熟していても、ペネトレーションやアプリケーションセキュリティテストのような専門的手法には習熟していない場合がある。オーバートテストはコストが低くリスクも小さいため、より一般的に用いられるが、コーバートテストは管理者の警戒が高まらないため、対象組織の日常的なセキュリティの実態をより適切に示すことができる。

---

¹ セクション3544は「リスクに応じた頻度で、少なくとも年1回、情報セキュリティの方針・手順・実務の有効性に関する定期的なテストと評価」を要求している。FISMAは http://csrc.nist.gov/drivers/documents/FISMA-final.pdf にある。  
² NISTはいずれかの方法論を推奨するものではない。組織が既存の方法論を採用するか、複数を組み合わせて独自の方法論を策定するか、選択可能とするための選択肢を提供することが意図である。  
³ NIST SP 800-53A は、アセスメント手順の策定フレームワーク、セキュリティコントロールの評価プロセス、各コントロールのアセスメント手順を扱う。同書は NIST SP 800-37（Guide for the Security Certification and Accreditation of Federal Information Systems）と併せて用いることを想定している。NIST SP 800-53、800-53A、800-37 は http://csrc.nist.gov/publications/PubsSPs.html にある。  
⁴ OSSTMM の詳細は http://www.isecom.org/osstmm/ を参照。

（2-1 / TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT）

⁵ 受動的テスト手法の1つであるネットワークスニッフィングは、ハブ、タップ、スパンポートにスニファを接続する必要があり、機器の再設定を伴う場合には運用に影響を及ぼし得る。

## 3. レビュー手法（Review Techniques）

レビュー手法は、システム、アプリケーション、ネットワーク、方針（policies）、手順（procedures）を**受動的**に精査してセキュリティ上の脆弱性を発見する。⁶ また、他のアセスメント手法を円滑かつ最適に実施するための情報収集にも用いられる。受動的であるため、レビュー手法がシステムやネットワークに与えるリスクは最小限である。本章では、文書レビュー、ログレビュー、ルールセットレビュー、システム設定レビュー、ネットワークスニッフィング、ファイル整合性チェックといった一般的なレビュー手法を扱う。

### 3.1 文書レビュー（Documentation Review）

文書レビューは、方針・手順の技術的側面が現状に合致し包括的であるかを判定する。これらの文書は組織のセキュリティ態勢の基盤だが、技術的アセスメントでは見落とされがちである。組織内のセキュリティ部門は、包括的なレビューを保証するために適切な文書を評価者へ提供すべきである。技術的な正確性と完全性の観点からレビューすべき文書には、セキュリティ方針、アーキテクチャ、要件、標準運用手順（SOP）、システムセキュリティ計画（SSP）と認可合意、システム間接続に関する了解覚書（MOU/IAA）、インシデント対応計画などが含まれる。

文書レビューは、セキュリティコントロールの欠落や不適切実装につながりうるギャップや弱点を発見できる。評価者は通常、組織の文書が FISMA などの基準・規制に準拠しているかを検証し、不十分または古い方針がないかを確認する。一般的な弱点としては、もはや使用されていない OS の手順・プロトコルが残っている、あるいは新しい OS とそのプロトコルが反映されていない、といったことが挙げられる。文書レビューは、セキュリティコントロールが適切に実装されていること**自体**を保証するものではなく、セキュリティ基盤を支える「指針や方針」が存在することを確認するものである。

文書レビューの結果は、他のテストや精査手法の微調整に活用できる。例えば、パスワード管理方針に最小長や複雑性の要件があるなら、その情報でパスワードクラッキングツールの設定を絞り込み、効率を高められる。

### 3.2 ログレビュー（Log Review）

ログレビューは、セキュリティコントロールが適切な情報をログしているか、組織がログ管理方針に準拠しているかを判定する。⁷ 監査ログは過去情報の源泉であり、システムが確立された方針どおりに動作しているかの検証に役立つ。たとえば、「重要サーバへの全ての認証試行を記録する」という方針があるなら、ログレビューでは当該情報が収集され、適切な詳細度で記録されているかを確認する。ログレビューはまた、誤設定されたサービスやセキュリティコントロール、不正アクセス、侵入試行などの問題を明らかにすることもある。たとえば、ファイアウォールの内側に配置された IDS センサーのログは、ファイアウォールが内部に許可した通信を検証するのに用いられる。センサーが本来ブロックすべき活動を記録している場合、ファイアウォールの設定が安全でないことを示す。

技術的アセスメントで有用となるログの例：
- **認証サーバ／システムのログ**：認証の成功・失敗
- **システムログ**：システム／サービスの起動・停止、未承認ソフトのインストール、ファイルアクセス、セキュリティ方針変更、アカウント変更（作成・削除、権限付与）、特権利用
- **IDS/IPS ログ**：悪意ある活動、不適切利用
- **ファイアウォール／ルータログ**：内部デバイスの侵害を示す外向き接続（例：rootkit、ボット、トロイ、スパイウェア）
- **ファイアウォールログ**：未承認の接続試行、不適切利用
- **アプリケーションログ**：未承認の接続試行、アカウント変更、特権使用、アプリ／DB の利用情報
- **アンチウイルスログ**：更新失敗、古いシグネチャ／ソフトの兆候
- **セキュリティログ**（特にパッチ管理や一部の IDS/IPS 製品）：既知の脆弱なサービス／アプリに関する情報の記録

手作業でのログレビューは非常に時間を要し煩雑になりがちである。レビュー時間を大幅に短縮し、ログ内容を要約して特定活動にひもづけた定型・カスタムレポートを生成できる自動監査ツールが利用可能である。評価者は、異なる形式のログを単一の標準形式に正規化するなど、これらの自動ツールでログ分析を容易にできる。さらに、組織内の失敗ログオン回数の把握など特定の行為をレビューする場合、当該行為でログをフィルタリングできる。

### 3.3 ルールセットレビュー（Ruleset Review）

ルールセットとは、ネットワークトラフィックやシステム活動を照合して取るべき動作（例：パケットの転送／拒否、アラート生成、システムイベントの許可）を決める規則やシグネチャの集合である。レビューは、包括性を担保し、ネットワーク上の脆弱性、方針違反、意図せぬ／脆弱な通信経路など、階層化された防御全体におけるギャップや弱点を特定するために行う。また、ルールセットの性能に悪影響を与える非効率も洗い出せる。

レビュー対象のルールセットには、ネットワーク／ホスト型ファイアウォール、IDS/IPS のルールセット、ルータの ACL が含まれる。一般的なチェック例は以下のとおり。

- **ルータの ACL**
  - 各ルールは依然として必要か（例：一時的目的で追加したルールは不要になり次第削除されているか）
  - 方針で許可されたトラフィックのみを許容し、他はデフォルト拒否となっているか
- **ファイアウォールのルールセット**
  - 各ルールは依然として必要か
  - 必要な IP アドレスとポートに限定するなど、最小権限を強制しているか
  - より特化したルールが一般的なルールより先に適用されるか
  - 閉じうる不要なオープンポートが残っていないか（境界の強化）
  - 他のセキュリティ防御を迂回させるような許可がないか
  - **ホスト型ファイアウォール**では、バックドア、スパイウェア活動、P2P など禁止アプリの存在を示すルールがないか
- **IDS/IPS のルールセット**
  - 不要なシグネチャを無効化・削除し、誤検知を減らして性能を改善しているか
  - 必要なシグネチャが有効で、適切にチューニング・保守されているか

### 3.4 システム設定レビュー（System Configuration Review）

システム設定レビューは、ハードニング不足や方針不適合など、セキュリティ設定コントロールの弱点を特定するプロセスである。例えば、不要なサービスやアプリ、誤ったアカウント／パスワード設定、不適切なログ／バックアップ設定などを明らかにする。レビュー対象の例として、Windows のセキュリティポリシー設定、Unix の /etc 配下にある各種セキュリティ設定ファイルなどがある。

手作業レビューでは、セキュリティ設定ガイドやチェックリストを用いて、設定がリスク最小化に寄与する構成になっているかを検証する。⁸ 手作業レビューでは、対象デバイスの各種セキュリティ設定にアクセスし、推奨設定と照合する。最小基準を満たさない設定はフラグ付けして報告する。

**SCAP（Security Content Automation Protocol）**は、特定の標準を用いて脆弱性管理、評価、方針遵守の判定を自動化するための方法である。⁹ NIST の SCAP ファイルは FISMA 準拠および NIST SP 800-53A によるセキュリティコントロール評価向けに作成されている。その他のツールも、セキュリティ設定の収集・報告や是正ガイダンスの提供に利用できる。自動ツールは通常、対象デバイス上で直接実行するが、ネットワーク経由で実行することも可能である。自動レビューは手作業より高速だが、依然として手作業での確認が必要な設定が残る場合がある。手作業・自動いずれでも、特定のセキュリティ設定を閲覧するには root/管理者権限が必要となる。

一般に、可能な限り手作業ではなく**自動チェック**を用いることが望ましい。自動チェックは迅速で、結果に一貫性と再現性がある。人手で何百・何千もの設定を確認するのは、退屈でエラーが生じやすい。

### 3.5 ネットワークスニッフィング（Network Sniffing）

ネットワークスニッフィングは受動的な手法¹⁰で、ネットワーク通信を監視し、プロトコルをデコードし、ヘッダやペイロードを検査して関心のある情報を抽出する。レビュー手法としてだけでなく、ターゲット識別・分析手法（4.1節参照）として用いることもできる。主な目的は以下のとおり。

- ネットワークトラフィックのキャプチャとリプレイ
- 受動的なネットワーク探索（稼働中デバイスの特定など）
- OS、アプリ、サービス、プロトコルの特定（例：非暗号化 telnet、未承認の P2P など）
- 機密情報の**平文送信**など、未承認・不適切な活動の検出
- 平文のユーザ名・パスワードなどの情報収集

スニッフィングはシステムやネットワークへの影響が小さく、顕著な影響は帯域や計算資源の消費程度である。スニッファ（スニッフィングに用いるツール）は、ハブ、タップ、またはポートスパニング可能なスイッチなど、ネットワークに接続する手段を必要とする。ポートスパニングとは、他ポートで送受信されるトラフィックを、スニッファを接続したポートに複製する機能である。スニッファは環境内のさまざまな位置に配備でき、一般的には次のような場所がある。

- 境界：ネットワークの入出トラフィックを評価
- ファイアウォール背後：ルールセットが正確にトラフィックをフィルタしているかを評価
- IDS/IPS の背後：シグネチャが適切に発火し、適切に対応されているかを判定
- 重要システム／アプリの手前：当該アクティビティを評価
- 特定セグメント：暗号化プロトコルの検証

制約として**暗号化**の存在がある。攻撃者はしばしば暗号化を悪用して活動を隠蔽するため、評価者は通信の存在は見えても内容は見られない。また、スニッファは設置セグメントのトラフィックしか取得できないため、セグメント間の移設や複数台の配備、ポートスパニングの活用が必要となる。各セグメントで物理ポートを確保することが難しい場合もある。さらに、スニッフィングは取得トラフィックの解釈に相応の人手を要する活動である。

### 3.6 ファイル整合性チェック（File Integrity Checking）

ファイル整合性チェッカは、保護対象ファイルごとにチェックサムを計算・保存し、ファイルチェックサムのデータベースを構築することで、システムファイルの変更を特定する。後に再計算したチェックサムと保存値を比較することで、ファイルの改変を検出する。ファイル整合性チェック機能は、商用のホスト型 IDS に通常含まれているほか、スタンドアロンのユーティリティとしても入手可能である。

整合性チェッカはそれ自体に多大な人手を要しないが、**慎重な運用**が効果に直結する。最も効果的なのは、「安全と確認されたシステム」で作成した**基準（リファレンス）データベース**と比較する方法であり、基準側に改ざんファイルが混入していないことを担保できる。基準データベースはオフラインに保管し、攻撃者がシステム侵害後にデータベースを改ざんして痕跡を隠すことを防ぐべきである。加えて、パッチやその他の更新によりファイルは変更されるため、チェックサムデータベースは**最新状態**を維持しなければならない。

ファイル整合性チェックには、チェックサムデータベースの完全性を確保するため、SHA-1 などの**強力な暗号学的チェックサム**を用いるべきである。連邦機関は FIPS PUB 140-2（Security Requirements for Cryptographic Modules）¹¹ により、SHA（例：SHA-1、SHA-256）の使用が求められる。

### 3.7 まとめ

**表3-1**：レビュー手法の主要な機能（Section 3 で解説）

| 手法 | 主要な機能 |
|---|---|
| 文書レビュー（Documentation Review） | 方針・手順の技術的正確性と完全性を評価 |
| ログレビュー（Log Review） | システムの利用・構成・変更に関する過去情報を提供／潜在的問題や方針逸脱を明らかにし得る |
| ルールセットレビュー（Ruleset Review） | ルールベース防御における抜け穴を明らかにする |
| システム設定レビュー（System Configuration Review） | 構成強度を評価／ハードニング方針に沿った設定を検証 |
| ネットワークスニッフィング（Network Sniffing） | ローカルセグメントのトラフィックを監視し、稼働ホスト、OS、プロトコル、サービス、アプリなどを把握／通信の暗号化を検証 |
| ファイル整合性チェック（File Integrity Checking） | 重要ファイルの変更を特定／既知の攻撃ツールなど望ましくないファイルの一部も識別可能 |

各手法およびそれらの組み合わせにはリスクが伴う。安全かつ正確に実施するには、各評価者が一定の**基礎スキル**を備えている必要がある。**表3-2**は、Section 3 の各手法に必要な最低限のスキルセットの目安を示す。

**表3-2**：レビュー手法に必要な基礎スキルセット

| 手法 | 基礎スキルセット |
|---|---|
| 文書レビュー（Documentation Review） | 方針面からのセキュリティ一般知識 |
| ログレビュー（Log Review） | 各種ログ形式の知識、ログの解釈・分析能力、ログ分析・相関ツールの利用能力 |
| ルールセットレビュー（Ruleset Review） | ルールセットの形式・構造の知識、異種デバイスのルールを相関・分析する能力 |
| システム設定レビュー（System Configuration Review） | OS ハードニングや各種 OS のセキュリティ方針設定など、安全なシステム構成の知識、セキュリティ設定自動テストツールの利用能力 |
| ネットワークスニッフィング（Network Sniffing） | TCP/IP とネットワーキング一般知識、トラフィックの解釈・分析能力、スニッフィングツールの導入・運用能力 |
| ファイル整合性チェック（File Integrity Checking） | ファイルシステム一般知識、ファイル整合性チェックツールの利用と結果解釈の能力 |

---

⁶ 本書におけるレビューはアセスメントの観点に限定して論じる。運用上の監視・保守の一環として、運用問題・セキュリティ誤設定・悪意ある活動・その他のセキュリティ事象を特定するために、定期的レビューを実施すべきである。組織は運用レビューの所見をアセスメントに流用してもよい。  
⁷ 追加情報は *NIST SP 800-92, Guide to Security Log Management* を参照（http://csrc.nist.gov/publications/PubsSPs.html）。  
⁸ NIST は IT 製品向けセキュリティ設定チェックリストのリポジトリを維持している（http://checklists.nist.gov/）。  
⁹ SCAP の詳細は http://scap.nist.gov/ を参照。  
¹⁰ スニッファは収集トラフィックに対して DNS ルックアップを行う場合があり、その際はネットワークトラフィックを発生させる。秘匿性が必要な場合は DNS ルックアップを無効化すること。  
¹¹ FIPS PUB 140-2（http://csrc.nist.gov/publications/PubsFIPS.html）。

（2-2 ～ 2-5 / TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT）

