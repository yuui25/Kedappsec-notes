# NIST SP 800-115

**エグゼクティブサマリー（Executive Summary）** …… ES-1

## 1. はじめに（Introduction） …… 1-1
- 1.1 権限／根拠（Authority） …… 1-1  
- 1.2 目的と範囲（Purpose and Scope） …… 1-1  
- 1.3 対象読者（Audience） …… 1-1  
- 1.4 文書構成（Document Structure） …… 1-2  

## 2. セキュリティテストおよび検査の概要（Security Testing and Examination Overview） …… 2-1
- 2.1 情報セキュリティ評価の方法論（Information Security Assessment Methodology） …… 2-1  
- 2.2 技術的評価手法（Technical Assessment Techniques） …… 2-2  
- 2.3 テストと検査の比較（Comparing Tests and Examinations） …… 2-3  
- 2.4 テストの観点（Testing Viewpoints） …… 2-4  
  - 2.4.1 外部と内部（External and Internal） …… 2-4  
  - 2.4.2 公開と秘匿（Overt and Covert） …… 2-5  

## 3. レビュー手法（Review Techniques） …… 3-1
- 3.1 文書レビュー（Documentation Review） …… 3-1  
- 3.2 ログレビュー（Log Review） …… 3-1  
- 3.3 ルールセットレビュー（Ruleset Review） …… 3-2  
- 3.4 システム構成レビュー（System Configuration Review） …… 3-3  
- 3.5 ネットワークスニッフィング／パケット取得（Network Sniffing） …… 3-4  
- 3.6 ファイル完全性検査（File Integrity Checking） …… 3-4  
- 3.7 まとめ（Summary） …… 3-5  

## 4. 対象の特定と分析手法（Target Identification and Analysis Techniques） …… 4-1
- 4.1 ネットワーク探索（Network Discovery） …… 4-1  
- 4.2 ポート／サービス特定（Network Port and Service Identification） …… 4-3  
- 4.3 脆弱性スキャン（Vulnerability Scanning） …… 4-4  
- 4.4 無線スキャン（Wireless Scanning） …… 4-6  
  - 4.4.1 受動的無線スキャン（Passive Wireless Scanning） …… 4-8  
  - 4.4.2 能動的無線スキャン（Active Wireless Scanning） …… 4-9  
  - 4.4.3 無線デバイスの位置追跡（Wireless Device Location Tracking） …… 4-9  
  - 4.4.4 Bluetooth スキャン（Bluetooth Scanning） …… 4-10  
- 4.5 まとめ（Summary） …… 4-10  

## 5. 対象脆弱性の検証手法（Target Vulnerability Validation Techniques） …… 5-1
- 5.1 パスワードクラック（Password Cracking） …… 5-1  
- 5.2 ペネトレーションテスト（Penetration Testing） …… 5-2  
  - 5.2.1 ペネトレーションテストのフェーズ（Penetration Testing Phases） …… 5-2  
  - 5.2.2 ペネトレーションテストの実施要領（Logistics） …… 5-5  
- 5.3 ソーシャルエンジニアリング（Social Engineering） …… 5-6  
- 5.4 まとめ（Summary） …… 5-7  

## 6. セキュリティ評価の計画（Security Assessment Planning） …… 6-1
- 6.1 セキュリティ評価ポリシーの策定（Developing a Security Assessment Policy） …… 6-1  
- 6.2 評価の優先度付けとスケジューリング（Prioritizing and Scheduling Assessments） …… 6-1  
- 6.3 手法の選定とカスタマイズ（Selecting and Customizing Techniques） …… 6-3  
- 6.4 実施要領／ロジスティクス（Assessment Logistics） …… 6-4  
  - 6.4.1 評価者の選定とスキル（Assessor Selection and Skills） …… 6-5  
  - 6.4.2 実施場所の選定（Location Selection） …… 6-6  
  - 6.4.3 技術ツールとリソースの選定（Technical Tools and Resources Selection） …… 6-8  
- 6.5 評価計画の作成（Assessment Plan Development） …… 6-10  
- 6.6 法的考慮事項（Legal Considerations） …… 6-12  
- 6.7 まとめ（Summary） …… 6-12  

## 7. セキュリティ評価の実施（Security Assessment Execution） …… 7-1
- 7.1 調整（Coordination） …… 7-1  
- 7.2 評価の遂行（Assessing） …… 7-2  
- 7.3 分析（Analysis） …… 7-3  
- 7.4 データ取扱い（Data Handling） …… 7-4  
  - 7.4.1 データ収集（Data Collection） …… 7-5  
  - 7.4.2 データ保存（Data Storage） …… 7-5  
  - 7.4.3 データ送信（Data Transmission） …… 7-6  
  - 7.4.4 データ破棄（Data Destruction） …… 7-7  

## 8. テスト後の活動（Post-Testing Activities） …… 8-1
- 8.1 緩和策の提言（Mitigation Recommendations） …… 8-1  
- 8.2 報告（Reporting） …… 8-1  
- 8.3 修復／緩和（Remediation/Mitigation） …… 8-2

  # 付録一覧（List of Appendices）
- 付録A — セキュリティテスト用 Live CD ディストリビューション …… A-1
- 付録B — 交戦規定（Rules of Engagement）テンプレート …… B-1
- 付録C — アプリケーションセキュリティのテストと検査 …… C-1
- 付録D — リモートアクセスのテスト …… D-1
- 付録E — リソース（Resources） …… E-1
- 付録F — 用語集（Glossary） …… F-1
- 付録G — 頭字語・略語（Acronyms and Abbreviations） …… G-1

# 表一覧（List of Tables）
- 表3-1 レビュー手法（Review Techniques） …… 3-5
- 表3-2 レビュー手法のベースラインスキルセット …… 3-5
- 表4-1 対象の特定と分析手法（Target Identification and Analysis Techniques） …… 4-10
- 表4-2 対象の特定と分析手法のベースラインスキルセット …… 4-11
- 表5-1 対象脆弱性の検証手法（Target Vulnerability Validation Techniques） …… 5-7
- 表5-2 セキュリティテストの知識・技能・能力（Knowledge, Skills, and Abilities） …… 5-7
- 表A-1 BackTrack ツールキット例 …… A-1
- 表A-2 Knoppix STD ツールキット例 …… A-2
- 表E-1 関連する NIST 文書 …… E-1
- 表E-2 オンラインリソース …… E-1

# 図一覧（List of Figures）
- 図5-1 4段階のペネトレーションテスト方法論（Four-Stage Penetration Testing Methodology） …… 5-3
- 図5-2 探索フェーズへループバックする攻撃フェーズの手順（Attack Phase Steps with Loopback to Discovery Phase） …… 5-4

# エグゼクティブサマリー（Executive Summary）

情報セキュリティ評価とは、評価対象（assessment object：ホスト、システム、ネットワーク、手順、人物など）が特定のセキュリティ目標をどの程度有効に満たしているかを判定するプロセスである。これを達成するためには、**試験（testing）**、**検査（examination）**、**インタビュー（interviewing）**という3種類の評価方法が用いられる。**試験**は、所定の条件下で1つ以上の評価対象を動作させ、実際の挙動と期待される挙動を比較するプロセスである。**検査**は、理解を促進し、明確化を達成し、または証拠を得るために、1つ以上の評価対象を確認・点検・レビュー・観察・調査・分析するプロセスである。**インタビュー**は、理解を促進し、明確化を達成し、または証拠の所在を特定するために、組織内の個人またはグループと議論を行うプロセスである。評価結果は、時間の経過にわたってセキュリティ管理策の有効性を判断することを支えるために用いられる。

本書は、情報セキュリティ評価の実施に関する基本的な技術面のためのガイドである。組織が評価の一部として用い得る技術的な試験および検査の方法・手法を提示し、それらの実行およびシステムやネットワークに与え得る影響に関する示唆を評価者に提供する。評価を成功させ、システム（ひいては組織全体）のセキュリティ姿勢に好影響を与えるには、試験と検査の実行を超える要素がこの技術的プロセスを支える必要がある。本書では、強固な計画プロセス、根本原因分析、状況に合わせた報告といった活動に関する提言も示す。

本書で提示するプロセスおよび技術的指針により、組織は次のことを実現できる。
- 情報セキュリティ評価の方針、方法論、および評価の技術的側面に関する個々の役割と責任を整備する。
- どのシステムを評価するか、評価アプローチ、ロジスティクス上の考慮事項、評価計画の策定、法令・ポリシー上の考慮事項への対応といった点に関する指針を提供することで、技術的セキュリティ評価を正確に計画する。
- 提示された方法と手法を用いて、評価中に発生し得るインシデントに対応しつつ、技術的セキュリティ評価を安全かつ効果的に実行する。
- 評価プロセス全体を通じて、技術データ（収集、保存、送信、破棄）を適切に取り扱う。
- 技術的所見を組織のセキュリティ姿勢を改善するためのリスク低減アクションへと翻訳する分析と報告を実施する。

本書に示す情報は、さまざまな評価目的での利用を意図している。例えば、特定のセキュリティ管理策（複数の場合もある）が要件を満たしていることの検証に焦点を当てる評価もあれば、システムに存在する悪用可能なセキュリティ上の弱点を特定・検証・評価することを目的とする評価もある。さらに、組織が積極的なコンピュータネットワーク防御を維持する能力を高めるために評価が実施されることもある。評価は、セキュリティ管理策の実装やシステムセキュリティの維持の代替として行われるものではない。

技術的セキュリティ評価を遂行し、技術的なセキュリティの試験と検査が最大の価値を発揮するようにするために、NIST は組織に対して次のことを推奨する。
- **情報セキュリティ評価方針を確立すること。** これは、評価を実施するための組織の要件を明確にし、これらの要件に従って評価が実施されるよう適切な個人に説明責任を持たせるものである。評価方針が扱うべき主題には、評価が順守すべき組織要件、役割と責任、確立された評価方法論の遵守、評価頻度、文書化要件が含まれる。
- **反復可能で文書化された評価方法論を実装すること。** これは、評価に一貫性と構造を与え、新たな評価要員の移行を迅速化し、評価に伴うリソース制約へ対処する。かかる方法論を用いることで、組織は評価の価値を最大化しつつ、特定の技術的評価手法がもたらし得るリスクを最小化できる。これらのリスクは、システム機能への影響を懸念するあまり組織のセキュリティ姿勢に関する十分な情報を収集できないことから、適切な安全策がないまま手法を実行してシステムまたはネットワークの可用性に影響を及ぼすことまで幅がある。特定の評価手法に起因するリスクを最小化するプロセスの例としては、熟練した評価者の起用、包括的な評価計画の作成、評価者活動の記録、時間外での試験実施、本番システムの複製（例：開発システム）での試験が挙げられる。組織は各評価について許容するリスク水準を定め、それに応じてアプローチを調整する必要がある。
- **各セキュリティ評価の目的を特定し、それに応じてアプローチを調整すること。** セキュリティ評価には固有の目的、許容可能なリスク水準、利用可能な資源がある。単独の手法のみを実行しても組織のセキュリティの包括的な把握は得られないため、技術の組み合わせを用いるべきである。これはリスクと資源使用の抑制にも資する。
- **所見を分析し、弱点に対処するリスク低減手法を策定すること。** セキュリティ評価が最終的な価値を提供することを確実にするため、評価完了後に根本原因分析を実施し、所見を実行可能な緩和策へと翻訳できるようにする。結果として、技術的弱点だけでなく、組織のプロセスや手順上の弱点にも対処すべきであることが示される場合がある。

# 1. はじめに（Introduction）

## 1.1 権限（Authority）
米国国立標準技術研究所（NIST）は、本書を2002年の**連邦情報セキュリティ管理法（FISMA）**（Public Law 107-347）に基づく法定責務の履行として作成した。  
NISTは、すべての政府機関の業務および資産に対し、十分な情報セキュリティを提供するための**標準およびガイドライン（最低要求事項を含む）**を策定する責務を負う。ただし、これらの標準およびガイドラインは**国家安全保障システム**には適用されない。本ガイドラインは、**行政管理予算局（OMB）通達 A-130** の要件、とりわけ **第8b(3)節「機関の情報システムの保護（Securing Agency Information Systems）」** と、その分析である **A-130 付録IV「主要区分の分析」** に整合している。補足情報は **A-130 付録III** に示されている。  

本ガイドラインは**連邦政府機関**での利用を目的として作成された。**非政府組織**も**任意**で利用でき、**著作権の対象ではない**（ただし**出典の明記が望ましい**）。  

本書のいかなる内容も、商務長官の法定権限に基づき**連邦政府機関に対して義務化・拘束力を持つ標準やガイドライン**と矛盾するものとして解釈されるべきではない。また、本ガイドラインが**商務長官**、**OMB長官**、その他の**連邦政府高官**の既存の権限を変更または優先するものとして解釈されるべきではない。

## 1.2 目的と範囲（Purpose and Scope）
本書の目的は、組織が**技術的な情報セキュリティの試験および評価**を**計画・実施**し、**所見を分析**して**緩和戦略を策定**する際のガイドラインを提供することである。具体的には、セキュリティの**試験・評価のプロセス／手順に関する技術的情報**を**設計・実装・維持**するための実践的な推奨事項を示し、これを**複数の目的**（例：システムやネットワークの**脆弱性の発見**、**方針やその他要件への適合性の検証**）に活用できるようにする。  

本ガイドは、**包括的な情報セキュリティの試験または評価プログラム**を提示することを意図したものではない。むしろ、**技術的セキュリティ試験・評価の主要要素**の概観を示し、**特定の手法**、それらの**利点と限界**、および**活用に関する推奨**に重点を置く。  

本書は **NIST 特別刊行物 800-42『ネットワークセキュリティテストのガイドライン』** を**置き換える**ものである。

## 1.3 対象読者（Audience）
本ガイドは、**コンピュータセキュリティ担当者**や**プログラムマネージャ**、**システム／ネットワーク管理者**、その他、システムおよびネットワーク基盤の**準備・運用・セキュリティ確保**における**技術的側面に責任を負う技術スタッフ**による利用を意図している。**管理者**も、ここで提示する情報を**セキュリティの試験・評価に関連する技術的意思決定**を促進するために利用できる。本書の内容は**技術志向**であり、読者が**システムおよびネットワークセキュリティに関する基礎的理解**を有していることを前提とする。

## 1.4 文書構成（Document Structure）
本書の残りの部分は、次の**7つの主要セクション**で構成される。

- **第2章**：情報セキュリティ評価の概観（方針、役割と責任、方法論、手法 を含む）  
- **第3章**：複数の**技術的検査手法**の詳細（文書レビュー、ログレビュー、ネットワークスニッフィング、ファイル完全性検査 など）  
- **第4章**：**対象の特定と分析**のための各種手法（例：ネットワーク探索、脆弱性スキャン）  
- **第5章**：脆弱性の**存在を検証**するために一般的に用いられる手法（例：パスワードクラック、ペネトレーションテスト）  
- **第6章**：**セキュリティ評価の計画**に関するアプローチとプロセス  
- **第7章**：**セキュリティ評価の実施**に不可欠な要素（調整、評価そのもの、分析、データ取扱い）  
- **第8章**：**評価所見の報告**に関するアプローチと、**是正（リメディエーション）活動**の概観  

さらに、本ガイドには以下の**付録**が含まれる。

- **付録A**：OSをCDから起動し、完全なOSとテストツールを提供する**2つのLive OSディストリビューション**の説明  
- **付録B**：**交戦規定（Rules of Engagement; ROE）**のテンプレート  
- **付録C**：**アプリケーションセキュリティ評価**の簡単な解説  
- **付録D**：**リモートアクセスのテスト**に関する推奨事項  
- **付録E**：セキュリティ評価プロセスを支援し得る**リソース一覧**  
- **付録F**：本書全体で用いられる**用語集（Glossary）**  
- **付録G**：**頭字語・略語一覧（Acronyms and Abbreviations）**

# 2. セキュリティテストおよび精査の概要

情報セキュリティアセスメントとは、評価対象（例：ホスト、システム、ネットワーク、手順、人。以下「アセスメントオブジェクト」）が、特定のセキュリティ目的をどの程度満たしているかを判定するプロセスである。これを達成するために用いられる評価手法は、テスト（testing）、精査（examination）、インタビュー（interviewing）の3種類がある。  
テストは、所定の条件下で1つ以上のアセスメントオブジェクトを実行し、実際の挙動と期待される挙動を比較するプロセスである。精査は、1つ以上のアセスメントオブジェクトを確認・検査・閲覧・観察・研究・分析して、理解の促進、疑問点の解消、証拠の取得を図るプロセスである。インタビューは、組織内の個人またはグループと議論を行い、理解の促進、疑問点の解消、証拠の所在の特定を図るプロセスである。アセスメント結果は、時間経過に伴うセキュリティコントロールの有効性判断を支援するために用いられる。

本書は、技術的な脆弱性の識別・妥当化・評価に用いることができ、組織が自らのシステムやネットワークのセキュリティ態勢の理解と改善に資する、技術的テストおよび精査の手法を扱う。セキュリティテストと精査は FISMA¹ などの規制により要求される。これはセキュリティコントロールの実装やシステムセキュリティの維持に取って代わるものではなく、システムが適切に保護されていることを確認し、満たされていない組織のセキュリティ要件や対処すべきその他の弱点を特定することを目的とする。

本章では、情報セキュリティアセスメントの方法論と、技術的テストおよび精査の手法の概要を示す。

## 2.1 情報セキュリティアセスメントの方法論

反復可能で文書化されたセキュリティアセスメント方法論には、次の利点がある。
- セキュリティテストに一貫性と構造を与え、テストに伴うリスクを最小化できる
- 新任のアセスメント要員の立ち上げを迅速化できる
- セキュリティアセスメントに伴うリソース制約に対処できる

情報セキュリティアセスメントには、時間・要員・ハードウェア・ソフトウェアといったリソースが必要であり、利用可能なリソースは実施するアセスメントの種類や頻度にしばしば制約を与える。組織が実施するテストや精査の種類を評価し、適切な方法論を策定し、必要なリソースを特定し、想定要件を満たすようにアセスメントプロセスを構成することで、このリソース面の課題を緩和できる。これにより、訓練された要員や標準化されたテストプラットフォームといった事前に整備したリソースを再利用でき、アセスメントの実施時間とテスト機材・ソフトウェア調達の必要性を低減し、総コストを削減できる。

段階的（フェーズド）な情報セキュリティアセスメント方法論には多くの利点がある。この構造は理解しやすく、要員の交代に自然な区切りを提供する。最低限、次のフェーズを含むべきである。

- **計画（Planning）**：セキュリティアセスメントの成功に不可欠なフェーズであり、評価対象資産、当該資産に対する関心のある脅威、それらの脅威を軽減するために用いるセキュリティコントロールなど、実行に必要な情報を収集し、アセスメント方針を策定する。セキュリティアセスメントは他のプロジェクトと同様に扱い、目的・目標、範囲、要件、チームの役割と責任、制約、成功要因、前提、リソース、タイムライン、成果物を扱うプロジェクトマネジメント計画を用意する。本ガイドの第6章で計画を扱う。
- **実行（Execution）**：このフェーズの主目的は、脆弱性を識別し、必要に応じて妥当化（検証）することである。本フェーズは、想定するアセスメント手法・技術に関連する活動を扱う。具体的活動はアセスメントの種類によって異なるが、完了時には、システム・ネットワーク・組織プロセスにおける脆弱性が特定されている。本フェーズの詳細は第7章で扱う。
- **事後（Post-Execution）**：識別した脆弱性を分析して根本原因を明らかにし、緩和策を定め、最終報告書を作成することに焦点を当てる。本ガイドの第8章で報告と緩和を扱う。

種々の情報セキュリティアセスメントの実施方法論が広く受け入れられている。これらの方法論への参照は付録E² に示す。たとえば、NIST は NIST SP 800-53 に記載のセキュリティコントロールの有効性評価に関する提案を示す **NIST SP 800-53A**（Guide for Assessing the Security Controls in Federal Information Systems）という方法論を策定している³。広く用いられている他の方法論に **OSSTMM**（Open Source Security Testing Methodology Manual）⁴ がある。アセスメントを実施する理由は多岐にわたるため、組織は複数の方法論を併用してもよい。本書は、多くの方法論や目的で活用できる技術的テストおよび精査の推奨手法を提供する。

## 2.2 技術的アセスメント手法

システムおよびネットワークのセキュリティ態勢を評価するために使用できる技術的なセキュリティテストおよび精査手法は多数存在する。本書の観点から一般的な手法は後述し、次の3分類にまとめる。

- **レビュー手法（Review Techniques）**：システム、アプリケーション、ネットワーク、方針、手順を評価して脆弱性を発見する精査手法で、一般に手作業で実施する。文書レビュー、ログレビュー、ルールセットレビュー、システム設定レビュー、ネットワークスニッフィング、ファイル整合性チェック等を含む。第3章で詳述する。
- **ターゲット識別・分析手法（Target Identification and Analysis Techniques）**：システム、ポート、サービス、潜在的な脆弱性を特定するテスト手法で、手作業でも実施可能だが通常は自動化ツールを用いる。ネットワーク探索、ネットワークポート/サービス識別、脆弱性スキャン、無線スキャン、アプリケーションセキュリティ精査等を含む。第4章で詳述する。
- **ターゲット脆弱性の妥当化手法（Target Vulnerability Validation Techniques）**：脆弱性の存在を裏付けるテスト手法で、具体的手法やチームの技能により手作業または自動ツールで実施する。パスワードクラッキング、ペネトレーションテスト、ソーシャルエンジニアリング、アプリケーションセキュリティテスト等を含む。第5章で詳述する。

単一の手法だけでシステムやネットワークのセキュリティ全体像を提供することはできないため、組織は適切な手法を組み合わせて堅牢なアセスメントを実施すべきである。たとえば、ペネトレーションテストは、将来の侵入対象となり得るホストやサービスを特定するために、ネットワークのポート/サービス識別と脆弱性スキャンの双方に依存することが多い。また、同一要件（例：パッチが適用済みか）を満たすための技術的手段は複数存在し得る。本書は、こうした各技術手法の実施方法を説明することに焦点を当て、状況ごとに用いるべき手法を規定しない――すなわち、組織が自らの要件に最適な手法を柔軟に選択できるようにする。

本書で扱う技術的手法に加えて、技術的手法の代わりに、あるいは併用可能な多数の**非技術的手法**が存在する。例として物理セキュリティテストがあり、鍵、バッジリーダー、その他の物理セキュリティコントロールを迂回して特定ホストへの不正アクセスを試みることで、物理的脆弱性の存在を確認する。資産の手動識別も非技術的手法の一例であり、資産台帳、施設の実地巡回などを通じて評価対象資産を特定する（技術的手法に頼らない）やり方である。非技術的手法の詳細は本書の範囲外だが、それらの価値を認識し、技術的手法より適切な場面を検討することは重要である。

## 2.3 テストと精査の比較

**精査（Examinations）**は、方針、手順、セキュリティ計画、セキュリティ要件、標準運用手順、アーキテクチャ図、エンジニアリング文書、資産台帳、システム設定、ルールセット、システムログなどの文書レビューが中心である。精査は、システムが適切に文書化されているか、また文書からしか得られないセキュリティの側面に関する洞察を得るために実施される。これらの文書は、システムやネットワークの設計、導入、設定、運用、保守の意図を示し、そのレビューと相互参照により整合性や適合性を確認する。例えば、環境のセキュリティ要件はシステムセキュリティ計画や標準運用手順といった文書の拠り所であるべきであり、評価者はすべての計画、手順、アーキテクチャ、設定が、定義されたセキュリティ要件および適用される方針に準拠していることを確認する。別の例では、ファイアウォールのルールセットが、インターネット利用に関する組織のセキュリティ方針（インスタントメッセージング、P2Pファイル共有、その他の禁止行為の扱いなど）に準拠するかをレビューする。

精査は、対象環境の実システムやネットワークに対して、必要な文書・ログ・ルールセットへのアクセスを除き、通常は影響を与えない⁵。ただし、ルータやファイアウォールなどからシステム設定ファイルやログを取得する場合は、設定が誤って変更・削除されないよう、システム管理者や同等の訓練を受けた者のみが作業すべきである。

**テスト（Testing）**は、システムやネットワークに対して直接作業してセキュリティ脆弱性を識別するもので、全社的にも、選定したシステムに対しても実行できる。スキャンや侵入手法の使用は、潜在的な脆弱性に関する有用な情報を提供し、攻撃者や侵入者がそれらを悪用できる可能性の予測に役立つ。テストはまた、パッチ管理、パスワード方針、構成管理などの領域での遵守状況の測定を可能にする。

テストは精査に比べて、組織のセキュリティ態勢のより正確な像を与えうるが、より侵襲的であり、対象環境のシステムやネットワークに影響を与え得る。潜在的影響の程度は用いるテスト手法に依存し、オープン/クローズドポートの判定に通常のネットワークパケットを送る場合もあれば、脆弱性を試験するために特殊に作成したパケットを送る場合もある。システムやネットワークと直接相互作用するテストやテスターが関与する際には、予期せぬシステム停止などのDoSが発生する可能性が常に存在する。組織は、どの手法を用いるかを決める際に、受容可能な侵襲性のレベルを定めるべきである。既知のDoSやその他の障害を引き起こすテストを除外することで、負の影響を低減できる。

テストは、組織のセキュリティ態勢を包括的に評価するものではなく、特に時間といったリソース制約のため、しばしばスコープが狭い。一方、悪意ある攻撃者は、システムやネットワークを侵害するために必要なだけの時間をかけることができる。加えて、組織はシステムやネットワークに影響を与えるテスト手法の使用を避ける傾向があるが、攻撃者にはその制約はなく、必要と思えばどの手法でも用いる。結果として、テストは、方針や設定に関連する弱点の特定において、精査ほど有効ではない場合が多い。多くのケースで、テストと精査を組み合わせることが、より正確なセキュリティ像の把握につながる。

## 2.4 テストの視点

テストは、外部攻撃者や悪意ある内部者がどの程度容易にシステムを攻撃可能か、といった様々な視点から実施できる。本ガイド第2.4.1節では、外部と内部の視点から行うテストを比較し、第2.4.2節では、評価者が対象または対象環境について事前に持つ知識という別の観点を論じる。

### 2.4.1 外部と内部

**外部セキュリティテスト**は、組織のセキュリティ境界外から実施する。これは、インターネットから見える外部視点で環境のセキュリティ態勢を把握し、外部攻撃者に悪用され得る脆弱性を明らかにすることを目的とする。  
外部テストはしばしば偵察から始まり、公開登録データ、DNSサーバ情報、ニュースグループ投稿、その他公開情報を調査して、脆弱性特定に役立つ情報（システム名、IPアドレス、OS、技術的連絡先など）を収集する。次に列挙を行い、ネットワーク探索やスキャン手法で外部ホストと待受サービスを特定する。周辺防御（ファイアウォール、ルータ、ACLなど）は内部ネットワークへ許容するトラフィックの種類を制限するため、評価者は外部攻撃者と同様に、これらを回避する手法を用いることが多い。許可されるプロトコルに依存するが、初期攻撃は一般に FTP、HTTP、SMTP、POP といったよく使われ許可されやすいアプリケーションプロトコルに焦点を当てる。外部から到達可能なサーバは、内部サーバや機密情報へのアクセスを許しかねない脆弱性について検査される。外部テストはまた、無線AP、モデム、内部サーバへのポータルなど、アクセス経路の脆弱性の発見にも注力する。

**内部セキュリティテスト**では、評価者は内部ネットワークから作業し、信頼された内部者、または周辺防御をすり抜けた攻撃者の立場を仮定する。これにより、悪用され得る脆弱性を明らかにし、この種の攻撃者が与えうる潜在的損害を示すことができる。内部テストは、アプリケーションやサービスの設定、認証、アクセス制御、システムの堅牢化など、システムレベルのセキュリティと構成にも焦点を当てる。  
内部テストの評価者にはしばしば、一般ユーザとしてのレベルなど、何らかのネットワークアクセス権が付与され、同等の権限を持つユーザが得られる情報が提供される。この一時的アクセス権のレベルはテストの目的に依存し、システム/ネットワーク管理者の権限に至るまで設定され得る。付与された権限レベルから出発し、評価者は権限昇格（一般ユーザ権限を管理者権限へ、システム管理者権限をドメイン管理者権限へ引き上げる）を通じて、ネットワークやシステムへのさらなるアクセス獲得を試みる。

内部テストは周辺防御の内側で行われるため、外部テストほどの制約は受けないが、内部ファイアウォール、ルータ、スイッチが制限となる場合もある。テスト手法に加えて、ネットワークスニッフィング等の精査手法を用いる場合もある。  
外部と内部の両方を実施する場合、通常は外部テストを先に行う。同一の評価者が両方を実施する場合、内部アーキテクチャや設定に関する内部者情報を先に得てしまうこと（攻撃者が得られない利点）を避け、テストの妥当性を損なわないために有益である。

### 2.4.2 公知と秘匿（オーバートとコーバート）

**オーバート（Overt）セキュリティテスト**はホワイトハットテストとも呼ばれ、組織のITスタッフの知悉と同意のもとに外部および/または内部テストを実施し、ネットワークやシステムのセキュリティ態勢を包括的に評価できる。ITスタッフがテストを十分に把握し関与するため、影響を限定する指針を提供できる場合がある。スタッフが評価者の活動や手法を観察でき、実装・維持しているセキュリティ要件の文脈理解や、テストの実施方法に関する教育機会にもなり得る。

**コーバート（Covert）セキュリティテスト**はブラックハットテストとも呼ばれ、組織のITスタッフには知らせず、上層部の十分な知悉と許可のもとでテストを実施する。多くの組織は信頼できる第三者を指名し、検知された活動がテスト由来でないかを事前確認せずに、対象組織が対応措置を開始しないよう担保する。こうした状況では、第三者は評価者、経営陣、ITスタッフ、セキュリティスタッフの仲介役として活動し、行動を調整しコミュニケーションを円滑化する。この種のテストは、技術的セキュリティコントロール、ITスタッフのインシデント対応、セキュリティ方針の理解と実装を検証するのに有用である。事前告知の有無を問わず実施され得る。

コーバートテストの目的は、敵対者が引き起こし得る損害や影響を検証することであり、脆弱性の網羅的特定に重点を置かない。この種のテストは、あらゆるセキュリティコントロールをテストしたり、すべての脆弱性を識別したり、組織内の全システムを評価したりするものではない。コーバートテストは敵対者の視点から組織を評価し、ネットワークアクセスの獲得に至る最も初歩的な脆弱性の特定・悪用に留まるのが通常である。特定の敵対者像を模倣することが目標であれば、脅威データの収集とモデリングなど、特別な考慮が必要となる。その結果得られるシナリオは、侵害の潜在的手段、リスク、影響に関する全体的・戦略的な見取り図を提供する。  
コーバートテストにはしばしば明確な境界（到達したアクセスレベルや、次段階で実現可能な損害の種類など）が設定される。これは損害を防ぎつつ、損害の可能性を示すためである。

多くの脆弱性を特定できないことに加え、コーバートテストは秘匿要件のため、時間とコストがかかることが多い。秘匿環境での運用には、対象組織のセキュリティスタッフに検知されないよう、スキャンやその他の行動を遅らせる必要がある。社内でテストを行う場合は、時間と予算の観点から訓練も考慮すべきである。さらに、組織のスタッフはスキャンや脆弱性アセスメントのような定常活動には習熟していても、ペネトレーションやアプリケーションセキュリティテストのような専門的手法には習熟していない場合がある。オーバートテストはコストが低くリスクも小さいため、より一般的に用いられるが、コーバートテストは管理者の警戒が高まらないため、対象組織の日常的なセキュリティの実態をより適切に示すことができる。

---

¹ セクション3544は「リスクに応じた頻度で、少なくとも年1回、情報セキュリティの方針・手順・実務の有効性に関する定期的なテストと評価」を要求している。FISMAは http://csrc.nist.gov/drivers/documents/FISMA-final.pdf にある。  
² NISTはいずれかの方法論を推奨するものではない。組織が既存の方法論を採用するか、複数を組み合わせて独自の方法論を策定するか、選択可能とするための選択肢を提供することが意図である。  
³ NIST SP 800-53A は、アセスメント手順の策定フレームワーク、セキュリティコントロールの評価プロセス、各コントロールのアセスメント手順を扱う。同書は NIST SP 800-37（Guide for the Security Certification and Accreditation of Federal Information Systems）と併せて用いることを想定している。NIST SP 800-53、800-53A、800-37 は http://csrc.nist.gov/publications/PubsSPs.html にある。  
⁴ OSSTMM の詳細は http://www.isecom.org/osstmm/ を参照。

（2-1 / TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT）

⁵ 受動的テスト手法の1つであるネットワークスニッフィングは、ハブ、タップ、スパンポートにスニファを接続する必要があり、機器の再設定を伴う場合には運用に影響を及ぼし得る。

# 3. レビュー手法（Review Techniques）

レビュー手法は、システム、アプリケーション、ネットワーク、方針（policies）、手順（procedures）を**受動的**に精査してセキュリティ上の脆弱性を発見する。⁶ また、他のアセスメント手法を円滑かつ最適に実施するための情報収集にも用いられる。受動的であるため、レビュー手法がシステムやネットワークに与えるリスクは最小限である。本章では、文書レビュー、ログレビュー、ルールセットレビュー、システム設定レビュー、ネットワークスニッフィング、ファイル整合性チェックといった一般的なレビュー手法を扱う。

## 3.1 文書レビュー（Documentation Review）

文書レビューは、方針・手順の技術的側面が現状に合致し包括的であるかを判定する。これらの文書は組織のセキュリティ態勢の基盤だが、技術的アセスメントでは見落とされがちである。組織内のセキュリティ部門は、包括的なレビューを保証するために適切な文書を評価者へ提供すべきである。技術的な正確性と完全性の観点からレビューすべき文書には、セキュリティ方針、アーキテクチャ、要件、標準運用手順（SOP）、システムセキュリティ計画（SSP）と認可合意、システム間接続に関する了解覚書（MOU/IAA）、インシデント対応計画などが含まれる。

文書レビューは、セキュリティコントロールの欠落や不適切実装につながりうるギャップや弱点を発見できる。評価者は通常、組織の文書が FISMA などの基準・規制に準拠しているかを検証し、不十分または古い方針がないかを確認する。一般的な弱点としては、もはや使用されていない OS の手順・プロトコルが残っている、あるいは新しい OS とそのプロトコルが反映されていない、といったことが挙げられる。文書レビューは、セキュリティコントロールが適切に実装されていること**自体**を保証するものではなく、セキュリティ基盤を支える「指針や方針」が存在することを確認するものである。

文書レビューの結果は、他のテストや精査手法の微調整に活用できる。例えば、パスワード管理方針に最小長や複雑性の要件があるなら、その情報でパスワードクラッキングツールの設定を絞り込み、効率を高められる。

## 3.2 ログレビュー（Log Review）

ログレビューは、セキュリティコントロールが適切な情報をログしているか、組織がログ管理方針に準拠しているかを判定する。⁷ 監査ログは過去情報の源泉であり、システムが確立された方針どおりに動作しているかの検証に役立つ。たとえば、「重要サーバへの全ての認証試行を記録する」という方針があるなら、ログレビューでは当該情報が収集され、適切な詳細度で記録されているかを確認する。ログレビューはまた、誤設定されたサービスやセキュリティコントロール、不正アクセス、侵入試行などの問題を明らかにすることもある。たとえば、ファイアウォールの内側に配置された IDS センサーのログは、ファイアウォールが内部に許可した通信を検証するのに用いられる。センサーが本来ブロックすべき活動を記録している場合、ファイアウォールの設定が安全でないことを示す。

技術的アセスメントで有用となるログの例：
- **認証サーバ／システムのログ**：認証の成功・失敗
- **システムログ**：システム／サービスの起動・停止、未承認ソフトのインストール、ファイルアクセス、セキュリティ方針変更、アカウント変更（作成・削除、権限付与）、特権利用
- **IDS/IPS ログ**：悪意ある活動、不適切利用
- **ファイアウォール／ルータログ**：内部デバイスの侵害を示す外向き接続（例：rootkit、ボット、トロイ、スパイウェア）
- **ファイアウォールログ**：未承認の接続試行、不適切利用
- **アプリケーションログ**：未承認の接続試行、アカウント変更、特権使用、アプリ／DB の利用情報
- **アンチウイルスログ**：更新失敗、古いシグネチャ／ソフトの兆候
- **セキュリティログ**（特にパッチ管理や一部の IDS/IPS 製品）：既知の脆弱なサービス／アプリに関する情報の記録

手作業でのログレビューは非常に時間を要し煩雑になりがちである。レビュー時間を大幅に短縮し、ログ内容を要約して特定活動にひもづけた定型・カスタムレポートを生成できる自動監査ツールが利用可能である。評価者は、異なる形式のログを単一の標準形式に正規化するなど、これらの自動ツールでログ分析を容易にできる。さらに、組織内の失敗ログオン回数の把握など特定の行為をレビューする場合、当該行為でログをフィルタリングできる。

## 3.3 ルールセットレビュー（Ruleset Review）

ルールセットとは、ネットワークトラフィックやシステム活動を照合して取るべき動作（例：パケットの転送／拒否、アラート生成、システムイベントの許可）を決める規則やシグネチャの集合である。レビューは、包括性を担保し、ネットワーク上の脆弱性、方針違反、意図せぬ／脆弱な通信経路など、階層化された防御全体におけるギャップや弱点を特定するために行う。また、ルールセットの性能に悪影響を与える非効率も洗い出せる。

レビュー対象のルールセットには、ネットワーク／ホスト型ファイアウォール、IDS/IPS のルールセット、ルータの ACL が含まれる。一般的なチェック例は以下のとおり。

- **ルータの ACL**
  - 各ルールは依然として必要か（例：一時的目的で追加したルールは不要になり次第削除されているか）
  - 方針で許可されたトラフィックのみを許容し、他はデフォルト拒否となっているか
- **ファイアウォールのルールセット**
  - 各ルールは依然として必要か
  - 必要な IP アドレスとポートに限定するなど、最小権限を強制しているか
  - より特化したルールが一般的なルールより先に適用されるか
  - 閉じうる不要なオープンポートが残っていないか（境界の強化）
  - 他のセキュリティ防御を迂回させるような許可がないか
  - **ホスト型ファイアウォール**では、バックドア、スパイウェア活動、P2P など禁止アプリの存在を示すルールがないか
- **IDS/IPS のルールセット**
  - 不要なシグネチャを無効化・削除し、誤検知を減らして性能を改善しているか
  - 必要なシグネチャが有効で、適切にチューニング・保守されているか

## 3.4 システム設定レビュー（System Configuration Review）

システム設定レビューは、ハードニング不足や方針不適合など、セキュリティ設定コントロールの弱点を特定するプロセスである。例えば、不要なサービスやアプリ、誤ったアカウント／パスワード設定、不適切なログ／バックアップ設定などを明らかにする。レビュー対象の例として、Windows のセキュリティポリシー設定、Unix の /etc 配下にある各種セキュリティ設定ファイルなどがある。

手作業レビューでは、セキュリティ設定ガイドやチェックリストを用いて、設定がリスク最小化に寄与する構成になっているかを検証する。⁸ 手作業レビューでは、対象デバイスの各種セキュリティ設定にアクセスし、推奨設定と照合する。最小基準を満たさない設定はフラグ付けして報告する。

**SCAP（Security Content Automation Protocol）**は、特定の標準を用いて脆弱性管理、評価、方針遵守の判定を自動化するための方法である。⁹ NIST の SCAP ファイルは FISMA 準拠および NIST SP 800-53A によるセキュリティコントロール評価向けに作成されている。その他のツールも、セキュリティ設定の収集・報告や是正ガイダンスの提供に利用できる。自動ツールは通常、対象デバイス上で直接実行するが、ネットワーク経由で実行することも可能である。自動レビューは手作業より高速だが、依然として手作業での確認が必要な設定が残る場合がある。手作業・自動いずれでも、特定のセキュリティ設定を閲覧するには root/管理者権限が必要となる。

一般に、可能な限り手作業ではなく**自動チェック**を用いることが望ましい。自動チェックは迅速で、結果に一貫性と再現性がある。人手で何百・何千もの設定を確認するのは、退屈でエラーが生じやすい。

## 3.5 ネットワークスニッフィング（Network Sniffing）

ネットワークスニッフィングは受動的な手法¹⁰で、ネットワーク通信を監視し、プロトコルをデコードし、ヘッダやペイロードを検査して関心のある情報を抽出する。レビュー手法としてだけでなく、ターゲット識別・分析手法（4.1節参照）として用いることもできる。主な目的は以下のとおり。

- ネットワークトラフィックのキャプチャとリプレイ
- 受動的なネットワーク探索（稼働中デバイスの特定など）
- OS、アプリ、サービス、プロトコルの特定（例：非暗号化 telnet、未承認の P2P など）
- 機密情報の**平文送信**など、未承認・不適切な活動の検出
- 平文のユーザ名・パスワードなどの情報収集

スニッフィングはシステムやネットワークへの影響が小さく、顕著な影響は帯域や計算資源の消費程度である。スニッファ（スニッフィングに用いるツール）は、ハブ、タップ、またはポートスパニング可能なスイッチなど、ネットワークに接続する手段を必要とする。ポートスパニングとは、他ポートで送受信されるトラフィックを、スニッファを接続したポートに複製する機能である。スニッファは環境内のさまざまな位置に配備でき、一般的には次のような場所がある。

- 境界：ネットワークの入出トラフィックを評価
- ファイアウォール背後：ルールセットが正確にトラフィックをフィルタしているかを評価
- IDS/IPS の背後：シグネチャが適切に発火し、適切に対応されているかを判定
- 重要システム／アプリの手前：当該アクティビティを評価
- 特定セグメント：暗号化プロトコルの検証

制約として**暗号化**の存在がある。攻撃者はしばしば暗号化を悪用して活動を隠蔽するため、評価者は通信の存在は見えても内容は見られない。また、スニッファは設置セグメントのトラフィックしか取得できないため、セグメント間の移設や複数台の配備、ポートスパニングの活用が必要となる。各セグメントで物理ポートを確保することが難しい場合もある。さらに、スニッフィングは取得トラフィックの解釈に相応の人手を要する活動である。

## 3.6 ファイル整合性チェック（File Integrity Checking）

ファイル整合性チェッカは、保護対象ファイルごとにチェックサムを計算・保存し、ファイルチェックサムのデータベースを構築することで、システムファイルの変更を特定する。後に再計算したチェックサムと保存値を比較することで、ファイルの改変を検出する。ファイル整合性チェック機能は、商用のホスト型 IDS に通常含まれているほか、スタンドアロンのユーティリティとしても入手可能である。

整合性チェッカはそれ自体に多大な人手を要しないが、**慎重な運用**が効果に直結する。最も効果的なのは、「安全と確認されたシステム」で作成した**基準（リファレンス）データベース**と比較する方法であり、基準側に改ざんファイルが混入していないことを担保できる。基準データベースはオフラインに保管し、攻撃者がシステム侵害後にデータベースを改ざんして痕跡を隠すことを防ぐべきである。加えて、パッチやその他の更新によりファイルは変更されるため、チェックサムデータベースは**最新状態**を維持しなければならない。

ファイル整合性チェックには、チェックサムデータベースの完全性を確保するため、SHA-1 などの**強力な暗号学的チェックサム**を用いるべきである。連邦機関は FIPS PUB 140-2（Security Requirements for Cryptographic Modules）¹¹ により、SHA（例：SHA-1、SHA-256）の使用が求められる。

## 3.7 まとめ

**表3-1**：レビュー手法の主要な機能（Section 3 で解説）

| 手法 | 主要な機能 |
|---|---|
| 文書レビュー（Documentation Review） | 方針・手順の技術的正確性と完全性を評価 |
| ログレビュー（Log Review） | システムの利用・構成・変更に関する過去情報を提供／潜在的問題や方針逸脱を明らかにし得る |
| ルールセットレビュー（Ruleset Review） | ルールベース防御における抜け穴を明らかにする |
| システム設定レビュー（System Configuration Review） | 構成強度を評価／ハードニング方針に沿った設定を検証 |
| ネットワークスニッフィング（Network Sniffing） | ローカルセグメントのトラフィックを監視し、稼働ホスト、OS、プロトコル、サービス、アプリなどを把握／通信の暗号化を検証 |
| ファイル整合性チェック（File Integrity Checking） | 重要ファイルの変更を特定／既知の攻撃ツールなど望ましくないファイルの一部も識別可能 |

各手法およびそれらの組み合わせにはリスクが伴う。安全かつ正確に実施するには、各評価者が一定の**基礎スキル**を備えている必要がある。**表3-2**は、Section 3 の各手法に必要な最低限のスキルセットの目安を示す。

**表3-2**：レビュー手法に必要な基礎スキルセット

| 手法 | 基礎スキルセット |
|---|---|
| 文書レビュー（Documentation Review） | 方針面からのセキュリティ一般知識 |
| ログレビュー（Log Review） | 各種ログ形式の知識、ログの解釈・分析能力、ログ分析・相関ツールの利用能力 |
| ルールセットレビュー（Ruleset Review） | ルールセットの形式・構造の知識、異種デバイスのルールを相関・分析する能力 |
| システム設定レビュー（System Configuration Review） | OS ハードニングや各種 OS のセキュリティ方針設定など、安全なシステム構成の知識、セキュリティ設定自動テストツールの利用能力 |
| ネットワークスニッフィング（Network Sniffing） | TCP/IP とネットワーキング一般知識、トラフィックの解釈・分析能力、スニッフィングツールの導入・運用能力 |
| ファイル整合性チェック（File Integrity Checking） | ファイルシステム一般知識、ファイル整合性チェックツールの利用と結果解釈の能力 |

---

⁶ 本書におけるレビューはアセスメントの観点に限定して論じる。運用上の監視・保守の一環として、運用問題・セキュリティ誤設定・悪意ある活動・その他のセキュリティ事象を特定するために、定期的レビューを実施すべきである。組織は運用レビューの所見をアセスメントに流用してもよい。  
⁷ 追加情報は *NIST SP 800-92, Guide to Security Log Management* を参照（http://csrc.nist.gov/publications/PubsSPs.html）。  
⁸ NIST は IT 製品向けセキュリティ設定チェックリストのリポジトリを維持している（http://checklists.nist.gov/）。  
⁹ SCAP の詳細は http://scap.nist.gov/ を参照。  
¹⁰ スニッファは収集トラフィックに対して DNS ルックアップを行う場合があり、その際はネットワークトラフィックを発生させる。秘匿性が必要な場合は DNS ルックアップを無効化すること。  
¹¹ FIPS PUB 140-2（http://csrc.nist.gov/publications/PubsFIPS.html）。

（2-2 ～ 2-5 / TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT）
# 4. 対象識別と分析手法（Target Identification and Analysis Techniques）

本節では、稼働中のデバイスとそれに関連するポートおよびサービスを特定し、潜在的な脆弱性について分析することに焦点を当てた**技術的な**対象識別および分析手法を扱う。評価者は、この情報を用いて脆弱性の存在を検証できるデバイスの探索を継続する。組織は、分析対象の資産を特定するにあたり、技術的手法に**加えて**または**代わりに**非技術的手法を用いることも多い。たとえば、既存の資産台帳や、ターゲットとすべき資産の一覧を保有している場合がある。別の例としては、評価者が施設をウォークスルーして、技術的手法の実施時に電源オフやネットワーク切断のために検出されなかったホストなど、技術的手法では見つからなかった資産を特定することが挙げられる。

アプリケーションセキュリティ検査に対する対象識別および分析手法については、附属書Cで簡潔に論じる。

## 4.1 ネットワーク探索（Network Discovery）

ネットワーク探索は、ネットワーク上で稼働し応答するホストを発見し、弱点を特定し、ネットワークの動作を把握するために、複数の手法を用いる。デバイス発見には、**受動的（examination）**および**能動的（testing）**手法が存在する。受動的手法では、ネットワークスニファを用いてネットワークトラフィックを監視し、稼働中ホストのIPアドレスを記録し、使用中ポートやネットワーク上で発見されたオペレーティングシステム（OS）を報告できる。受動探索は、ホスト間の関係—どのホスト同士が通信しているか、その頻度、やり取りされているトラフィックの種類—も特定でき、通常は内部ネットワーク上のホストから実施し、ホスト間通信を監視する。これは、**プロービング用のパケットを1つも送信することなく**行われる。受動探索は、能動探索よりも情報収集に時間がかかり、監視期間中に送受信を行わないホストは報告されない可能性がある。

能動的手法では、ICMP（Internet Control Message Protocol）pingなどの各種ネットワークパケットを、一般に自動化ツールを用いてネットワークホストへ送信し、応答を促す。たとえば**OSフィンガープリンティング**と呼ばれる活動では、通常／異常／不正なネットワークトラフィックを混在させて送信することで、対象システムのOSを推定する。別の活動として、一般的なポート番号にパケットを送って、ポートがアクティブであることを示す応答を生成させる。ツールは、こうした活動からの応答を解析し、特定のOSやネットワークサービス由来のパケットの既知の特性と照合—これによりホスト、稼働OS、ポート、および各ポートの状態を識別する。この情報は、ペネトレーションテスト対象の情報収集、トポロジマップの生成、ファイアウォールやIDS（侵入検知システム）の設定把握、システムやネットワーク設定の脆弱性発見などに活用できる。

ネットワーク探索ツールは、スキャンによって情報を取得する多様な方法を備える。エンタープライズのファイアウォールや侵入検知システムは、多くのスキャン（とくにSYN/FINスキャン、NULLスキャンのような**最も疑わしい**パケットを使うもの）を検知できる。ファイアウォールやIDSを経由して探索を行う計画を立てる評価者は、管理者の注意を引かずに結果を得られる可能性の高いスキャン種別を検討し、よりステルス性を高める方法（送信レートを落とす、複数の送信元IPアドレスから送る等）もあわせて検討すべきである。古いシステム、特にセキュリティが弱いことで知られるシステムに対して用いるスキャン種別の選定にも注意が必要である。スキャンによってシステム障害が引き起こされ得るためだ。通常、**通常の業務トラフィックに近いスキャンほど、運用上の問題を引き起こしにくい**。

ネットワーク探索は、ネットワーク上で動作する**不正（rogue）**または許可されていないデバイスを検出することもある。たとえば、限られたOSのみを使用する組織では、異なるOSを用いる不正デバイスを迅速に特定できる。**有線**の不正デバイスが特定されたら、既存のネットワーク図と収集済みのネットワーク活動情報を使って、そのデバイスが接続されているスイッチを特定できる。不正デバイスとの追加通信（例：ping）を生成して、該当スイッチを特定する必要がある場合もある。次のステップは、そのスイッチ上の該当ポートを特定し、物理的にそのポートから不正デバイスへ接続されたケーブルを追跡することである。

ネットワーク探索に使えるツールは多数存在し、多くの**能動探索ツール**は受動的なネットワークスニッフィングやポートスキャンにも利用できる。ほとんどのツールはGUI（グラフィカルユーザーインタフェース）を備え、CLI（コマンドラインインタフェース）を備えるものもある。CLIは、ツールが実行すべきテストを指定するコマンドやスイッチが多いため、GUIより習得に時間がかかることがある。また、オープンソースツールには、出力の容易なパースを可能にする多数のモジュールが用意されている。たとえば、ツールのXML（Extensible Markup Language）出力機能に、簡単なスクリプトとデータベースを組み合わせることで、ネットワーク上の未許可サービスや未許可マシンを監視できる、より強力な仕組みを作ることができる。多くのコマンドの役割や組み合わせ方の学習には、経験豊富なセキュリティエンジニアの助けが最適である。経験豊富なITプロフェッショナル（システム管理者やネットワークエンジニアなど）の多くは結果の解釈は可能だが、探索ツールそのものの操作はエンジニアが担当する方が効率的である。

受動探索に比べた能動探索の利点として、**異なるネットワークから評価を実施できる**こと、**情報収集に通常あまり時間を要しない**ことが挙げられる。受動探索では、すべてのホストを確実に捕捉するには、全ポイントにトラフィックが流れる必要があり、特に大規模エンタープライズネットワークでは時間がかかる。

一方、能動探索の欠点として、ネットワーク**ノイズ**を生成しがちで、ネットワーク遅延を招くことがある。能動探索は応答を得るためのクエリを送るため、この追加トラフィックが、特に高ボリュームで実施した場合、トラフィックの遅延や、構成の不備があるネットワークではパケットロスの原因となり得る。能動探索はまた、受動探索と異なり発信元を露呈するため、IDS（侵入検知システム）のアラートを引き起こす可能性がある。防御されたネットワークセグメントや境界セキュリティ機器・手法がある環境では、すべてのネットワークシステムを完全に発見する能力が影響を受け得る。たとえば、**NAT（Network Address Translation）**を使用する環境では、内部の私的アドレスが外部通信時に別の公的アドレスへ変換されるため、外部の観測点や保護されたセグメントから正確に探索できない可能性がある。ターゲットデバイス上のパーソナル／ホストベースのファイアウォールが探索トラフィックをブロックすることもある。デバイスからの活動を誘発しようとする結果として**誤情報**が得られることもあり得る。能動探索では、対象ネットワークの設定に関して**推論**を要する情報が提示される。

受動・能動のいずれの探索でも、得られる情報が**常に完全に正確**とは限らない。たとえば、能動探索では、**電源が入っていて接続されているホストのみ**が識別される—評価中にオフラインのシステムやセグメントがあると、発見の大きなギャップとなる可能性がある。受動探索は、探索期間中に送受信を行ったデバイスのみを発見するが、ネットワーク管理ソフトのような製品は**継続的な探索機能**を提供し、新規デバイスを検知した際にアラートを自動生成できる。継続的探索は、IPアドレス範囲をスキャンして新規アドレスを検知したり、新しいIPアドレス要求を監視できる。また、多くの探索ツールは、所定日数ごと・特定時刻など、**定期的な実行スケジュール**を組める。これは、散発的な実行よりも正確な結果をもたらす。

*4-1  
TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT*

（**注12**：無線の不正デバイスの所在特定については4.4節を参照）

*4-2  
TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT*

## 4.2 ネットワークポートとサービスの識別（Network Port and Service Identification）

ネットワークポートとサービスの識別は、ポートスキャナを用いて、稼働ホスト上で動作するネットワークポートとサービス（例：FTP、HTTP）を特定し、各サービスを提供するアプリケーション（例：HTTPならMicrosoft IISやApache）を特定する活動である。組織は、（ネットワーク探索など）他の手段で未実施の場合、ホスト特定のためにネットワークポートとサービスの識別を行い、潜在的に脆弱なサービスへフラグを立てるべきである。この情報は、ペネトレーションテストのターゲット決定に用いられる。

基本的なスキャナはすべて、稼働ホストと開放ポートを識別できるが、なかにはスキャン対象ホストに関する**追加情報**の提供が可能なものもある。開放ポートスキャン中に収集された情報は、**OSフィンガープリンティング**によるターゲットOS推定に役立つ。たとえば、TCP 135/139/445が開いているなら、おそらくWindowsホスト（もしくはSambaを動かすUnix）である。他にも、TCPシーケンス番号生成やパケット応答の特性などがOS特定の手がかりとなる。ただし、OSフィンガープリンティングは**万能ではない**。ファイアウォールが特定のポートやトラフィック種別をブロックする場合や、システム管理者がOSの正体を隠すために非標準的な応答を構成する場合があるためだ。

一部のスキャナは、**サービス識別（service identification）**により、特定ポート上で動作するアプリケーションを特定するのに役立つ。多くのスキャナは、一般的なポートと典型的な対応サービスを列挙する**servicesファイル**を利用する—たとえば、TCP 80が開いていれば、当該ホストでWebサーバがリスンしていると報告するかもしれない—が、これを確証するには追加ステップが必要である。いくつかのスキャナは、観測されたポートに対して通信を開始し、そのやり取りを解析して、一般的なサービスやその実装情報のリポジトリと照合することで、サービスを特定する。これらの手法は、**サービスアプリケーションとそのバージョン**（どのWebサーバソフトか等）の特定にも使われ、これは**バージョンスキャン（version scanning）**として知られる。よく知られたバージョンスキャンの一種である**バナーグラビング（banner grabbing）**は、接続開始時にリモートポートから送られるバナー情報を取得する。ここには、アプリケーション種別、アプリケーションバージョン、さらにはOS種別やバージョンが含まれることがある。もっとも、セキュリティを意識した管理者は、サービスの正体を隠す目的でバナー等を変更する可能性がある。それでも、単にservicesファイルに頼るより、バージョンスキャンははるかに正確である。

スキャナ製品は、そのドキュメントに記載の通り、各種スキャン方式をサポートし長所短所がある。たとえば、あるスキャナは**ファイアウォール越し**のスキャンが得意で、別のものは**ファイアウォール内側**でのスキャンに向く。使用するポートスキャナによって結果は異なる。単に各ポートについてopen/closedの簡素な応答のみを返すものもあれば、filtered/unfilteredのような追加情報を返し、評価者が次に有効なスキャン種別を判断するのに役立つものもある。

ネットワークポートとサービスの識別では、ネットワーク探索の**IPアドレス結果**を入力としてデバイスをスキャンすることが多い。ポートスキャンは、IPアドレスブロック全体に対して独立に実行することも可能で、その場合、稼働ホストを特定することで**ネットワーク探索を兼ねる**。ネットワーク探索とネットワークポート／サービス識別の結果は、ポートスキャンツールに応答したアドレス空間内の**すべての稼働デバイスの一覧**と、応答したポートである。ファイアウォールの背後や電源断などにより**応答しない**追加の稼働デバイスが存在しうる。評価者は、当該デバイス自体のスキャン、当該デバイスにアクセス可能なセグメント上にスキャナを配置、あるいは**別種のスキャン**（例：SYN/FIN、Xmasスキャン）を用いたファイアウォール回避の試行などによって、これらを探すことができる（**注13**：多くのファイアウォールは別種スキャンを識別・遮断可能であり、多くの環境で回避に使えない可能性がある）。

外部・内部スキャンを併用し、評価者が意図的に“**ブラインド**”でテストする場合は、**外部スキャンを先に**実施することが推奨される。この順序であれば、内部テストの前や実施中にログをレビュー・比較できる。外部スキャンの実施時には、ファイアウォール通過やIDS／IPS（侵入検知／防御システム）回避のために既存のステルス手法を用いることがある（**注14**：これはIDS/IPSのチューニングや構成改善にも有用）。パケットのフラグメンテーション、複製、オーバーラップ、順序入れ替え、タイミング制御などを用いて、**通常トラフィックに紛れる**ようパケットを変形するツールが推奨される。内部テストでは、外部に比べ**ブロックされにくいため**、一般に**攻撃的でない**スキャン手法が用いられる。内部で過度に攻撃的なスキャンを用いると、結果の改善なく運用中断リスクを大きく高める。カスタムパケットを用いたスキャンは、特定脆弱性のチェックに**高度にカスタマイズされた**パケットが必要となるため、内部テストでも有効である。パケットビルダ機能を持つツールは有用で、作成したパケットを結果収集用の別スキャンプログラムから送信できる。カスタムパケットは**DoS**（サービス拒否）を引き起こし得るため、この種のテストは夜間や週末など**低トラフィック**時に実施すべきである。

ポートスキャナは、稼働ホスト、OS、ポート、サービス、アプリケーションを識別できるが、**脆弱性そのもの**を識別するわけではない。安全でないプロトコル（例：TFTP、telnet）、マルウェア、未許可アプリケーション、脆弱なサービスの存在を確証するには、**追加調査**が必要である。脆弱なサービスの特定には、識別したサービスの**バージョン番号**を既知の脆弱バージョン一覧と比較する、あるいは4.3節で述べる**自動脆弱性スキャン**を行うなどの方法がある。ポートスキャナでは、スキャン処理は高度に自動化されているが、**結果の解釈は自動化されていない**。

ポートスキャンは、帯域消費やレスポンス低下を通じてネットワーク運用を阻害し得るが、ホストが**承認済みネットワークサービスのみ**を実行するよう適切に構成されていることを確認できる。運用への影響を最小化するため、スキャンソフトは慎重に選定すべきである。運用への影響を抑えるため、**営業時間外**に実施することも可能である。

## 4.3 脆弱性スキャン（Vulnerability Scanning）

脆弱性スキャンは、ネットワークポート／サービス識別と同様に、ホストおよびホスト属性（OS、アプリケーション、開放ポート等）を識別するが、**結果の人手解釈に頼るのではなく、脆弱性の特定**を試みる。多くの脆弱性スキャナは、ネットワーク探索やポート／サービス識別の結果を受け取って活用でき、脆弱性スキャンに必要な作業を削減する。また、ネットワーク探索やポート／サービス識別を**自前で**実施できるスキャナもある。脆弱性スキャンは、**旧バージョンのソフトウェア、未適用パッチ、誤設定**の特定や、組織のセキュリティポリシーへの準拠／逸脱の検証に役立つ。これは、ホスト上で動作するOSおよび主要アプリケーションを特定し、スキャナの**脆弱性データベース**に格納された既知脆弱性情報と照合することで行われる。

脆弱性スキャナは次のことができる：
- ホストアプリケーションの利用／セキュリティポリシーへの準拠状況の確認  
- ペネトレーションテスト対象の情報提供  
- 発見された脆弱性の緩和方法に関する情報提供

脆弱性スキャナは、ホストに対して**ローカル**または**ネットワーク越し**に実行できる。ネットワークベースの一部スキャナは、個々のホスト上で管理者レベルの認証情報を用いて、ホストから脆弱性情報を抽出できる。認証情報を持たないネットワークベースのスキャナは、ネットワーク探索でホストを見つけ、その後ホストをスキャンして脆弱性を検出する必要がある。この場合、ネットワークベースのスキャンは主に、**ネットワーク探索と開放ポート識別**を行い、多くの場合ターゲットシステムのOSには限定されない。認証情報を用いないネットワークベースのスキャンは、**内部・外部の両方**で実行できる—一般に内部スキャンの方が多くの脆弱性を明らかにするが、**両方の観点**からのテストが重要である。外部スキャンでは、境界セキュリティ機器がトラフィックを遮断するため、評価者は**通過を許可されたポート**に限ってスキャンできる。

外部スキャンを行う評価者は、ネットワーク探索と同様の課題（NATの使用、パーソナル／ホストベースファイアウォールの存在など）に直面する可能性がある。NATの課題を克服して成功裏にネットワークベースのスキャンを行うために、評価者はファイアウォール管理者に、ファイアウォールが対応している場合、特定のIPやアドレスグループに対して**ポートフォワーディング**を有効化するよう依頼できるし、NATを実施するデバイス**背後へのネットワークアクセス**を求めることもできる。また、評価者は、評価期間中、**テスト用IP**からのトラフィックを許可するよう、パーソナル／ホストベースファイアウォールを構成してもらうよう依頼できる。これらの措置は、ネットワークへの洞察を深める一方で、**外部攻撃者の能力を正確には反映しない**—ただし、悪意ある内部者、あるいは内部ネットワーク上の別ホストへアクセスした外部攻撃者の能力を、よりよく示す可能性がある。評価者は、個々のホストに対するスキャンも実施できる。

**ローカル脆弱性スキャン**では、スキャン対象ホストごとにスキャナをインストールする。これは主として、ホストOSやアプリケーションの**誤設定**や、ネットワーク経由／ローカル経由の**双方で悪用可能な脆弱性**の特定に用いられる。ローカルスキャンは、通常ホスト（ローカル）へのアクセスとroot／管理者アカウントを必要とするため、ネットワークベースより**高精度**で脆弱性を検出できる。誤設定の**修復機能**を備えるスキャナもある。

脆弱性スキャナは、組織の**表層的（surface）脆弱性**への曝露を定量化する、比較的迅速で容易な手段である。表層的脆弱性とは、他の脆弱性から独立して**単独で存在する**弱点のことである。スキャナが送信する攻撃パターンに対するシステムの挙動や出力を、既知脆弱性の**シグネチャ**に特徴的なものと照合し、一致があれば報告する。シグネチャベースに加え、一部スキャナは、露出した**悪用可能な**脆弱性を探るための偵察的攻撃パターンの**模擬**も試み、成功時に発見された脆弱性を報告する。

脆弱性の**リスクレベルの特定**には困難が伴う。脆弱性は単独で存在するとは限らないからである。たとえば、複数の低リスク脆弱性が**組み合わさると高リスク**となる場合がある。スキャナは、潜在的に無数にあり得る攻撃パターンの**組み合わせ**によってのみ顕在化する脆弱性を検出できない。ツールは、各脆弱性に低リスクとラベル付けする一方で、評価者に**偽の安心感**を与えうる。脆弱性を**集合として**より信頼性高く評価する方法は、5.2節で述べる**ペネトレーションテスト**である。

もう一つの問題は、スキャナが**独自のリスク分類**方法を使うことが多い点である。あるスキャナはlow/medium/highを使い、別のスキャナはinformational/low/medium/high/criticalを用いるなどで、スキャナ間の所見比較が難しい。また、スキャナが割り当てたリスクが、組織の実リスクを**反映しない**場合がある。たとえば、スキャナはパスワードを平文送信するFTPサーバを“中程度”と評価するかもしれないが、その組織が当該サーバを**匿名公開**のみで運用しパスワードを使っていないなら、実リスクは大幅に低い可能性がある。評価者は、スキャナのリスク評価を鵜呑みにせず、**適切なリスクレベル**を判断すべきである。

ネットワークベースの脆弱性スキャンには、重要な弱点がある。ネットワークスニッフィングや探索と同様、**稼働中のシステム**に対してのみ脆弱性を明らかにできる。これは一般に表層的脆弱性を対象とし、スキャンしたネットワークの**全体的なリスクレベル**を扱えない。処理自体は高度に自動化されているが、スキャナは**高い偽陽性率**（存在しない脆弱性を報告）を持ちうる。結果の解釈には、ネットワーキングとOSセキュリティに精通した人材が必要である。また、ホスト上の脆弱性をより確実に識別するため、ポートスキャン以上の情報を必要とするため、ネットワークベースの脆弱性スキャンは**より多くのトラフィック**を生成する傾向がある。これは、スキャン対象ホストやネットワーク、スキャントラフィックが通過するセグメントへ**負の影響**を及ぼし得る。多くのスキャナには、ネットワークベースの**DoSテスト**が含まれており、経験の浅い評価者の手にかかると、対象ホストへ顕著な悪影響を及ぼし得る。スキャナはしばしば、DoSテストを**一括抑制**でき、テストによる影響リスクを減らせる。

スキャナのもう一つの大きな制約は、ウイルススキャナやIDSと同様、**シグネチャのリポジトリ**に依存する点である。このため、評価者は最新の脆弱性を認識できるよう、**頻繁に更新**しなければならない。スキャナを実行する前に、評価者は**最新の脆弱性DB更新**を適用すべきである。スキャナのDB更新頻度は製品により異なり、**更新頻度**はスキャナ選定の重要な考慮事項となる。

多くの脆弱性スキャナは、**網羅性の異なる**複数レベルのスキャンを提供する。より**包括的**なスキャンは、より多くの脆弱性を検出し得るが、全体所要時間は長くなる。**簡易**スキャンは短時間だが、よく知られた脆弱性しか特定できない。一般に、リソースが許す限り、**徹底的な**脆弱性スキャンを推奨する。

脆弱性スキャンは、結果の解釈に**高い人手関与**を要する、やや労力集約的な活動である。帯域占有やレスポンス低下を通じて、ネットワーク運用を**阻害**する可能性もある。それでも、脆弱性が**発見・悪用**される前に緩和を確実化するうえで、脆弱性スキャンは**極めて重要**である。

あらゆる**パターン照合／シグネチャベース**のツールと同様、**アプリケーション脆弱性スキャナ**は一般に**偽陽性率が高い**。評価者は、偽陽性・偽陰性を最小化するよう**構成と較正**を行い、結果を**有意味に解釈**して実脆弱性を特定すべきである。スキャナは他のシグネチャベースツール同様、**偽陰性率**の課題も抱える—だが、自動スキャナで見逃された脆弱性も、**複数スキャナの併用**や**追加のテスト形態**で捕捉できる可能性がある。複数スキャナの使用は一般的な慣行であり、結果を相互比較する手段を提供する。

## 4.4 無線スキャン（Wireless Scanning）

無線技術は本質的に、ネットワークケーブルや周辺機器ケーブルなどの**物理的接続なしに**、複数デバイス間の通信を可能にする。単純な無線キーボードやマウスから、携帯電話網、エンタープライズ無線LAN（WLAN）まで多岐にわたる。無線対応デバイスの数と普及が増え続ける中、組織はエンタープライズ無線環境を**積極的にテストし、保護**することが重要である（**注15**）。無線スキャンは、無線対応技術に起因するリスクを緩和するための**是正措置**の決定に役立つ。

無線セキュリティの技術的評価を計画する際には、組織環境の以下の要因を考慮すべきである：
- スキャン対象施設の**位置**：建物が公共エリア（道路や公共スペース）に近接している、あるいは人の多い都市部にある場合、無線脅威のリスクが増す  
- 無線技術で送信されるデータの**セキュリティレベル**  
- 無線デバイスの**接続／切断の頻度**、典型的な**トラフィックレベル**（断続的か、ほぼ常時か）：無線スキャンでは**アクティブ**な無線デバイスのみが検出可能なため  
- 既存の**WIDPS**（Wireless Intrusion Detection and Prevention Systems、無線侵入検知／防御）（**注16**）：これらが、テストで収集される情報の多くをすでに収集している可能性がある

無線スキャンは、**無線アナライザ**ソフトをインストールし構成した**モバイルデバイス**（ラップトップ、ハンドヘルド、専用機器など）を用いて実施すべきである。スキャンソフト／ツールは、特定のスキャン用にデバイスを構成でき、**受動・能動の両モード**でスキャンできる必要がある。また、組織の無線セキュリティ**構成要件からの逸脱**を識別できるよう、オペレータが設定可能であるべきである。

無線スキャンツールは、IEEE 802.11 a/b/g/nの**すべてのチャネル**（国内・国際）をスキャンできるべきである。場合によっては、**外部アンテナ**を装着してRF（無線周波数）受信能力を追加する必要がある。他の無線技術（Bluetoothなど）への対応は、追加の無線脅威や脆弱性の把握に役立つ。標準外の技術や、スキャンツールのRFレンジ外の周波数を用いるデバイスは、検出または正しく認識されない点に注意が必要である。**RFスペクトラムアナライザ**のようなツールは、スペクトラムアナライザの周波数範囲内で発生する送信を識別するのに役立つ。スペクトラムアナライザは一般に広い周波数範囲（例：3〜18GHz）を解析し、トラフィックの内容は解析しないものの、特定の周波数帯での無線活動を把握し、それに応じて**追加のテストや検査**を調整できる。

一部デバイスは、地図ツールを用いた**マッピング／位置プロット**や、**GPS**ベースのマッピングに対応する（GPSは屋内での能力が限定的である点に注意）。無線スキャンツールの運用は、特にIEEE 802.11 a/b/g/n技術に関する**強い理解**を持つ人材が担当すべきである。オペレータはツールやソフトの機能・能力について訓練され、**取得情報の理解**や**潜在的脅威／悪意ある活動の識別**に長けているべきである。類似スキルを持つ人材を、無線スキャンで得られた**データと結果の分析**に従事させるべきである。ツールオペレータは、スキャン対象地域で**使用が許可された他のRF信号**についても把握しておく必要がある。

（**注15**：IEEE 802.11ベースWLANの適切なセキュリティ対策は、NIST SP 800-97「Establishing Wireless Robust Security Networks: A Guide to IEEE 802.11i」およびNIST SP 800-48 Rev.1「Guide to Securing Legacy IEEE 802.11 Wireless Networks」を参照。http://csrc.nist.gov/publications/PubsSPs.html）  
（**注16**：詳細はNIST SP 800-94「Guide to Intrusion Detection and Prevention Systems (IDPS)」を参照。http://csrc.nist.gov/publications/PubsSPs.html）

### 4.4.1 受動的無線スキャン（Passive Wireless Scanning）

受動スキャンは、既存のWIDPSなどの無線セキュリティ対策を**補完**するため、**定期的に**実施すべきである（**注17**）。完全に受動的なスキャンを行うツールは、**いかなるデータも送信せず**、展開済み無線デバイスの動作に影響を与えない。データを送信しないため、受動スキャンツールは悪意あるユーザや他デバイスから**検知されず**、未許可無線デバイスの使用者が**検出回避**のために切断／無効化する可能性を低下させる。受動スキャンツールは、ツールのアンテナ範囲内で送信される無線トラフィックを**捕捉**する。多くのツールは、検出した無線デバイスに関して、**SSID**、デバイス種別、チャネル、**MACアドレス**、**信号強度**、送受信パケット数などのキー属性を提供する。これらの情報は、無線環境のセキュリティ評価や、範囲内で発見した潜在的な**不正デバイス**や**未許可のアドホックネットワーク**の特定に利用できる。無線スキャンツールはまた、取得パケットを評価して、**運用上の異常**や**脅威**の存在を判定できるべきである。

無線スキャンツールは、IEEE 802.11 a/b/g/nの各チャネル／周波数を**個別に**スキャンし、各チャネルを**数百ミリ秒**程度だけスキャンすることが多い。受動スキャンツールは、特定チャネルの**すべての送信**を受信できるとは限らない。たとえば、ツールがチャネル1をスキャンしていた**まさにその瞬間**に、無線デバイスがチャネル5でパケットを送信した場合などである。したがって、ツールの**滞在時間（dwell time）**は、パケットを捕捉できるだけ長く、各チャネルを効率的にスキャンできるだけ短く設定することが重要である。最適な滞在時間は、使用デバイス／ツールに依存する。さらに、スキャン担当者は、検出漏れデバイスを減らすため、**ゆっくりと移動**しながらスキャンを行うべきである。

受動スキャンでは、以下のようにして**不正デバイス**を特定できる：
- 検出した無線デバイスの**MACアドレス**から、無線インタフェースの**ベンダ**を判別できる。もし組織がベンダAとBの無線インタフェースしか展開していないのに、他ベンダのインタフェースが見つかれば、不正デバイスの可能性がある。  
- 組織が展開済み無線デバイスの**正確な台帳**を持っているなら、検出デバイスのMACアドレスと承認済みデバイスのMACリストを照合できる。多くのスキャンツールは承認済みデバイスのリスト入力をサポートする。MACは**なりすまし**可能であるため、検出デバイスのMACを鵜呑みにすべきではないが、**なりすましを行っていない**不正デバイスの特定には有効である。  
- 不正デバイスは、組織が**承認していないSSID**を用いる場合がある。  
- 一部の不正デバイスは、組織が承認したSSIDを用いつつも、**無線セキュリティ構成要件**に準拠しない場合がある。

潜在的不正デバイスの**信号強度**を確認し、当該デバイスが施設内またはスキャン対象エリア内にあるかどうかを判断すべきである。**施設外**で動作するデバイスも、組織のデバイスが**誤って関連付ける**可能性があるため、重大なリスクとなり得る。

（**注17**：一部環境では、WIDPS実装が受動無線スキャンと**ほぼ同一**の機能を既に提供している可能性がある。モバイルセンサを備えるWIDPS製品もあり、これは4.4節で述べた無線スキャンデバイス構成に類似する。WIDPSを導入している組織は、本書で述べた無線スキャン手法を、WIDPS機能の**重複ではなく補完**として用いるべきである。）

### 4.4.2 能動的無線スキャン（Active Wireless Scanning）

組織は、受動無線スキャンから一歩進めて、**能動スキャン**を実施できる。これは受動スキャンで収集した情報を基に、検出デバイスへの**接続を試み**、**ペネトレーション**や**脆弱性関連**のテストを実施する。たとえば、組織は、自組織の**承認済み無線デバイス**を対象に、認証方式、データ暗号化、管理アクセスなどの**無線セキュリティ構成要件**を満たしているかを確認するため、能動スキャンを実施できる（他の手段で情報が得られない場合）。

能動スキャンの実施に当たっては、**近隣組織**が所有・運用するデバイスを誤ってスキャンしないよう、細心の注意が必要である。能動スキャンの前に、デバイスの**物理的位置**を評価することが重要である。組織施設内で動作しているように見える不正デバイスの能動スキャンにも注意が必要だ。そうしたデバイスは、**来訪者**の端末で誤って無線が有効になっているだけかもしれず、あるいは**隣接組織**のデバイスが施設近傍にあるだけかもしれない。一般に、組織は、こうしたデバイスに対する能動スキャンを行うよりも、**特定と所在の把握**に注力すべきである。

組織は、自組織の無線デバイスを対象とした**ペネトレーションテスト**の際に、能動スキャンを用いることがある。スクリプト化された攻撃や各種機能を備え、実装されたセキュリティ対策の迂回を試み、デバイスのセキュリティレベルを評価するツールが利用可能である。たとえば、無線ペネトレーションツールは、さまざまな方法でAP（アクセスポイント）への接続を試み、セキュリティ構成の**迂回**を狙う。もしAPへのアクセスに成功した場合、当該APが接続する**有線ネットワーク**や**無線デバイス**についての情報を取得できる。能動ツールの中には、無線クライアントデバイス上で発見される脆弱性の識別や、4節で述べた**有線ネットワークの脆弱性テスト**を行うものもある。

能動スキャンの実施中は、組織のWIDPSを**監視**し、その能力とパフォーマンスを評価できる。評価目標に応じて、評価者は、**アラームやアラート**が発生する可能性に備え、WIDPS管理者や無線ネットワーク管理者へスキャン実施予定を**事前連絡**する必要がある。また、一部のWIDPSは、特定デバイス（スキャン実施に用いるデバイス等）によるアラーム／アラートを**無視する設定**が可能である。

未許可デバイスや**誤設定**の無線デバイスの特定には、有線ネットワーク上の未許可デバイスや脆弱性の特定に用いるツールやプロセスも**有効**である。有線側スキャンは、**不正無線デバイスの検出・所在特定**に役立つ。他のセクション（3.5、4.1）で有線スキャンについても述べている。

### 4.4.3 無線デバイスの位置追跡（Wireless Device Location Tracking）

無線スキャンツールのオペレータは、**疑わしいデバイスの所在**特定を試みるべきである。RF信号の伝播は環境に依存するため、オペレータは、無線技術がこのプロセスをどのように支援するかを理解しておくことが重要である。マッピング能力は有用だが、位置特定の主たる鍵は、**知識のあるオペレータ**と**適切な無線アンテナ**である。

不正デバイスがスキャン中に**発見され、物理的に所在特定**された場合、セキュリティ担当者は、当該デバイスの扱いに関する**特定のポリシーとプロセス**（電源遮断、組織ポリシーへの準拠へ向けた再設定、完全な撤去等）に従うことを確実にすべきである。撤去する場合は、押収前に不正デバイスの**活動状況**を評価すべきである。これは、送信の監視やデバイスへのアクセス試行によって行い得る。

スキャン中に発見した無線デバイスの所在特定ができなかった場合、セキュリティ担当者は**WIDPS**を用いて所在特定を支援させるべきである。これは、スキャン中に検出した**特定のMACアドレス**の所在特定をWIDPSに依頼することを意味する。適切に展開されたWIDPSは、複数のWIDPSセンサを用いることで所在特定の**粒度**を高め、セキュリティ担当者の所在特定を支援できる。WIDPSが示せるのは数フィート（数メートル）程度の範囲であることが多いため、最終的な**ピンポイント**には、無線スキャンツールが依然として必要になる場合がある。

### 4.4.4 Bluetoothスキャン

Bluetoothセキュリティ要件への**準拠状況**を確認したい組織は、Bluetooth対応無線デバイスの**受動スキャン**を実施し、潜在的な存在と活動を評価すべきである。Bluetoothは非常に**短距離**（平均約9m/30フィート、一部は1m/3フィート）であるため、スキャンは**困難かつ時間がかかる**可能性がある。評価者は、この**到達距離の制約**を、スコーピング時に考慮すべきである。組織は、**一般公開エリアからアクセス可能**な施設内領域のみをスキャンし、攻撃者がBluetooth経由でアクセス可能かを確認する、あるいは施設全体ではなく**サンプリング**で物理的ロケーションを選んでスキャンする、という選択をとり得る。携帯電話やPDAなど、Bluetooth対応デバイスの多くは**モバイル**であるため、受動スキャンは**一定期間に複数回**行う必要があるかもしれない。組織は、展開したBluetoothの**インフラ（アクセスポイント等）**についてもスキャンすべきである。**不正アクセスポイント**を発見した場合は、確立済みのポリシーとプロセスに従って対処すべきである。

検出したBluetoothデバイスのセキュリティと動作を**能動的にテスト**するためのツールも多数存在する。これらツールは、発見したデバイスへの接続を試み、**密かにアクセスと接続**を得ようとする攻撃を実行する。多くの環境で**個人のBluetoothデバイス**が存在するため、能動スキャンは**極めて慎重**に行うべきである。一般則として、評価者は、スキャン対象デバイスが**組織所有**であると確信できる場合に限り、能動スキャンを行うべきである。能動スキャンは、Bluetoothデバイスが動作する**セキュリティモード**や、Bluetoothの**PIN（パスワード識別番号）**の強度を評価するために用いられる。また、これらデバイスの**送信出力**が可能な限り低く設定され、到達距離が最小化されていることの検証にも役立つ。IEEE 802.11 a/b/gの不正デバイスと同様、**不正Bluetoothデバイス**への対応は、ポリシーとガイダンスに従って行うべきである。

### 4.5 まとめ（Summary）

**表4-1**は、4章で論じた対象識別と分析手法の主要機能をまとめたものである。

#### 表4-1. 対象識別と分析手法のまとめ

| 手法 | 機能 |
| --- | --- |
| ネットワーク探索（Network Discovery） | • 稼働デバイスを発見<br>• 通信経路を特定し、ネットワークアーキテクチャの把握を容易にする |
| ネットワークポート／サービス識別（Network Port and Service Identification） | • 稼働デバイスを発見<br>• 開放ポートと関連サービス／アプリケーションを発見 |
| 脆弱性スキャン（Vulnerability Scanning） | • ホストと開放ポートを識別<br>• 既知の脆弱性を識別（注：**偽陽性率が高い**）<br>• 発見された脆弱性の緩和策に関する助言を提供することが多い |
| 無線スキャン（Wireless Scanning） | • スキャナの到達範囲内にある**未許可無線デバイス**を特定<br>• 組織の境界外からの無線信号を検出<br>• 潜在的な**バックドア**その他のセキュリティ違反を検出 |

各手法やその組み合わせには**リスク**が伴う。**安全かつ正確**に実施するには、評価者は一定の**ベースラインスキルセット**を備えるべきである。**表4-2**に、4章で提示した各手法に必要な最低限のスキルセットのガイドラインを示す。

#### 表4-2. 対象識別と分析手法におけるベースラインスキルセット

| 手法 | ベースラインスキルセット |
| --- | --- |
| ネットワーク探索（Network Discovery） | 一般的なTCP/IPとネットワーキングの知識；受動・能動の両方のネットワーク探索ツールの使用能力 |
| ネットワークポート／サービス識別（Network Port and Service Identification） | 一般的なTCP/IPとネットワーキングの知識；各種OSにおけるポートとプロトコルの知識；ポートスキャンツールの使用能力；ツール出力の解釈能力 |
| 脆弱性スキャン（Vulnerability Scanning） | 一般的なTCP/IPとネットワーキングの知識；各種OSにおけるポート、プロトコル、サービス、脆弱性の知識；**自動脆弱性スキャンツールの使用**および**結果の解釈／分析**能力 |
| 無線スキャン（Wireless Scanning） | コンピューティングと**無線送信**に関する一般知識に加え、無線プロトコル、サービス、アーキテクチャの**特定知識**；**無線スキャン**および**スニッフィング**ツールを用いた自動化スキャンの実行能力 |

*4-10  
TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT*

# 5. 対象脆弱性の検証手法（Target Vulnerability Validation Techniques）

本章では、前章で得られた対象識別・分析情報を活用し、**潜在的脆弱性の存在をさらに調査・実証**する技術的手法を扱う。目的は、**脆弱性の実在を証明**し、それが悪用された場合の**セキュリティ上の影響**を示すことである。  
これらの手法は評価の中で最もリスクが高く、他の手法よりも対象システムやネットワークに影響を及ぼす可能性が大きい。  
アプリケーションセキュリティ検査における対象脆弱性検証手法については附属書Cで簡単に述べる。

---

## 5.1 パスワードクラッキング（Password Cracking）

ユーザがパスワードを入力すると、そのパスワードの**ハッシュ値**が生成され、保存済みハッシュ値と比較される。両者が一致すれば認証成功となる。  
**パスワードクラッキング**とは、コンピュータシステム内またはネットワーク上で送信された**ハッシュから元のパスワードを復元**する手法であり、主に**弱いパスワードの検出**を目的に行われる。

クラッキング対象のハッシュは、ネットワーク上を流れる際にスニファで傍受されるか、対象システムから直接取得される（後者には管理者権限や物理アクセスが必要な場合が多い）。取得後は、自動化ツールがハッシュを高速に生成・比較し、一致するまで試行を繰り返す。

代表的な攻撃手法は以下のとおり：

- **辞書攻撃（Dictionary Attack）**  
  事前に用意した辞書ファイルの単語を使ってハッシュを生成・照合する。多言語辞書や人名・番組名など、広範な辞書がインターネットで公開されている。

- **ハイブリッド攻撃（Hybrid Attack）**  
  辞書攻撃を拡張し、単語に数字や記号を付加して試行する。  
  例）`p@ssword`、`h4ckme`、`password99`、`password$%`など。

- **総当たり攻撃（Brute Force Attack）**  
  一定長までの**すべての可能な文字列**を生成して照合する。理論的にはすべてのパスワードを解読可能だが、膨大な時間と計算資源を要する。複数マシンを分散利用することで時間短縮が可能。

- **レインボーテーブル攻撃（Rainbow Table Attack）**  
  事前計算したパスワードハッシュの**照合表**を利用する。文字セットと長さを限定して作成されるが、**ソルト（salt）**が使用されると無効化される。ソルトはパスワードハッシュにランダム要素を加える手法で、同一パスワードでも異なるハッシュ値を生成するためである。

パスワードクラッキングは、**パスワードポリシーの有効性検証**にも利用できる。例えば、パスワード有効期限に合わせて定期的に実施することで、運用ポリシー遵守を確認できる。  
特にオフラインでのクラッキングは**システムやネットワークへの影響が少ない**ため、組織のセキュリティ検証において有用である。

---

## 5.2 ペネトレーションテスト（Penetration Testing）

ペネトレーションテストとは、**実際の攻撃者を模倣**して、アプリケーション・システム・ネットワークのセキュリティ機能を迂回する手法を特定するセキュリティテストである。  
攻撃者が一般的に使用する**ツールや技術を実際に用いる**ことが特徴である。

テストでは、複数の脆弱性を組み合わせて**単一脆弱性では到達できないアクセス権限**を得ることを試みる。  
ペネトレーションテストは次の点の把握に有用である：

- 実環境レベルの攻撃に対してシステムがどの程度耐性を持つか  
- 攻撃を成功させるのに必要な攻撃者の技術水準  
- リスク軽減に有効な追加対策  
- 防御側の**検知・対応能力**の評価

ペネトレーションテストは非常に価値が高い一方で、**高いリスクと専門性**を伴う。実際のシステムを破壊・停止させる恐れがあり、慎重な**計画・承認・通知**が必要である。  
熟練したテスターでもリスクを完全に除去することはできない。

また、物理的手段や**ソーシャルエンジニアリング**を含む非技術的攻撃も行われる場合がある。例として：
- 物理的セキュリティの突破（ネットワーク接続や機器盗難、キーロガー設置など）
- ソーシャルエンジニアリング（例：ヘルプデスクを装ってパスワードを聞き出す）

---

### 5.2.1 ペネトレーションテストのフェーズ（Penetration Testing Phases）

ペネトレーションテストは、**4つのフェーズ**に分けられる。

1. **計画（Planning）**  
   - テスト範囲、ルール、承認、目標を定義する段階。  
   - 実際のテストはまだ行わない。

2. **探索（Discovery）**  
   - 情報収集とスキャンを行う段階。  
   - 4.2節で述べたポート／サービス識別を活用し、ターゲットを特定。  
   - DNS照会、WHOIS、ネットワークスニッフィング、社員情報の収集（WebやLDAP）、NetBIOS/NIS列挙、バナーグラビングなどを行う。  
   - ゴミ箱漁りや現地観察などの物理的手法で補足情報を得ることもある。

   - 次に行う**脆弱性分析**では、発見したサービスやアプリケーション、OSを脆弱性データベース（例：NVD）と照合する。自動スキャナによる分析と、人手による新規／未知脆弱性の発見を組み合わせる。

3. **攻撃（Attack）**  
   - 発見済み脆弱性を**実際に悪用して検証**する段階。  
   - 成功すれば脆弱性の存在が確認され、対応策を提示する。  
   - 一部の攻撃は完全な侵入ではなく、追加情報の収集や状態変化の観測を目的とする。  
   - 攻撃成功後は、権限昇格や追加リソースへのアクセスを試み、ネットワーク全体のリスクを評価する。  
   - 攻撃が失敗した場合は他の脆弱性を試す。  

   攻撃に利用される典型的な脆弱性カテゴリー：
   - **設定ミス（Misconfiguration）**：デフォルト設定や誤設定  
   - **カーネル欠陥（Kernel Flaw）**：OS中核の欠陥による完全侵害  
   - **バッファオーバーフロー（Buffer Overflow）**：入力長の検証不足による任意コード実行  
   - **入力検証不備（Insufficient Input Validation）**：SQLインジェクションなど  
   - **シンボリックリンク攻撃（Symbolic Link）**：特権プログラムを誤誘導して重要ファイル操作  
   - **ファイルディスクリプタ攻撃（File Descriptor Attack）**：不適切なファイルハンドル割り当てによる漏洩  
   - **レースコンディション（Race Condition）**：特権状態の一時的な利用  
   - **ファイル／ディレクトリ権限不備**：不適切なアクセス権設定による読み書き・改ざん

4. **報告（Reporting）**  
   - すべての段階と並行して実施。  
   - 計画段階ではROE（Rules of Engagement）を策定し、探索・攻撃段階ではログを記録、定期報告を行う。  
   - テスト終了時には、発見脆弱性、リスク評価、推奨対策を含む最終報告書を作成する。  

（報告とテスト後の活動については8章を参照）

---

### 5.2.2 ペネトレーションテストの実施運用（Penetration Testing Logistics）

テストシナリオは、アプリケーション・システム・ネットワークの**設計・実装上の欠陥**を特定するよう設計する。  
「最も起こりやすい攻撃」だけでなく、「最悪の攻撃」（例：管理者による悪意ある操作）も含める。  
内部攻撃と外部攻撃の両方を考慮し、通常は**外部テストを先に実施**する。

- **外部シナリオ（Outsider Scenario）**  
  攻撃者は対象に関する知識が乏しく、公開情報のみを基に行動する。  
  WHOIS・Web・掲示板等の**オープンソース情報収集**を行い、ポートスキャン／脆弱性スキャンでホストを特定。  
  ファイアウォールを経由するため、取得情報は限定的。  
  外部から到達可能なホストを侵害し、それを足掛かりに内部ホストへの侵入を試みる。

- **内部シナリオ（Insider Scenario）**  
  内部ネットワーク上（ファイアウォール内側）から実施。  
  一般社員、または管理者レベルのアクセスを想定し、権限昇格を試みる。

ペネトレーションテストは、組織のネットワークの脆弱性と、侵害時の損害規模を評価するうえで不可欠である。  
ただし、組織ポリシーにより**使用ツールや実施時間帯が制限**される場合がある。  
本番環境に対する実攻撃を伴うため、**高リスク**であり、**年1回程度**の実施で十分な場合もある。  
テストは、**破壊直前で停止**する設計も可能である。  
結果は経営層へ報告し、発見脆弱性の**早急な是正**を行うべきである。  
軽量なスキャンや診断を定期的に行い、年数回のペネトレーションテストを組み合わせることで、持続的なセキュリティ維持が可能となる。

---

## 5.3 ソーシャルエンジニアリング（Social Engineering）

ソーシャルエンジニアリングとは、人を**欺いて機密情報（例：パスワード）を引き出す**手法である。  
ユーザの**セキュリティ意識と行動**をテストする目的で行われ、手順遵守や教育効果の検証にも利用される。

代表的手法：
- **アナログ手法**：対面・電話による会話
- **デジタル手法**：メールやメッセージによる誘導

代表例として**フィッシング（Phishing）**があり、正規サイトを装ったメールでクレジットカード番号や認証情報を盗む。  
その他、ワームを模した添付ファイル送信なども含まれる。

ソーシャルエンジニアリングは、**特定個人や役職層（例：経営層）**を狙う場合や、**広範な対象**を狙う場合がある。  
特定個人への攻撃は公的情報（役職・興味など）を基に実施されることが多い。  
成功すると個人の**名誉や信頼**に影響を及ぼすため、結果は**個人攻撃ではなく教育改善**に利用すべきである。

テスト後は、成功／失敗を含む戦術の詳細を記した報告書を作成し、**セキュリティ教育プログラムの改善**に役立てる。

---

## 5.4 まとめ（Summary）

以下の表は、本章で説明した主な検証手法の比較である。

#### 表5-1. 対象脆弱性検証手法の比較

| 手法 | 機能 |
| --- | --- |
| パスワードクラッキング（Password Cracking） | • 弱いパスワードおよび不適切なパスワードポリシーの特定 |
| ペネトレーションテスト（Penetration Testing） | • 攻撃者と同様の手法・ツールによる実証的検証<br>• 脆弱性の存在を確認<br>• 複数脆弱性を連鎖的に悪用してより高い権限を獲得する手法の実証 |
| ソーシャルエンジニアリング（Social Engineering） | • 手順および人的要素（ユーザ意識）の検証を可能にする |

すべての手法およびその組み合わせには**リスク**が伴う。安全かつ正確な実施のためには、テスターは一定の**基礎スキルセット**を有している必要がある。

### 表5-2. セキュリティテストに必要な知識・技能・能力

| 手法 | ベースラインスキルセット |
| --- | --- |
| パスワードクラッキング（Password Cracking） | OSにおける安全なパスワード構成・保存方式の知識；自動クラッキングツールの使用能力 |
| ペネトレーションテスト（Penetration Testing） | 高度なTCP/IP・ネットワーク・OSの知識；脆弱性・エクスプロイトに関する深い理解；検知回避技術の知識 |
| ソーシャルエンジニアリング（Social Engineering） | 人を説得・誘導する能力；圧力下でも冷静さを保つ能力 |

*5-6  
TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT*
# 第6章 セキュリティ評価の計画

効果的なセキュリティ評価を行うには、綿密な計画が不可欠である。本章では、評価ポリシーの策定、評価の優先順位付けとスケジューリング、適切な評価手法の選定、実施に関するロジスティクス（実務調整）を含めた計画立案の方法を示す。また、評価計画書の作成に関する推奨事項と、評価に関わる法的考慮点についても解説する。

---

## 6.1 セキュリティ評価ポリシーの策定

組織は、情報セキュリティ評価ポリシーを策定し、評価実施の方向性とガイドラインを定義する必要がある。ポリシーには以下を含めるべきである：

- 評価が遵守すべき組織要件  
- 評価を承認・実施する責任者の役割と責任  
- 標準化された方法論の遵守  
- 評価の実施頻度  
- 評価計画および結果の文書化要件  

策定後は、CIO・CISO・CTOなどの関連部署へ共有し、外部委託先にも伝達する。少なくとも年1回、または新たな要件発生時にレビューし、適用性や改善点を見直すことが望ましい。

---

## 6.2 評価の優先順位付けとスケジューリング

組織は、どのシステムをどの頻度で技術的評価対象とするかを決定する必要がある。優先度は、以下を基準に決定する：

- システムの影響度（低・中・高）  
- 最後に実施した評価時期  
- 法令や規制要件による頻度指定  
- リソースの可用性  

たとえば、高影響システムが優先されるのが原則だが、評価時期が超過している中影響システムを先に評価する場合もある。  
技術的観点では、脆弱性修正後や大規模アップデート完了後に評価を行うなど、目的に応じたタイミング調整が重要である。

継続的モニタリングの一環として、NIST SP 800-53 に定義される一部のセキュリティコントロールは定期的なテストが求められる。  
また、リソースが不足する場合は評価範囲の縮小（サンプリング、特定領域のみなど）を検討する。

---

## 6.3 技術手法の選定とカスタマイズ

評価手法を選定する際は、目的（例：規制遵守確認、認証・認可のための評価、侵入テストによる脆弱性検証など）を明確にした上で、以下を検討する：

- 使用する手法の分類（文書レビュー、ターゲット識別・分析、脆弱性検証）  
- 内部／外部・公開／非公開などの視点設定  
- リスク・コスト・時間・スキル要件  

侵入テストのような手法は、システム可用性の低下やデータ漏洩を引き起こす可能性があるため、非本番環境での実施や時間帯の制限を設けることが推奨される。

### 例：複数手法の組み合わせ
1. **ドキュメントレビュー** — 方針や設計上の不備を把握  
2. **構成レビュー** — 設定の逸脱を確認  
3. **ワイヤレススキャン** — 不正APの検出  
4. **脆弱性スキャン** — 既知脆弱性を識別  
5. **侵入テスト＋ソーシャルエンジニアリング** — 実際の攻撃可能性を検証  

---

## 6.4 ロジスティクス（実務調整）

### 6.4.1 評価者（アセッサ）の選定とスキル

評価者は十分な知識・経験を持ち、かつ組織の機密情報にアクセスする責任を負う。  
選定時には以下を考慮する：

- TCP/IP、OS、ネットワーク脆弱性、侵入テクニックの深い理解  
- 実務経験（訓練よりも現場経験を重視）  
- 技術文書作成能力（非技術層への報告も想定）  
- チーム構成のバランス（境界防御・アプリ・SCADA専門家など）  

外部委託時は、秘密保持契約（NDA）や損害責任条項を明確化し、データの取り扱い要件を契約書で定義する。

### 6.4.2 実施場所の選定

テスト環境は手法によって異なる：

- **オンサイト**：文書レビュー、構成確認など。  
- **オフサイト**：外部攻撃模倣やステルス型テストに適する。  
- **リモートアクセス**：VPN接続や信頼できるテストラボからの実施。  

外部ネットワーク経由のテストでは、IDS/IPS がテストトラフィックを誤検知する可能性があるため、通信経路や権限設定を事前に調整する。

### 6.4.3 ツールとリソースの選定

テスト環境は目的に応じた構成を取る。  
代表的な構成と注意点：

- **ハードウェア要件**：高いCPU・メモリ（特にパスワードクラック用途）  
- **仮想化（VM）**：複数OSやツールの同時利用、スナップショット復元が容易  
- **ベースラインイメージ**：標準化した環境を迅速に展開可能  
- **ツール管理**：商用・OSS・自社製ツールを含め、信頼できる配布元から入手  
- **アップデート**：テスト前に脆弱性DBやツールの最新化を確認  

出張チームは、ノートPC・ケーブル・ライブCDなどを含む「フライアウェイキット」を持参する。

---

## 6.5 評価計画書の作成

評価計画書は、活動の範囲・ルール・責任を明確化し、リスクを軽減するための公式文書である。  
計画書には以下を含める：

- **評価対象と範囲**（含まれないシステムの明示）  
- **実施者と権限**（承認されたアセッサの一覧）  
- **テスト詳細**（使用手法・ツール・制限事項）  
- **スケジュールと連絡体制**（緊急連絡先、稼働時間）  
- **データの取り扱い**（保存・暗号化・削除ポリシー）  
- **インシデント対応方針**（テスト中に問題が発生した場合の手順）  

侵入テストなど一部のケースでは、**ROE（Rules of Engagement）** として同内容を別文書にまとめることもある。付録BにはROEテンプレートの例が示されている。

---

## 6.6 法的考慮事項

法的リスクを未然に防ぐため、特に侵入テストなどの侵入的手法を実施する場合は、法務部門の関与が推奨される。  
主な考慮事項：

- **契約条項**：免責・損害賠償・責任範囲の明示  
- **秘密保持契約（NDA）**：外部アセッサへの情報漏洩防止  
- **プライバシー保護**：社員や第三者の個人情報（PII）の扱いを制御  
- **通信監視の告知**：システム利用者への同意表示の有無を確認  

キャプチャデータに機微情報が含まれる場合は、収集・保存・削除の全工程を法的指針に従って実施する。

---

## 6.7 まとめ

情報セキュリティ評価は多要素かつ複雑な活動であるが、計画段階での明確な手順設計により、リスクを最小化できる。  
主なポイントは以下の通り：

1. **ポリシー策定**：方向性と責任の明確化  
2. **優先順位付け**：影響度・法令・リソースを考慮  
3. **手法選定**：目的・リスク・スキルに応じた適用  
4. **ロジスティクス**：チーム・環境・ツールの確保  
5. **評価計画書**：範囲・ルール・データ管理・対応策の明記  
6. **法的考慮**：契約、プライバシー、免責を明確化  

これらを確立したうえで、定期的な見直しと改善を行うことが、継続的なセキュリティ成熟度向上につながる。

---
# 7. セキュリティ評価の実行

セキュリティ評価の実行段階では、脆弱性は計画段階および評価計画書（または ROE）で決定された手法と技法によって識別される。評価は計画書や ROE に従って実施することが極めて重要であり、本節は実行フェーズを通じて評価者が考慮すべき主要点を強調する。たとえば、適切な調整（コーディネーション）は評価プロセスを円滑にし、関連リスクを低減する。インシデント対応や、評価実施時に組織が直面する課題についても扱う。また、分析プロセスを論じ、評価に関連するデータの収集・保管・送信・破棄に関する推奨を示す。

---

## 7.1 調整（Coordination）

評価を通じて、評価者は組織内の各種関係者と**継続的に調整**することが重要である。調整要件は評価計画書や ROE によって定められ、それに従う必要がある。適切な調整は以下を確実にする：

- ステークホルダが評価のスケジュール、実施内容、及び想定される影響を把握していること  
- 評価がアップグレードや新技術導入など、システムセキュリティが変化する時期に重ならないこと（保守ウィンドウや低使用時間帯での実施など）  
- 評価者が施設およびシステムへ必要なアクセス権を適切に付与されていること  
- 重大で影響の大きい脆弱性が発見された際に、CIO・CISO・ISSO 等の適切な担当者へ速やかに通報されること  
- インシデント発生時に適切な人物（評価者、インシデント対応チーム、上級管理職など）への通報が行われること。インシデントが発生した場合は、評価計画書/ROE に従い、インシデントが対応されるまで活動を中断することが推奨される。どの範囲で活動を中断するかは組織とインシデント種別に依存するが、多くの場合はインシデントに直接関係するシステムに対する活動のみが停止される。

評価者と組織側の調整レベルは、主に対象システムと実施される評価の種類によって決まる。**重要システム**は、エンゲージメント期間中の可用性確保のためにより多くの調整を要することが多い。手法ごとのリスクレベルも調整量に影響を与える：レビュー系手法は低リスク、対象識別・分析は中リスク、脆弱性検証は高リスクである。たとえば、重要システムに対する侵入テストは、重要システムのドキュメントレビューよりもはるかに多い調整を必要とする。

評価者および関係者（システム所有者など）は、実行中も注意を怠らないこと。評価者が必要とするアクセスレベル（物理的・システム的）は調整を促し、インサイダー脅威の評価のような場合は特に重要である。

評価中、評価者は関係者への**能動的な連絡**を行うべきで、定期的なステータス会議や日次／週次報告によってこれを維持する。会議参加者・報告受取人は評価計画書/ROE で定めるべきであり、例として評価者・ISSO・CISO・CIO等が含まれる。会議や報告の頻度は評価の期間・複雑さによって異なる。例えば 1 か月の侵入テストでは、週次会議と、実攻撃期間中の**日次報告**が適切な場合がある。会議・報告では、完了した活動、成功率、発生した問題、重大な所見および推奨対策を扱う。

---

## 7.2 評価の遂行（Assessing）

評価は評価計画書または ROE のガイドラインに従って実施する。計画書/ROE に定められた内容から逸脱する場合は、通常は署名者または権限者からの書面による許可を得る必要がある。すべての評価者は計画書/ROE を熟読・理解し、特に脆弱性検証のような高リスク活動については、評価中に定期的に計画を見直すことが推奨される。

評価中に組織のインシデント対応チームがインシデントを検知する可能性がある。このインシデントは評価者の活動による場合もあれば、偶発的に同時発生した実際の攻撃による場合もある。インシデントを検知したチームは組織の通常のエスカレーション手順に従うべきであり、評価者は計画書/ROE の指示に従うか、別途指示を受けるまでそれに従うべきである。もし評価中に実際の攻撃者の存在が判明した場合は直ちに通報し、評価者は計画書/ROE に定められたプロトコルに従うべきである。多くの場合、評価者はそのインシデントに関係するシステムの評価を中止することが推奨される。

評価中に直面し得るその他の技術的・運用的・政治的課題には以下がある：

- **抵抗（Resistance）**：システム管理者やエンドユーザからの抵抗（可用性喪失への懸念、咎められることへの恐れ、作業の煩雑化など）。上層部の承認と支援、標準プロセスへの組み込みが有効。  
- **現実味の欠如（Lack of Realism）**：評価準備のために一時的に設定を強化するケース。事前通知を行わない無告知評価を適宜補助的に実施することで対処可能。  
- **即時緩和（Immediate Mitigation）**：脆弱性発見時に管理者が即時修正を求める場合、チェンジ管理手順に従う重要性を説明する必要がある。  
- **時間（Time）**：短期間での依頼や本番稼働中の評価に伴う制約。影響が大きい検査はオフピークでの実施が必要。  
- **リソース（Resources）**：熟練チームや最新ツールの確保が常に課題。専用評価機器や継続ライセンスの確保、事前のツール更新が望ましい。外部委託時は実績や方法論を評価した信頼できる事業者を選ぶ。  
- **進化する技術（Evolving Technology）**：評価者は技術の進化や攻撃手法に追随するため、定期的な教育訓練が必要。  
- **運用影響（Operational Impact）**：評価は運用影響を避けるよう計画されるが、偶発的な問題が発生し得る。すべてのテストはタイムスタンプ、テスト種別、使用ツール、発行コマンド、テスト機の IP 等を記録すること。ログ収集用スクリプトやセッション記録（コマンドログ、GUI 操作記録）を用いると、後続の責任追及やトラブルシュートに役立つ。インシデント発生時の対応手順を事前に確立しておくことが推奨される。

---

## 7.3 分析（Analysis）

解析作業は評価中に行われることが多い（第8章での事後分析もあり得る）。解析の主目的は、**誤検知（false positives）の除去、脆弱性の分類、原因の特定**である。自動ツールは多数の所見を生成するが、多くは確認が必要である。評価者は対象システムを手作業で検証するか、別の自動化ツールで結果を照合して確認する。ツール同士の比較は迅速だが、同じ誤検知を再現する可能性もあるため、**手動検証が最も正確**だが時間を要する。

組織は所見を NIST SP 800-53 のセキュリティ制御ファミリ（例：インシデント対応、アクセス制御）に基づいて分類することができる。これにより、脆弱性の分析・修復・文書化が容易になる場合がある。

重要なのは **脆弱性の根本原因（root cause）** を特定することである。根本原因はプログラムレベルの弱点に起因することが多く、一般的な原因例は以下のとおり：

- パッチ管理の不備（適時適用されない等）  
- 脅威管理の不備（古いアンチウイルス定義、不適切なフィルタリング、緩いファイアウォールルール等）  
- セキュリティベースラインの欠如（類似システムで設定が不一致）  
- SDLC へのセキュリティ組込不足（要件欠如、内部アプリの脆弱性）  
- セキュリティアーキテクチャの弱点（技術の不適切配置やカバレッジ不足）  
- インシデント対応手順の不備（対応遅延等）  
- 教育不足（エンドユーザや管理者の研修不足）  
- セキュリティポリシーの欠如または運用不徹底

分析フェーズで参照に有用な資源として、NIST の National Vulnerability Database（NVD）がある。NVD は CVE（Common Vulnerabilities and Exposures）情報と CVSS スコアを提供し、ベンダサイトなどの緩和手段情報も参照できる。

もう一つの分析目的は、評価中に**即時対応が必要な重大脆弱性**を識別することである。たとえば、侵入テストで重要システムの管理者権限を取得してしまった場合、評価者は計画書/ROE に定義された担当者へ直ちに通知すべきである。

---

## 7.4 データ取り扱い（Data Handling）

評価中のデータ取り扱いは、システム構成や脆弱性情報など機微情報の保護に直結する。評価計画書/ROE にデータ取り扱い要件を明確化し、組織の方針に従って情報を扱うこと。以下は、評価中および評価後のデータの**収集・保管・送信・破棄**に関する推奨事項である。

### 7.4.1 データ収集（Data Collection）

評価チームは、評価を通じて関連情報を継続的に収集する。収集対象の例：

- **アーキテクチャ／構成データ**：システム名、IP、OS、ネットワーク位置、セキュリティ設定、発見された脆弱性等  
- **評価者の活動ログ**：使用した評価システム情報、実行手順の逐次記録（監査証跡）。これは、評価者の行為と実際の攻撃を区別するための監査証跡となる

評価者は、キーストロークロガやツールのログを利用して活動ログを取得できる（キーストロークロガはキーストロークをすべて記録するが、マウス操作などは捕捉しない）。自動ツールを用いる場合、ツールの監査ログを保存するのが良い。ログを中央化するために出力を別システムへ転送することも可能だが、手動ログ（日時、評価者、評価機 ID、対象システム ID、ツール、実行コマンド、コメント等）を取る方法もある。手動ログは手間とエラーの余地があるため、可能なら自動化を薦める。

### 7.4.2 データ保管（Data Storage）

収集データ（脆弱性、分析結果、推奨対策等）は、評価者の責任の下で**安全に保管**する必要がある。不適切な流出は組織の評判を傷つけ、悪用リスクを高める。最低限保管すべきもの：

- 評価計画書および ROE  
- システム構成・ネットワークアーキテクチャのドキュメント  
- 自動ツールやその他の所見出力  
- 評価結果レポート  
- 是正計画（POA&M）等

所見の保管方法は複数あり、ツール出力そのまま保持する方法や、スプレッドシート／データベースへ取り込む方法がある。単一ツールならツールの出力管理で足りるが、複数ツールや継続的追跡が必要な場合は、コラボレーティブなデータベースを用いる方が有利である。保管場所は日常ネットワーク資源とは**論理的または物理的に分離**し、アクセスは必要最小限に限定する。データは FIPS 140-2 準拠の暗号化で保護することが推奨される。

保存期間は組織の方針や評価計画で定めるべきである。監査目的や傾向分析（脆弱性種類、頻度、平均修復時間等）を行うための履歴は有用である。

携帯機器や評価機器は放置しないこと。移動中や宿泊先での保管も注意し、機器をロックまたは金銭箱に保管する等、物理的保護を行う。システムには強力なパスワード、可能であれば二要素認証を設定し、保存データは暗号化する。暗号化には別個の認証機構を用いることが望ましい。

### 7.4.3 データ送信（Data Transmission）

評価データをネットワークやインターネット経由で送信する必要がある場合は、送信路の保護が必須である。評価計画書/ROE に送信要件を定め、以下の手段を推奨する：

- 個々の機密ファイルを暗号化して送信する  
- 通信チャネル自体を FIPS 準拠の暗号で保護する（VPN、TLS/SSL 等）  
- 物理的に媒体を搬送する（暗号化された媒体の郵送など）

### 7.4.4 データ破棄（Data Destruction）

評価データが不要になったら、評価システム、紙文書、媒体は適切に**消去・無害化**する必要がある。NIST SP 800-88（Guidelines for Media Sanitization）は媒体の無害化を以下のカテゴリで定義する：

- **廃棄（Disposal）**：機密性を要しない情報の単純廃棄（紙のリサイクル等）  
- **クリア（Clearing）**：標準的なキーボード攻撃や一般的な復旧ツールから情報を守るレベル。単純削除は不可。上書きなどが該当。  
- **パージ（Purging）**：ラボレベルの高度な攻撃から情報を守る処理。ATA Secure Erase やデガウス等が例（クリアで不十分な媒体に対して行う）。  
- **破壊（Destruction）**：物理的に媒体を破壊し復元不可能にする（粉砕、焼却、溶解など）。

組織は、評価データの無害化ポリシーを維持すべきである。NIST SP 800-88 の意思決定フロー図は、適切な無害化手法選定に有用である。評価計画書/ROE に特定の破棄要件を定めることもある。

外部評価者は、評価対象組織の無害化要件を理解し遵守すること。組織により方針が異なるため、最終報告提出後に第三者がデータを保持することを禁じる場合がある。その場合は、評価対象組織の担当者が適切に無害化が行われたことを検証することが望ましい。

# 8. テスト後の活動（Post-Testing Activities）

実行フェーズの後──そこでは所見が脆弱性という形で示される──組織は識別された脆弱性に対処するための措置を講じるべきである。本節は、組織が所見をセキュリティ改善のための行動に変換する方法を示す。まず、所見の最終的な分析を行い、緩和（Mitigation）策を策定する。次に、推奨事項を提示する報告書を作成する。最後に、緩和活動を実行する。以下に示す多くの活動はテストプロセスの外側で行われることがあり（例えば、テスト結果を用いたリスク評価の一部として実施される等）、評価プロセスと独立して進むこともある。

---

## 8.1 緩和（Mitigation）推奨事項

第7.3節で述べたように、詳細な分析は多くの場合テスト中に行われる。最終分析（総括的結論の取りまとめ等）は、すべてのテスト活動が完了した後に行われ、**緩和推奨事項の作成**を含む。脆弱性を識別・分類することは重要だが、**緩和戦略が策定・実施されてこそテストの価値が高まる**。各所見に対しては根本原因分析の結果を含む緩和案を作成すべきである。緩和策は技術的なもの（例：特定パッチの適用）と、組織のプロセスに関する非技術的なもの（例：パッチ管理プロセスの更新）が混在することがある。緩和アクションの例としては、ポリシー・手順の修正、セキュリティアーキテクチャの変更、新たなセキュリティ技術の導入、OS／アプリケーションパッチの展開などが挙げられる。

NIST SP 800-53 は各セキュリティコントロールに対する緩和案を示唆している。組織は、運用要件と照らし合わせて潜在的緩和策を比較検討し、機能性とセキュリティのバランスが最も良い策を選定すべきである。第8.3節では緩和案の実行に関する手順を述べる。

---

## 8.2 報告（Reporting）

解析が完了したら、システム、ネットワーク、組織上の脆弱性とその推奨緩和策を特定した**報告書**を作成する。このセキュリティテスト結果は、次の用途に利用できる：

- 是正措置の基点として  
- 識別された脆弱性に対処する緩和活動の定義に  
- 組織のセキュリティ要件達成状況の追跡ベンチマークとして  
- システムセキュリティ要件の実装状況評価に  
- セキュリティ改善のコスト／便益分析に  
- リスク評価、認証・認可（C&A）、プロセス改善といったライフサイクル活動の強化に  
- FISMA 等の報告要件の充足に

テスト結果は CIO、CISO、ISSO、該当するプログラム管理者やシステムオーナーなど、適切な担当者に提供すべきである。報告書は複数の受け手（経営層、技術者、運用、監査担当等）を想定するため、**複数フォーマット**を用意するのが望ましい。例えば FISMA に対応する報告書は、評価から得られた所見、NIST 標準への準拠状況、重大欠陥、および予定された是正活動を扱う必要がある。内部向けの詳細報告書は、テスト手法、テスト結果、分析、POA&M（Plan of Action and Milestones：行動計画とマイルストーン）を含めるべきである。POA&M は、個々の脆弱性に対して**具体的で測定可能、実行可能、現実的、期限付き**のアクションを確実に定義するための重要なツールである。

---

## 8.3 修復／緩和（Remediation/Mitigation）

POA&M はプログラム管理部門に対して、リスクを適切かつ受容可能な形で緩和するために必要な詳細と行動を提供する。POA&M を実行するための戦略やプロセスを策定することも有用である。組織は少なくとも次の**4 つのステップ**に従って修復実施を行うとよい。これによりセキュリティ担当者やプログラムマネージャに一貫性と構造を提供できる。

1. **緩和推奨事項のテスト**  
   本番資産に対して技術的変更を実施する前に、必ず**テスト環境**で検証を行うべきである。例えばパッチ適用は本番適用前に同等のテスト系で導入し、負の副作用がないか確認する。こうした検証はリスクを大幅に低減するが、ゼロにするものではない。

2. **POA&M の構成管理（Configuration Control）を通じた調整**  
   POA&M は既存システムやネットワーク、ポリシー、プロセスに変更を提案するため、構成管理委員会（または同等の承認プロセス）を通じて調整すべきである。展開前と完了後のコミュニケーションにより、関係者が変更の影響を理解できるようにする。少なくともプログラムマネージャやシステムオーナの承認を得てから実施する。

   管理層の承認を得るのはしばしば困難であるため、なぜ承認が必要か（ポリシー起因か技術起因か）、及び実施によって得られる利点（セキュリティ姿勢の改善、コンプライアンス維持など）を明確に示すとよい。コスト／便益分析や、リスク軽減の定量効果を提示すると承認が得やすくなる。

3. **実装と検証**  
   緩和策を実施したら、その適切性と正確な実装を検証する。検証手法にはシステム監査、再テスト、実行記録による責任追及がある。システム監査は技術的確認手段として有効であり、オンサイトのセキュリティ担当者や外部のセキュリティテストチームが実施できる。監査チームは緩和戦略をチェックリストとして用いて各項目の達成を確認し、再テストによって緩和の効果を検証する。なお、検証は元のテストのミラーを行わない限り完全には確認できない点に留意する。技術的検証以外に、文書による検証（責任者の署名等）を用いることもコスト面で有効だが、技術的検証を省略するとリスクが残る。

4. **POA&M の更新と追跡**  
   実装戦略の一部として、POA&M を継続的に更新して、実施済み・一部完了・保留中といった状態を明確にすることが重要である。POA&M を構成管理プロセスに統合すれば、システム・ポリシー・プロセスの変更を集中管理し、コンプライアンス監視と進捗管理が容易になる。

---
